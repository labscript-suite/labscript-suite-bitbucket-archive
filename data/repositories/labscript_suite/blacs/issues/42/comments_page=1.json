{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42/comments/44971348.json"}, "html": {"href": "#!/labscript_suite/blacs/issues/42#comment-44971348"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42.json"}}, "type": "issue", "id": 42, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs.json"}, "html": {"href": "#!/labscript_suite/blacs"}, "avatar": {"href": "data/bytebucket.org/ravatar/{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}ts=249915"}}, "type": "repository", "name": "BLACS", "full_name": "labscript_suite/blacs", "uuid": "{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}"}, "title": "Connection table recompile can't handle missing globals file"}, "content": {"raw": "Looks like the exception string is the wrong datatype on Python 3. Could you try changing the offending line to:\n\n```\nzprocess.zmq_push_multipart(stream_port, data=['stderr', error.encode('utf8')])\n```\n\nwith the error string getting encoded to bytes?", "markup": "markdown", "html": "<p>Looks like the exception string is the wrong datatype on Python 3. Could you try changing the offending line to:</p>\n<div class=\"codehilite\"><pre><span></span>zprocess.zmq_push_multipart(stream_port, data=[&#39;stderr&#39;, error.encode(&#39;utf8&#39;)])\n</pre></div>\n\n\n<p>with the error string getting encoded to bytes?</p>", "type": "rendered"}, "created_on": "2018-04-26T08:59:25.704550+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 44971348}, {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42/comments/44971738.json"}, "html": {"href": "#!/labscript_suite/blacs/issues/42#comment-44971738"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42.json"}}, "type": "issue", "id": 42, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs.json"}, "html": {"href": "#!/labscript_suite/blacs"}, "avatar": {"href": "data/bytebucket.org/ravatar/{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}ts=249915"}}, "type": "repository", "name": "BLACS", "full_name": "labscript_suite/blacs", "uuid": "{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}"}, "title": "Connection table recompile can't handle missing globals file"}, "content": {"raw": "nope tried that didn't work", "markup": "markdown", "html": "<p>nope tried that didn't work</p>", "type": "rendered"}, "created_on": "2018-04-26T09:16:53.308615+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": null, "type": "issue_comment", "id": 44971738}, {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42/comments/44971770.json"}, "html": {"href": "#!/labscript_suite/blacs/issues/42#comment-44971770"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42.json"}}, "type": "issue", "id": 42, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs.json"}, "html": {"href": "#!/labscript_suite/blacs"}, "avatar": {"href": "data/bytebucket.org/ravatar/{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}ts=249915"}}, "type": "repository", "name": "BLACS", "full_name": "labscript_suite/blacs", "uuid": "{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}"}, "title": "Connection table recompile can't handle missing globals file"}, "content": {"raw": "I think the error states that zprocess.zmq_push_multipart doesn't like lists as data but I'm still investigating.", "markup": "markdown", "html": "<p>I think the error states that zprocess.zmq_push_multipart doesn't like lists as data but I'm still investigating.</p>", "type": "rendered"}, "created_on": "2018-04-26T09:18:23.554704+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": null, "type": "issue_comment", "id": 44971770}, {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42/comments/44972079.json"}, "html": {"href": "#!/labscript_suite/blacs/issues/42#comment-44972079"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42.json"}}, "type": "issue", "id": 42, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs.json"}, "html": {"href": "#!/labscript_suite/blacs"}, "avatar": {"href": "data/bytebucket.org/ravatar/{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}ts=249915"}}, "type": "repository", "name": "BLACS", "full_name": "labscript_suite/blacs", "uuid": "{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}"}, "title": "Connection table recompile can't handle missing globals file"}, "content": {"raw": "Ok so I found the bug. zprocess.zmq_push_multipart calls _typecheck_or_convert_data. This function checks that all items in the list 'data' are of type bytes. However this will not be the case in python3 for all strings that don't have a bytes literal in front of them.\nSo the fix would be: \n\n```\n#!python\n\nzprocess.zmq_push_multipart(stream_port, data=[b'stderr', error.encode('utf8')])\n```\n\nShould I create a pull request over at runmanager or should we fix this in zprocess.?", "markup": "markdown", "html": "<p>Ok so I found the bug. zprocess.zmq_push_multipart calls _typecheck_or_convert_data. This function checks that all items in the list 'data' are of type bytes. However this will not be the case in python3 for all strings that don't have a bytes literal in front of them.\nSo the fix would be: </p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">zprocess</span><span class=\"o\">.</span><span class=\"n\">zmq_push_multipart</span><span class=\"p\">(</span><span class=\"n\">stream_port</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"sa\">b</span><span class=\"s1\">&#39;stderr&#39;</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"o\">.</span><span class=\"n\">encode</span><span class=\"p\">(</span><span class=\"s1\">&#39;utf8&#39;</span><span class=\"p\">)])</span>\n</pre></div>\n\n\n<p>Should I create a pull request over at runmanager or should we fix this in zprocess.?</p>", "type": "rendered"}, "created_on": "2018-04-26T09:31:24.603564+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": null, "type": "issue_comment", "id": 44972079}, {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42/comments/44977190.json"}, "html": {"href": "#!/labscript_suite/blacs/issues/42#comment-44977190"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42.json"}}, "type": "issue", "id": 42, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs.json"}, "html": {"href": "#!/labscript_suite/blacs"}, "avatar": {"href": "data/bytebucket.org/ravatar/{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}ts=249915"}}, "type": "repository", "name": "BLACS", "full_name": "labscript_suite/blacs", "uuid": "{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}"}, "title": "Connection table recompile can't handle missing globals file"}, "content": {"raw": "Excellent!\n\nI consider this a runmanager bug, zprocess is doing the intended error\nchecking and I don't think I want it to auto encode, though its error could\nbe made more useful by saying the type of the element in the list instead\nof just 'list'. But I'll deal with that separately.", "markup": "markdown", "html": "<p>Excellent!</p>\n<p>I consider this a runmanager bug, zprocess is doing the intended error\nchecking and I don't think I want it to auto encode, though its error could\nbe made more useful by saying the type of the element in the list instead\nof just 'list'. But I'll deal with that separately.</p>", "type": "rendered"}, "created_on": "2018-04-26T12:55:14.642997+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 44977190}, {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42/comments/44987336.json"}, "html": {"href": "#!/labscript_suite/blacs/issues/42#comment-44987336"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs/issues/42.json"}}, "type": "issue", "id": 42, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs.json"}, "html": {"href": "#!/labscript_suite/blacs"}, "avatar": {"href": "data/bytebucket.org/ravatar/{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}ts=249915"}}, "type": "repository", "name": "BLACS", "full_name": "labscript_suite/blacs", "uuid": "{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}"}, "title": "Connection table recompile can't handle missing globals file"}, "content": {"raw": "Fixed in runmanager commit 96ee800", "markup": "markdown", "html": "<p>Fixed in runmanager commit <a href=\"#!/labscript_suite/blacs/commits/96ee800\" rel=\"nofollow\" class=\"ap-connect-link\">96ee800</a></p>", "type": "rendered"}, "created_on": "2018-04-26T23:25:36.299060+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": null, "type": "issue_comment", "id": 44987336}], "page": 1, "size": 6}