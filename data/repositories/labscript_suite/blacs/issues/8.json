{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/blacs.json"}, "html": {"href": "#!/labscript_suite/blacs"}, "avatar": {"href": "data/bytebucket.org/ravatar/{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}ts=249915"}}, "type": "repository", "name": "BLACS", "full_name": "labscript_suite/blacs", "uuid": "{50ed1eb9-8c1b-4afe-a8b8-8e0a33b39a05}"}, "links": {"attachments": {"href": "data/repositories/labscript_suite/blacs/issues/8/attachments_page=1.json"}, "self": {"href": "data/repositories/labscript_suite/blacs/issues/8.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/blacs/issues/8/watch"}, "comments": {"href": "data/repositories/labscript_suite/blacs/issues/8/comments_page=1.json"}, "html": {"href": "#!/labscript_suite/blacs/issues/8/compile-and-restart-improvements-making"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/blacs/issues/8/vote"}}, "reporter": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "title": "'Compile and restart' improvements - making sure it can happen when other things are borked", "component": null, "votes": 0, "watches": 3, "content": {"raw": "If there's anything wrong with the connection table, or really, if there is really a any of a wide range of failures during startup, the GUI should still pop up, the error displayed somewhere and the user have the possibility of (and be direct to consider) opening the 'compile and restart' dialog.\r\n\r\nThis option should be available even if BLACS has serious problems initialising, because some of these problems can be due to mismatches between connection table and BLACS tab code. For example, today I modified the Novatech's `BLACS_connection` to include the serial baud rate.  I made it backward compatible (don't worry!), but before I did I had a connection table that didn't match what the BLACS tab expected. I couldn't start BLACS and I couldn't recompile the connection table except through runmanager. This has come up a lot in the wild if I understand correctly. So we need to just allow maximum breakage whilst still having the possibility of getting to that dialog.\r\n\r\nOf course we should also do some basic checks for more obvious issues, like the connection table .py file doesn't exist (I think I want to copy a template to the given path in this case), or the h5 file doesn't exist (definitely want to bring up compile window in this case, probably with a message about 'do the first compile of this connection table').\r\n\r\nWe will also need the setting of what globals files to use to use in compilation to be available.\r\n\r\nIs it much work to make `compile_and_restart` work standalone, but with an extra button to pop up the settings dialog for selecting globals? That button could be there even when the compile dialog is started normally from within BLACS - nothing wrong with having an extra way to get to the same dialog box.\r\n\r\nI know it used to work standalone as a test. If we were to make it actually standalone we'd need it to know that it was standalone and not offer to restart BLACS (and look up the .py and .h5 files from labconfig, if it doesn't already do so).\r\n\r\nThen we could add another shortcut to the labscript install folder, something like 'connection table compiler', that would just shortcut to `python -m blacs.compile_and_restart --compile-standalone` or something. We could direct users to use this to compile their connection table if things were broken.\r\n\r\nIn fact, if we'd rather not fix anything about BLACS startup, this alone would probably be satisfactory.", "markup": "markdown", "html": "<p>If there's anything wrong with the connection table, or really, if there is really a any of a wide range of failures during startup, the GUI should still pop up, the error displayed somewhere and the user have the possibility of (and be direct to consider) opening the 'compile and restart' dialog.</p>\n<p>This option should be available even if BLACS has serious problems initialising, because some of these problems can be due to mismatches between connection table and BLACS tab code. For example, today I modified the Novatech's <code>BLACS_connection</code> to include the serial baud rate.  I made it backward compatible (don't worry!), but before I did I had a connection table that didn't match what the BLACS tab expected. I couldn't start BLACS and I couldn't recompile the connection table except through runmanager. This has come up a lot in the wild if I understand correctly. So we need to just allow maximum breakage whilst still having the possibility of getting to that dialog.</p>\n<p>Of course we should also do some basic checks for more obvious issues, like the connection table .py file doesn't exist (I think I want to copy a template to the given path in this case), or the h5 file doesn't exist (definitely want to bring up compile window in this case, probably with a message about 'do the first compile of this connection table').</p>\n<p>We will also need the setting of what globals files to use to use in compilation to be available.</p>\n<p>Is it much work to make <code>compile_and_restart</code> work standalone, but with an extra button to pop up the settings dialog for selecting globals? That button could be there even when the compile dialog is started normally from within BLACS - nothing wrong with having an extra way to get to the same dialog box.</p>\n<p>I know it used to work standalone as a test. If we were to make it actually standalone we'd need it to know that it was standalone and not offer to restart BLACS (and look up the .py and .h5 files from labconfig, if it doesn't already do so).</p>\n<p>Then we could add another shortcut to the labscript install folder, something like 'connection table compiler', that would just shortcut to <code>python -m blacs.compile_and_restart --compile-standalone</code> or something. We could direct users to use this to compile their connection table if things were broken.</p>\n<p>In fact, if we'd rather not fix anything about BLACS startup, this alone would probably be satisfactory.</p>", "type": "rendered"}, "assignee": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "state": "resolved", "version": null, "edited_on": null, "created_on": "2014-10-04T04:22:35.639809+00:00", "milestone": null, "updated_on": "2018-03-27T23:13:20.436491+00:00", "type": "issue", "id": 8}