{"links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/10/comments/39041367.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/10/_/diff#comment-39041367"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/10"}}, "title": "Prevent GUI from jumping around, pixel saving, analysis submission improvements"}, "content": {"raw": "Aah, I see. That seems likely!\n\nLyse's zmq server probably isn't blocked by analysis running, but reading h5 files. h5py holds the GIL. This used to cause > 1 second delays  with heartbeating, and we had to switch to doing heartbeating without the parent touching the Python interpreter, so it could respond quickly.\n\nI guess I'd better increase the timeout again, perhaps even 3 seconds is better. \n\nResolving issue #22 in the way being discussed in the thread there might solve this, as it would relieve the lyse process from having to read h5 files a lot of the time. Nothing else we use holds the GIL like that. Perhaps also we should make it that lyse can receive a list of shots all in one zmq request, so that reading one h5 file doesn't block it from receiving the next one.", "markup": "markdown", "html": "<p>Aah, I see. That seems likely!</p>\n<p>Lyse's zmq server probably isn't blocked by analysis running, but reading h5 files. h5py holds the GIL. This used to cause &gt; 1 second delays  with heartbeating, and we had to switch to doing heartbeating without the parent touching the Python interpreter, so it could respond quickly.</p>\n<p>I guess I'd better increase the timeout again, perhaps even 3 seconds is better. </p>\n<p>Resolving issue <a href=\"#!/labscript_suite/blacs/issues/22/blacs-log-file-rollover-not-working\" rel=\"nofollow\" title=\"BLACS log file rollover not working\" class=\"ap-connect-link\"><s>#22</s></a> in the way being discussed in the thread there might solve this, as it would relieve the lyse process from having to read h5 files a lot of the time. Nothing else we use holds the GIL like that. Perhaps also we should make it that lyse can receive a list of shots all in one zmq request, so that reading one h5 file doesn't block it from receiving the next one.</p>", "type": "rendered"}, "created_on": "2017-06-19T02:10:28.607006+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-06-19T02:10:28.609230+00:00", "type": "pullrequest_comment", "id": 39041367}