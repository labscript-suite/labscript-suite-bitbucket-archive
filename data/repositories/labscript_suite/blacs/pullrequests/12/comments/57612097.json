{"links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/12/comments/57612097.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/12/_/diff#comment-57612097"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 12, "links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/12.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/12"}}, "title": "Inverted DO"}, "content": {"raw": "It looks like the most recent change to device\\_base\\_class.py is in the wrong place. The new code as shown in the diff appears to be in `create_dds_widgets()` rather than `create_digital_widgets()`? I can't see how this would work at all, which makes me wonder if you accidentally tested on another version of the code?\n\nOn the topic of that bit of code, it looks like we overwrite any existing setting for `inverted` as specified by the `channel_properties`. I think this should be instead `properties['kwargs']['inverted'] = bool(device.properties.get('inverted', False)) if device else properties['kwargs'].get('inverted', False)`. \n\nThis way:\n\n* the connection table supersedes the hard-coded channel properties in the device Python file if the channel exists in the connection table and defaults to False if the inverted flag does not exist in the connection table\n* If the channel is not in use in the connection table, then the developer of the device Python file can specify the inverted behaviour as the default if they want \\(requires they don't use `auto_create_widgets` but they've always had that option\\). The default behaviour if it isn't explicitly specified is again to not be inverted.\n\n", "markup": "markdown", "html": "<p>It looks like the most recent change to device_base_class.py is in the wrong place. The new code as shown in the diff appears to be in <code>create_dds_widgets()</code> rather than <code>create_digital_widgets()</code>? I can't see how this would work at all, which makes me wonder if you accidentally tested on another version of the code?</p>\n<p>On the topic of that bit of code, it looks like we overwrite any existing setting for <code>inverted</code> as specified by the <code>channel_properties</code>. I think this should be instead <code>properties['kwargs']['inverted'] = bool(device.properties.get('inverted', False)) if device else properties['kwargs'].get('inverted', False)</code>. </p>\n<p>This way:</p>\n<ul>\n<li>the connection table supersedes the hard-coded channel properties in the device Python file if the channel exists in the connection table and defaults to False if the inverted flag does not exist in the connection table</li>\n<li>If the channel is not in use in the connection table, then the developer of the device Python file can specify the inverted behaviour as the default if they want (requires they don't use <code>auto_create_widgets</code> but they've always had that option). The default behaviour if it isn't explicitly specified is again to not be inverted.</li>\n</ul>", "type": "rendered"}, "created_on": "2018-02-28T22:52:25.819109+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2018-02-28T22:52:25.824777+00:00", "type": "pullrequest_comment", "id": 57612097}