{"links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/67/comments/100217388.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/67/_/diff#comment-100217388"}}, "parent": {"id": 100216145, "links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/67/comments/100216145.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/67/_/diff#comment-100216145"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 67, "links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/67.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/67"}}, "title": "Implement remote workers in BLACS"}, "content": {"raw": "Thanks for testing!\n\nI am able to reproduce the restarting bug, though it _eventually_ does restart, it just takes ~30 seconds. Here\u2019s the log I see:\n\n```\n[2019-04-27 09:40:24,832] INFO 127.0.0.1: whoami\n[2019-04-27 09:40:24,834] INFO 127.0.0.1: Popen\n[2019-04-27 09:40:25,369] INFO 127.0.0.1: terminate 30940\n[2019-04-27 09:40:25,371] INFO 127.0.0.1: wait 30940\n[2019-04-27 09:40:54,950] INFO 127.0.0.1: del 30940\n[2019-04-27 09:40:55,037] INFO 127.0.0.1: whoami\n[2019-04-27 09:40:55,040] INFO 127.0.0.1: Popen\n```\n\n`whoami` followed by `Popen` is starting a subprocess, `terminate` followed by `wait` and `del` are ending a process. So there\u2019s a very long delay between `wait` and `del` for some reason. I\u2019ll investigate. There is a 5-second communication timeout, so this makes me think the problem is on BLACS\u2019s side, since if it were the server hanging we should see a timeout error.\n\n\u200c", "markup": "markdown", "html": "<p>Thanks for testing!</p>\n<p>I am able to reproduce the restarting bug, though it <em>eventually</em> does restart, it just takes ~30 seconds. Here\u2019s the log I see:</p>\n<div class=\"codehilite\"><pre><span></span>[2019-04-27 09:40:24,832] INFO 127.0.0.1: whoami\n[2019-04-27 09:40:24,834] INFO 127.0.0.1: Popen\n[2019-04-27 09:40:25,369] INFO 127.0.0.1: terminate 30940\n[2019-04-27 09:40:25,371] INFO 127.0.0.1: wait 30940\n[2019-04-27 09:40:54,950] INFO 127.0.0.1: del 30940\n[2019-04-27 09:40:55,037] INFO 127.0.0.1: whoami\n[2019-04-27 09:40:55,040] INFO 127.0.0.1: Popen\n</pre></div>\n\n\n<p><code>whoami</code> followed by <code>Popen</code> is starting a subprocess, <code>terminate</code> followed by <code>wait</code> and <code>del</code> are ending a process. So there\u2019s a very long delay between <code>wait</code> and <code>del</code> for some reason. I\u2019ll investigate. There is a 5-second communication timeout, so this makes me think the problem is on BLACS\u2019s side, since if it were the server hanging we should see a timeout error.</p>\n<p>\u200c</p>", "type": "rendered"}, "created_on": "2019-04-27T13:51:36.526089+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2019-04-27T13:51:36.536110+00:00", "type": "pullrequest_comment", "id": 100217388}