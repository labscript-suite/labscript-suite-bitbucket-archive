{"links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/7/comments/38873114.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/7/_/diff#comment-38873114"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 7, "links": {"self": {"href": "data/repositories/labscript_suite/blacs/pullrequests/7.json"}, "html": {"href": "#!/labscript_suite/blacs/pull-requests/7"}}, "title": "Icons and some pixel-saving"}, "content": {"raw": "With the analysis submission, I've changed it to not crash if it encounters an invalid 'server online' status, but I think in general improvements to there is a separate matter, we shouldn't be swapping strings for enums or anything along with GUI changes, but I've at least made the added GUI code more robust than perhaps the existing code is.\n\nI did add a \"clear\" button which deletes the pending shots - the functionality was already there and I just connected a button to it, but I noticed during testing that it doesn't work very well. The main loop there retries sending every shot before getting a \"clear\" signal, so the clearing doesn't happen immediately, only 2 seconds * number of shots later (I think), which is pretty ridiculous. Rather than modify things further I figured I'd file a bug report about making things work more smoothly here.\n\nWith the extra calls to `self._update_error()`, you're right, most were unnecessary. One was necessary because when a tab transitions to some non-idle state but there is no error message yet, I still want to change the icon to the hourglass icon, which `_update_error` is doing the logic for. So I suppose `_update_error` is poorly named now - so I've renamed it to `_update_error_and_tab_icon()`.\n\nI've also renamed `update_tab_icon_and_colour()` to `set_tab_icon_and_colour()` to help differentiate it from `_update_error_and_tab_icon()`, since it's more about setting the things that have already been figured out than figuring out what they should be.\n\nThe additional lines:\n\n\n```\n#!python\n\nself._tab_text_colour = 'black'\nself.set_tab_icon_and_colour()\n```\n\nin `hide_error()` are because without them, the tab text would stay red once you hide the \"not responding for x seconds\" message. But, I can't put a call to `update_tab_icon_and_colour()` there because that actually immediately *shows* the error again. \n\nAs for the device name and connection now making tabs take up more horizontal space, how about this instead?\n\n![blacs_title.png](data/bitbucket.org/repo/dR5qxr/images/3412042888-blacs_title.png)\n\nSo the name and connection are in their own row again, but on a single line of text.\n\nI've pushed these changes to this pull request.", "markup": "markdown", "html": "<p>With the analysis submission, I've changed it to not crash if it encounters an invalid 'server online' status, but I think in general improvements to there is a separate matter, we shouldn't be swapping strings for enums or anything along with GUI changes, but I've at least made the added GUI code more robust than perhaps the existing code is.</p>\n<p>I did add a \"clear\" button which deletes the pending shots - the functionality was already there and I just connected a button to it, but I noticed during testing that it doesn't work very well. The main loop there retries sending every shot before getting a \"clear\" signal, so the clearing doesn't happen immediately, only 2 seconds * number of shots later (I think), which is pretty ridiculous. Rather than modify things further I figured I'd file a bug report about making things work more smoothly here.</p>\n<p>With the extra calls to <code>self._update_error()</code>, you're right, most were unnecessary. One was necessary because when a tab transitions to some non-idle state but there is no error message yet, I still want to change the icon to the hourglass icon, which <code>_update_error</code> is doing the logic for. So I suppose <code>_update_error</code> is poorly named now - so I've renamed it to <code>_update_error_and_tab_icon()</code>.</p>\n<p>I've also renamed <code>update_tab_icon_and_colour()</code> to <code>set_tab_icon_and_colour()</code> to help differentiate it from <code>_update_error_and_tab_icon()</code>, since it's more about setting the things that have already been figured out than figuring out what they should be.</p>\n<p>The additional lines:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_tab_text_colour</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;black&#39;</span>\n<span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">set_tab_icon_and_colour</span><span class=\"p\">()</span>\n</pre></div>\n\n\n<p>in <code>hide_error()</code> are because without them, the tab text would stay red once you hide the \"not responding for x seconds\" message. But, I can't put a call to <code>update_tab_icon_and_colour()</code> there because that actually immediately <em>shows</em> the error again. </p>\n<p>As for the device name and connection now making tabs take up more horizontal space, how about this instead?</p>\n<p><img alt=\"blacs_title.png\" src=\"data/bitbucket.org/repo/dR5qxr/images/3412042888-blacs_title.png\" /></p>\n<p>So the name and connection are in their own row again, but on a single line of text.</p>\n<p>I've pushed these changes to this pull request.</p>", "type": "rendered"}, "created_on": "2017-06-15T05:41:32.814507+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-06-15T05:41:32.817134+00:00", "type": "pullrequest_comment", "id": 38873114}