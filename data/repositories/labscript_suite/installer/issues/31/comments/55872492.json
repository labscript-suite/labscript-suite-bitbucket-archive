{"links": {"self": {"href": "data/repositories/labscript_suite/installer/issues/31/comments/55872492.json"}, "html": {"href": "#!/labscript_suite/installer/issues/31#comment-55872492"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/installer/issues/31.json"}}, "type": "issue", "id": 31, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/installer.json"}, "html": {"href": "#!/labscript_suite/installer"}, "avatar": {"href": "data/bytebucket.org/ravatar/{65cd9685-3e8c-4275-9b89-1a7873b341d0}ts=python"}}, "type": "repository", "name": "installer", "full_name": "labscript_suite/installer", "uuid": "{65cd9685-3e8c-4275-9b89-1a7873b341d0}"}, "title": "Tasks required before moving to standard Python packages"}, "content": {"raw": "Just leaving a note about this here so I don\u2019t forget: I think there might be a bug in my \u201cbuild and publish to PyPI\u201d GitHub action code. I had attempted to make the git tag the authoritative version \\(overriding the version in setup.py in case we forgot to update it\\). However, while I think this works for wheels, I don\u2019t think it works for installing from source builds \\(aka `sdist` builds\\) uploaded to PyPI. There are some solutions involving only writing out `__version__.py` if it doesn\u2019t exist, but that probably doesn\u2019t play nice with installing with the `-e` option. Given that installing with `-e` requires the version in setup.py to be accurate anyway, perhaps the answer is not to make the git tag authoritative, but have the build fail if the git tag does not match the version specified in the setup.py file in order to prevent publishing versions where we forgot to update the version number.\n\nAnyway, something to resolve when it comes time to implement this.\n\n\u200c", "markup": "markdown", "html": "<p>Just leaving a note about this here so I don\u2019t forget: I think there might be a bug in my \u201cbuild and publish to PyPI\u201d GitHub action code. I had attempted to make the git tag the authoritative version (overriding the version in setup.py in case we forgot to update it). However, while I think this works for wheels, I don\u2019t think it works for installing from source builds (aka <code>sdist</code> builds) uploaded to PyPI. There are some solutions involving only writing out <code>__version__.py</code> if it doesn\u2019t exist, but that probably doesn\u2019t play nice with installing with the <code>-e</code> option. Given that installing with <code>-e</code> requires the version in setup.py to be accurate anyway, perhaps the answer is not to make the git tag authoritative, but have the build fail if the git tag does not match the version specified in the setup.py file in order to prevent publishing versions where we forgot to update the version number.</p>\n<p>Anyway, something to resolve when it comes time to implement this.</p>\n<p>\u200c</p>", "type": "rendered"}, "created_on": "2020-01-26T04:46:42.144540+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{0147401a-13ed-4e39-a0d0-63108c18738b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0147401a-13ed-4e39-a0d0-63108c18738b%7D"}, "html": {"href": "https://bitbucket.org/%7B0147401a-13ed-4e39-a0d0-63108c18738b%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/fa0698c306b3470c00717c146b5296e9d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "philipstarkey", "type": "user", "account_id": "557058:2f99420c-1dbd-4837-952c-82c421b8fbdd"}, "updated_on": null, "type": "issue_comment", "id": 55872492}