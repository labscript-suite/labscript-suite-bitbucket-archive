{"links": {"self": {"href": "data/repositories/labscript_suite/labscript/issues/53/comments/53246255.json"}, "html": {"href": "#!/labscript_suite/labscript/issues/53#comment-53246255"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript/issues/53.json"}}, "type": "issue", "id": 53, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript.json"}, "html": {"href": "#!/labscript_suite/labscript"}, "avatar": {"href": "data/bytebucket.org/ravatar/{48848b08-1db5-463b-bbdc-911beadf8bbf}ts=249917"}}, "type": "repository", "name": "labscript", "full_name": "labscript_suite/labscript", "uuid": "{48848b08-1db5-463b-bbdc-911beadf8bbf}"}, "title": "Pseudoclock/clockline collision"}, "content": {"raw": "Just updated a NIST lab to latest labscript and also hitting something similar:\n\n```python\nTraceback (most recent call last):\n  File \"20190523_BEC_F1_NewODT_DMD.py\", line 630, in <module>\n  File \"C:\\labscript_suite\\labscript\\labscript.py\", line 2467, in stop\n    generate_code()\n  File \"C:\\labscript_suite\\labscript\\labscript.py\", line 2304, in generate_code\n    device.generate_code(hdf5_file)\n  File \"C:\\labscript_suite\\labscript_devices\\PulseBlaster_No_DDS.py\", line 54, in generate_code\n    PseudoclockDevice.generate_code(self, hdf5_file)\n  File \"C:\\labscript_suite\\labscript\\labscript.py\", line 1095, in generate_code\n    Device.generate_code(self, hdf5_file)\n  File \"C:\\labscript_suite\\labscript\\labscript.py\", line 478, in generate_code\n    device.generate_code(hdf5_file)\n  File \"C:\\labscript_suite\\labscript\\labscript.py\", line 921, in generate_code\n    self.generate_clock()\n  File \"C:\\labscript_suite\\labscript\\labscript.py\", line 891, in generate_clock\n    all_change_times, change_times = self.collect_change_times(all_outputs, outputs_by_clockline)\n  File \"C:\\labscript_suite\\labscript\\labscript.py\", line 680, in collect_change_times\n    'One or more connected devices on ClockLine %s cannot support update delays shorter than %s sec.'%(clock_line.name, str(1.0/clock_line.clock_limit)))\nlabscript.labscript.LabscriptError: Commands have been issued to devices attached to pb_0_pseudoclock at t= 12.46651408 s and 12.466664080000001 s. One or more connected devices on ClockLine DMD_trig cannot support update delays shorter than 0.00025 sec.\nCompilation aborted.\n```\n\nBacking out the gated clocks commit seemingly resolves the issue, though I understand if this is just masking an underlying issue.\n\nAgain, the device in question (a LightCrafter DMD) is one with a much slower update rate than others. So it sounds like the same issue.", "markup": "markdown", "html": "<p>Just updated a NIST lab to latest labscript and also hitting something similar:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;20190523_BEC_F1_NewODT_DMD.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">630</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript\\labscript.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2467</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">stop</span>\n    <span class=\"n\">generate_code</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript\\labscript.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2304</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">generate_code</span>\n    <span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">generate_code</span><span class=\"p\">(</span><span class=\"n\">hdf5_file</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_devices\\PulseBlaster_No_DDS.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">54</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">generate_code</span>\n    <span class=\"n\">PseudoclockDevice</span><span class=\"o\">.</span><span class=\"n\">generate_code</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">hdf5_file</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript\\labscript.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1095</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">generate_code</span>\n    <span class=\"n\">Device</span><span class=\"o\">.</span><span class=\"n\">generate_code</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">hdf5_file</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript\\labscript.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">478</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">generate_code</span>\n    <span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">generate_code</span><span class=\"p\">(</span><span class=\"n\">hdf5_file</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript\\labscript.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">921</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">generate_code</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">generate_clock</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript\\labscript.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">891</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">generate_clock</span>\n    <span class=\"n\">all_change_times</span><span class=\"p\">,</span> <span class=\"n\">change_times</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">collect_change_times</span><span class=\"p\">(</span><span class=\"n\">all_outputs</span><span class=\"p\">,</span> <span class=\"n\">outputs_by_clockline</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript\\labscript.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">680</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">collect_change_times</span>\n    <span class=\"s1\">&#39;One or more connected devices on ClockLine </span><span class=\"si\">%s</span><span class=\"s1\"> cannot support update delays shorter than </span><span class=\"si\">%s</span><span class=\"s1\"> sec.&#39;</span><span class=\"o\">%</span><span class=\"p\">(</span><span class=\"n\">clock_line</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"mf\">1.0</span><span class=\"o\">/</span><span class=\"n\">clock_line</span><span class=\"o\">.</span><span class=\"n\">clock_limit</span><span class=\"p\">)))</span>\n<span class=\"n\">labscript</span><span class=\"o\">.</span><span class=\"n\">labscript</span><span class=\"o\">.</span><span class=\"n\">LabscriptError</span><span class=\"p\">:</span> <span class=\"n\">Commands</span> <span class=\"n\">have</span> <span class=\"n\">been</span> <span class=\"n\">issued</span> <span class=\"n\">to</span> <span class=\"n\">devices</span> <span class=\"n\">attached</span> <span class=\"n\">to</span> <span class=\"n\">pb_0_pseudoclock</span> <span class=\"n\">at</span> <span class=\"n\">t</span><span class=\"o\">=</span> <span class=\"mf\">12.46651408</span> <span class=\"n\">s</span> <span class=\"ow\">and</span> <span class=\"mf\">12.466664080000001</span> <span class=\"n\">s</span><span class=\"o\">.</span> <span class=\"n\">One</span> <span class=\"ow\">or</span> <span class=\"n\">more</span> <span class=\"n\">connected</span> <span class=\"n\">devices</span> <span class=\"n\">on</span> <span class=\"n\">ClockLine</span> <span class=\"n\">DMD_trig</span> <span class=\"n\">cannot</span> <span class=\"n\">support</span> <span class=\"n\">update</span> <span class=\"n\">delays</span> <span class=\"n\">shorter</span> <span class=\"n\">than</span> <span class=\"mf\">0.00025</span> <span class=\"n\">sec</span><span class=\"o\">.</span>\n<span class=\"n\">Compilation</span> <span class=\"n\">aborted</span><span class=\"o\">.</span>\n</pre></div>\n\n\n<p>Backing out the gated clocks commit seemingly resolves the issue, though I understand if this is just masking an underlying issue.</p>\n<p>Again, the device in question (a LightCrafter DMD) is one with a much slower update rate than others. So it sounds like the same issue.</p>", "type": "rendered"}, "created_on": "2019-08-01T17:03:22.288083+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 53246255}