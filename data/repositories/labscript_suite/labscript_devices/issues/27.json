{"priority": "major", "kind": "enhancement", "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices.json"}, "html": {"href": "#!/labscript_suite/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{30c94cb1-feec-4534-8885-92452023c9c9}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "labscript_suite/labscript_devices", "uuid": "{30c94cb1-feec-4534-8885-92452023c9c9}"}, "links": {"attachments": {"href": "data/repositories/labscript_suite/labscript_devices/issues/27/attachments_page=1.json"}, "self": {"href": "data/repositories/labscript_suite/labscript_devices/issues/27.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_devices/issues/27/watch"}, "comments": {"href": "data/repositories/labscript_suite/labscript_devices/issues/27/comments_page=1.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/issues/27/pulseblaster-phase-resets"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_devices/issues/27/vote"}}, "reporter": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}, "title": "Pulseblaster phase resets", "component": null, "votes": 0, "watches": 2, "content": {"raw": "The DDS outputs on pulseblasters support phase resets, where the absolute phase of the output is reset. As far as I can tell, we do not use this at all, and so there is no phase stability shot-to-shot (unless the phase resets at the start of the experiment, but I don't see that happening explicitly?). Furthermore, the DDS phase does not seem to be stable over long periods, so resetting at the start of an experiment can lead to phase jitter in pulses several seconds later.\r\n\r\nI propose that we implement a \"phase reset\" function. The reset works by setting the reset flag to True, which holds the DDS output at a constant value corresponding to the starting value due to the current phase register, then disabling the reset again (at the next instruction) after which the DDS begins accumulating phase as usual, outputting rf.\r\n\r\nI've tested that this produces consistent phases in pulses by manually editing instructions in the pulse program written in the H5 file. I'm not sure what the best labscript implementation would be, as the reset takes 2 instructions, and so has a finite time during which the DDS output is frozen.", "markup": "markdown", "html": "<p>The DDS outputs on pulseblasters support phase resets, where the absolute phase of the output is reset. As far as I can tell, we do not use this at all, and so there is no phase stability shot-to-shot (unless the phase resets at the start of the experiment, but I don't see that happening explicitly?). Furthermore, the DDS phase does not seem to be stable over long periods, so resetting at the start of an experiment can lead to phase jitter in pulses several seconds later.</p>\n<p>I propose that we implement a \"phase reset\" function. The reset works by setting the reset flag to True, which holds the DDS output at a constant value corresponding to the starting value due to the current phase register, then disabling the reset again (at the next instruction) after which the DDS begins accumulating phase as usual, outputting rf.</p>\n<p>I've tested that this produces consistent phases in pulses by manually editing instructions in the pulse program written in the H5 file. I'm not sure what the best labscript implementation would be, as the reset takes 2 instructions, and so has a finite time during which the DDS output is frozen.</p>", "type": "rendered"}, "assignee": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "state": "resolved", "version": null, "edited_on": null, "created_on": "2018-08-21T07:44:10.940434+00:00", "milestone": null, "updated_on": "2019-06-03T13:43:31.686679+00:00", "type": "issue", "id": 27}