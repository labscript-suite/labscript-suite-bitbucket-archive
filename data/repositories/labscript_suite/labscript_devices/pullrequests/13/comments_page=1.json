{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/13/comments/37874294.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/13/_/diff#comment-37874294"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 13, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/13.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/13"}}, "title": "Pulseblaster check MaxInstructions"}, "content": {"raw": "Hi Rene,\n\nThanks for contributing to the labscript suite!\n\nFirstly, could you please add myself and @cbillington as reviewers for this pull request? Unfortunately only the person who makes the pull request can set this.\n\nIn regards to the pull request itself: I think it makes sense to check like this. We had originally intended to use the `firmware` keyword argument to determine the maximum number of instructions, but then never implemented it because the spinapi was not returning the firmware version correctly so we couldn't actually ever implement the check with the hardware. \n\nIt seems that 4000 is the standard number of instructions for most PulseBlaster products, although I suspect that we may have some early versions of the PulseBlasterDDS-II-300 that support more, so I think that is a sensible default. \n\nCould you also fix the following issues with your code:\n\n* The error message currently has the number `4000` hard coded. Could you make it use `self.max_instructions` instead?\n* The other PulseBlaster classes use this one as a base. I think they all have 4000 instructions except for the PulseBlaster_SP2_24_100_32k which I suspect supports 32,000 instructions. Could you modify that labscript class too so that it sets `max_instructions` correctly and doesn't break the use of that device? You'll probably want to add something like this to the `PulseBlaster_SP2_24_100_32k` class:\n```\n#!python\n\ndef __init__(self, *args, **kwargs):\n    if 'max_instructions' not in kwargs:\n        kwargs['max_instructions'] = 32000\n    PulseBlaster_No_DDS.__init__(self, *args, **kwargs)\n```\n\n* I think we should also discuss with @cbillington whether `max_instructions` should be stored in the `device_properties` or the `connection_table_properties` and whether we should remove the `firmware` keyword (but this might break compatibility if other groups are using it for some reason).\n\nThanks!", "markup": "markdown", "html": "<p>Hi Rene,</p>\n<p>Thanks for contributing to the labscript suite!</p>\n<p>Firstly, could you please add myself and @cbillington as reviewers for this pull request? Unfortunately only the person who makes the pull request can set this.</p>\n<p>In regards to the pull request itself: I think it makes sense to check like this. We had originally intended to use the <code>firmware</code> keyword argument to determine the maximum number of instructions, but then never implemented it because the spinapi was not returning the firmware version correctly so we couldn't actually ever implement the check with the hardware. </p>\n<p>It seems that 4000 is the standard number of instructions for most PulseBlaster products, although I suspect that we may have some early versions of the PulseBlasterDDS-II-300 that support more, so I think that is a sensible default. </p>\n<p>Could you also fix the following issues with your code:</p>\n<ul>\n<li>The error message currently has the number <code>4000</code> hard coded. Could you make it use <code>self.max_instructions</code> instead?</li>\n<li>The other PulseBlaster classes use this one as a base. I think they all have 4000 instructions except for the PulseBlaster_SP2_24_100_32k which I suspect supports 32,000 instructions. Could you modify that labscript class too so that it sets <code>max_instructions</code> correctly and doesn't break the use of that device? You'll probably want to add something like this to the <code>PulseBlaster_SP2_24_100_32k</code> class:</li>\n</ul>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">):</span>\n    <span class=\"k\">if</span> <span class=\"s1\">&#39;max_instructions&#39;</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">kwargs</span><span class=\"p\">:</span>\n        <span class=\"n\">kwargs</span><span class=\"p\">[</span><span class=\"s1\">&#39;max_instructions&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">32000</span>\n    <span class=\"n\">PulseBlaster_No_DDS</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<ul>\n<li>I think we should also discuss with @cbillington whether <code>max_instructions</code> should be stored in the <code>device_properties</code> or the <code>connection_table_properties</code> and whether we should remove the <code>firmware</code> keyword (but this might break compatibility if other groups are using it for some reason).</li>\n</ul>\n<p>Thanks!</p>", "type": "rendered"}, "created_on": "2017-05-31T00:17:19.600531+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2017-05-31T00:17:19.609018+00:00", "type": "pullrequest_comment", "id": 37874294}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/13/comments/37936406.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/13/_/diff#comment-37936406"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 13, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/13.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/13"}}, "title": "Pulseblaster check MaxInstructions"}, "content": {"raw": "Thank you for your quick reply to my pull request. Your proposed changes seem reasonable. I added  them.", "markup": "markdown", "html": "<p>Thank you for your quick reply to my pull request. Your proposed changes seem reasonable. I added  them.</p>", "type": "rendered"}, "created_on": "2017-05-31T15:36:16.442987+00:00", "user": {"display_name": "ReneKolb", "uuid": "{a14da38a-5a42-4215-a657-8d03e2e12c62}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Ba14da38a-5a42-4215-a657-8d03e2e12c62%7D"}, "html": {"href": "https://bitbucket.org/%7Ba14da38a-5a42-4215-a657-8d03e2e12c62%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/fdb60d6ad1bfc79b620af131e1ff76acd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsR-3.png"}}, "nickname": "ReneKolb", "type": "user", "account_id": "557058:cee66bea-c1f2-4230-9ace-11e2dc725285"}, "updated_on": "2017-05-31T15:36:16.491848+00:00", "type": "pullrequest_comment", "id": 37936406}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/13/comments/37967346.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/13/_/diff#comment-37967346"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 13, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/13.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/13"}}, "title": "Pulseblaster check MaxInstructions"}, "content": {"raw": "Thanks!\n\nI'll leave it to @cbillington to decide on my third dotpoint in my original comment and to approve/merge the changes in.", "markup": "markdown", "html": "<p>Thanks!</p>\n<p>I'll leave it to @cbillington to decide on my third dotpoint in my original comment and to approve/merge the changes in.</p>", "type": "rendered"}, "created_on": "2017-06-01T00:16:07.695716+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2017-06-01T00:16:07.705122+00:00", "type": "pullrequest_comment", "id": 37967346}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/13/comments/38301458.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/13/_/diff#comment-38301458"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 13, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/13.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/13"}}, "title": "Pulseblaster check MaxInstructions"}, "content": {"raw": "Presently since BLACS isn't using `max_instructions` I don't think it really needs to be stored anywhere, strictly speaking - and since changing the number doesn't require a recompilation of the connection table (even if you actually swapped out the PulseBlaster for one which was identical but had a different instruction limit, a recompile would still not be required), it certainly doesn't need to be in the connection table properties. So storing it in `device_properties` seems unnecessary, but harmless, so I see no problem there.", "markup": "markdown", "html": "<p>Presently since BLACS isn't using <code>max_instructions</code> I don't think it really needs to be stored anywhere, strictly speaking - and since changing the number doesn't require a recompilation of the connection table (even if you actually swapped out the PulseBlaster for one which was identical but had a different instruction limit, a recompile would still not be required), it certainly doesn't need to be in the connection table properties. So storing it in <code>device_properties</code> seems unnecessary, but harmless, so I see no problem there.</p>", "type": "rendered"}, "created_on": "2017-06-06T18:17:17.816568+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-06-06T18:17:17.818806+00:00", "type": "pullrequest_comment", "id": 38301458}], "page": 1, "size": 4}