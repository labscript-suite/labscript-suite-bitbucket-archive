{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/66153023.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-66153023"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "We don\u2019t own this device so these changes are completely untested.", "markup": "markdown", "html": "<p>We don\u2019t own this device so these changes are completely untested.</p>", "type": "rendered"}, "created_on": "2018-06-05T06:29:45.097007+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2018-06-05T06:29:45.134971+00:00", "type": "pullrequest_comment", "id": 66153023}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71118173.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_devices/diff/cbillington/labscript_devices:eb1b7e132934..d6170d7d2705?path=RFBlaster.py"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71118173"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "Remove `unicode_literals` import as the new `MultipartForm` threw `UnicodeDecodeError` in Python 2 from `urlopen` when the request contains the binary file, i.e. during `transition_to_buffered`.", "markup": "markdown", "html": "<p>Remove <code>unicode_literals</code> import as the new <code>MultipartForm</code> threw <code>UnicodeDecodeError</code> in Python 2 from <code>urlopen</code> when the request contains the binary file, i.e. during <code>transition_to_buffered</code>.</p>", "type": "rendered"}, "created_on": "2018-07-26T10:43:19.261739+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "inline": {"to": 13, "from": null, "path": "RFBlaster.py"}, "updated_on": "2018-07-26T10:43:19.267275+00:00", "type": "pullrequest_comment", "id": 71118173}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71445411.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_devices/diff/cbillington/labscript_devices:eb1b7e132934..d6170d7d2705?path=RFBlaster.py"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71445411"}}, "parent": {"id": 71118173, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71118173.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71118173"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "Could you elaborate on this, do you have a traceback? As with the AlazarTech, removing the unicode_literals import is unlikely to be the best solution, as it means a divergence between Python 2 and Python 3 behaviour.\n\nI can see in MultipartForm where the decoding would break if binary data comes in, so I can fix that (probably binary data should be returned to the caller undecoded, I'll take a look to see what makes sense), but what I see there wouldn't be fixed by removing unicode_literals, so I'm confused.", "markup": "markdown", "html": "<p>Could you elaborate on this, do you have a traceback? As with the AlazarTech, removing the unicode_literals import is unlikely to be the best solution, as it means a divergence between Python 2 and Python 3 behaviour.</p>\n<p>I can see in MultipartForm where the decoding would break if binary data comes in, so I can fix that (probably binary data should be returned to the caller undecoded, I'll take a look to see what makes sense), but what I see there wouldn't be fixed by removing unicode_literals, so I'm confused.</p>", "type": "rendered"}, "created_on": "2018-07-30T18:46:36.611388+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "inline": {"to": null, "from": null, "path": "RFBlaster.py"}, "updated_on": "2018-07-30T18:46:36.621135+00:00", "type": "pullrequest_comment", "id": 71445411}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71118333.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_devices/diff/cbillington/labscript_devices:eb1b7e132934..d6170d7d2705?path=RFBlaster.py"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71118333"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "After checking `compileD` on both versions, I can confirm that this requires a `PY2` conditional:\n\n```python\nlocal_loop_pre = bytes(i) if PY2 else str(i)\n```", "markup": "markdown", "html": "<p>After checking <code>compileD</code> on both versions, I can confirm that this requires a <code>PY2</code> conditional:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">local_loop_pre</span> <span class=\"o\">=</span> <span class=\"nb\">bytes</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">PY2</span> <span class=\"k\">else</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n</pre></div>", "type": "rendered"}, "created_on": "2018-07-26T10:44:49.830041+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "inline": {"to": 167, "from": null, "path": "RFBlaster.py"}, "updated_on": "2018-07-26T10:46:52.492534+00:00", "type": "pullrequest_comment", "id": 71118333}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71118519.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_devices/diff/cbillington/labscript_devices:eb1b7e132934..d6170d7d2705?path=RFBlaster.py"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71118519"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "This should return a byte string, i.e.\n\n```python\nreturn b'multipart/form-data; boundary=%s' % self.boundary\n```\n\nOn Python 3, the absence of this change prevented `transition_to_buffered` from finishing.", "markup": "markdown", "html": "<p>This should return a byte string, i.e.</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"k\">return</span> <span class=\"sa\">b</span><span class=\"s1\">&#39;multipart/form-data; boundary=</span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">boundary</span>\n</pre></div>\n\n\n<p>On Python 3, the absence of this change prevented <code>transition_to_buffered</code> from finishing.</p>", "type": "rendered"}, "created_on": "2018-07-26T10:46:41.332058+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "inline": {"to": 327, "from": null, "path": "RFBlaster.py"}, "updated_on": "2018-07-26T10:46:41.340462+00:00", "type": "pullrequest_comment", "id": 71118519}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71118616.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_devices/diff/cbillington/labscript_devices:eb1b7e132934..d6170d7d2705?path=RFBlaster.py"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71118616"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "This should read `self.http_request(form)`.", "markup": "markdown", "html": "<p>This should read <code>self.http_request(form)</code>.</p>", "type": "rendered"}, "created_on": "2018-07-26T10:47:31.276556+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "inline": {"to": 433, "from": null, "path": "RFBlaster.py"}, "updated_on": "2018-07-26T10:47:31.285634+00:00", "type": "pullrequest_comment", "id": 71118616}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71118662.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_devices/diff/cbillington/labscript_devices:eb1b7e132934..d6170d7d2705?path=RFBlaster.py"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71118662"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "This should read `self.http_request(form)`.", "markup": "markdown", "html": "<p>This should read <code>self.http_request(form)</code>.</p>", "type": "rendered"}, "created_on": "2018-07-26T10:47:58.916223+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "inline": {"to": 426, "from": null, "path": "RFBlaster.py"}, "updated_on": "2018-07-26T10:47:58.927781+00:00", "type": "pullrequest_comment", "id": 71118662}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71119118.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71119118"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "See comments below. I\u2019ve pushed the associated changes to the monashspinor fork \\([88356d9](#!/monashspinor/labscript_devices/commits/88356d96886d675ddc86670f9b2b9c11922ecdba)\\) if you\u2019d like to pull from there.", "markup": "markdown", "html": "<p>See comments below. I\u2019ve pushed the associated changes to the monashspinor fork (<a data-is-external-link=\"true\" href=\"#!/monashspinor/labscript_devices/commits/88356d96886d675ddc86670f9b2b9c11922ecdba\" rel=\"nofollow\">88356d9</a>) if you\u2019d like to pull from there.</p>", "type": "rendered"}, "created_on": "2018-07-26T10:52:14.977189+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "updated_on": "2018-07-26T10:52:14.984328+00:00", "type": "pullrequest_comment", "id": 71119118}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71446895.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71446895"}}, "parent": {"id": 71119118, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71119118.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71119118"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "Thanks for testing and for the fixes! I pulled your changes and then:\n\n* re-added unicode_literals import\n* deferred decoding of HTTP response so that it is only decoded when parsing values from it, not all the time (thus avoiding decoding the binary file).\n\nAs mentioned in the in-code comments, I don't understand what role `unicode_literals` was playing in the problem you reported, so any more info or testing would be appreciated.", "markup": "markdown", "html": "<p>Thanks for testing and for the fixes! I pulled your changes and then:</p>\n<ul>\n<li>re-added unicode_literals import</li>\n<li>deferred decoding of HTTP response so that it is only decoded when parsing values from it, not all the time (thus avoiding decoding the binary file).</li>\n</ul>\n<p>As mentioned in the in-code comments, I don't understand what role <code>unicode_literals</code> was playing in the problem you reported, so any more info or testing would be appreciated.</p>", "type": "rendered"}, "created_on": "2018-07-30T19:03:50.068036+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-07-30T19:04:18.985380+00:00", "type": "pullrequest_comment", "id": 71446895}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71473876.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71473876"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "I've been unable to reproduce the bug after restoring `unicode_literals`. The other change of [eb31c77](#!/cbillington/labscript_devices/commits/eb31c77e48507615f3a43d0bcc9544059dad9bf1?at=default)  introduces a bug: `get_web_values` is only ever passed the output of `http_request`, i.e. unicode strings, and so `page.decode('utf8')` is ill defined.", "markup": "markdown", "html": "<p>I've been unable to reproduce the bug after restoring <code>unicode_literals</code>. The other change of <a data-is-external-link=\"true\" href=\"#!/cbillington/labscript_devices/commits/eb31c77e48507615f3a43d0bcc9544059dad9bf1?at=default\" rel=\"nofollow\">eb31c77</a>  introduces a bug: <code>get_web_values</code> is only ever passed the output of <code>http_request</code>, i.e. unicode strings, and so <code>page.decode('utf8')</code> is ill defined.</p>", "type": "rendered"}, "created_on": "2018-07-31T02:33:33.068503+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "updated_on": "2018-07-31T02:33:33.074989+00:00", "type": "pullrequest_comment", "id": 71473876}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71474449.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71474449"}}, "parent": {"id": 71473876, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71473876.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71473876"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "This is unexpected. I only moved the `.decode()` from within `http_request()` to within `get_web_values()`, there should still be the same number of decodings in the case that `get_web_values()` gets called. `http_request()` looks like it returns a bytestring:\n\n```python\n        page = b''.join(urlopen(req, timeout=self.timeout).readlines())\n        return page\n```\n\nCould you confirm, or paste a traceback?", "markup": "markdown", "html": "<p>This is unexpected. I only moved the <code>.decode()</code> from within <code>http_request()</code> to within <code>get_web_values()</code>, there should still be the same number of decodings in the case that <code>get_web_values()</code> gets called. <code>http_request()</code> looks like it returns a bytestring:</p>\n<div class=\"codehilite language-python\"><pre><span></span>        <span class=\"n\">page</span> <span class=\"o\">=</span> <span class=\"sa\">b</span><span class=\"s1\">&#39;&#39;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">urlopen</span><span class=\"p\">(</span><span class=\"n\">req</span><span class=\"p\">,</span> <span class=\"n\">timeout</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">timeout</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">readlines</span><span class=\"p\">())</span>\n        <span class=\"k\">return</span> <span class=\"n\">page</span>\n</pre></div>\n\n\n<p>Could you confirm, or paste a traceback?</p>", "type": "rendered"}, "created_on": "2018-07-31T02:51:05.410015+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-07-31T02:51:05.417150+00:00", "type": "pullrequest_comment", "id": 71474449}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71474666.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71474666"}}, "parent": {"id": 71474449, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71474449.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71474449"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "Sorry, Chris. I tested this by manually making the changes of [eb31c77](#!/cbillington/labscript_devices/commits/eb31c77e48507615f3a43d0bcc9544059dad9bf1?at=default), and neglected the removal of `page.decode('utf8')` from `http_request`. The commit is fine as is.", "markup": "markdown", "html": "<p>Sorry, Chris. I tested this by manually making the changes of <a data-is-external-link=\"true\" href=\"#!/cbillington/labscript_devices/commits/eb31c77e48507615f3a43d0bcc9544059dad9bf1?at=default\" rel=\"nofollow\">eb31c77</a>, and neglected the removal of <code>page.decode('utf8')</code> from <code>http_request</code>. The commit is fine as is.</p>", "type": "rendered"}, "created_on": "2018-07-31T02:58:17.853013+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "updated_on": "2018-07-31T02:58:17.864097+00:00", "type": "pullrequest_comment", "id": 71474666}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71474766.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71474766"}}, "parent": {"id": 71474666, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71474666.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71474666"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": ":)", "markup": "markdown", "html": "<p>:)</p>", "type": "rendered"}, "created_on": "2018-07-31T03:00:49.672097+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-07-31T03:00:49.685586+00:00", "type": "pullrequest_comment", "id": 71474766}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71478694.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71478694"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "Turns out I was unable to reproduce the bug because I was testing this in Python 3. In Python 2, I still get this traceback during `transition_to_buffered`:\n\n```python\n2018-07-31 14:35:05,697 ERROR BLACS.rf_blaster_2_main_worker.worker: Exception in job:\r\nTraceback (most recent call last):\r\n  File \"C:\\labscript_suite\\labscript_devices\\RFBlaster.py\", line 418, in transition_to_buffered\r\n    self.http_request(form)\r\n  File \"C:\\labscript_suite\\labscript_devices\\RFBlaster.py\", line 454, in http_request\r\n    page = b''.join(urlopen(req, timeout=self.timeout).readlines())\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\urllib2.py\", line 154, in urlopen\r\n    return opener.open(url, data, timeout)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\urllib2.py\", line 429, in open\r\n    response = self._open(req, data)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\urllib2.py\", line 447, in _open\r\n    '_open', req)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\urllib2.py\", line 407, in _call_chain\r\n    result = func(*args)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\urllib2.py\", line 1228, in http_open\r\n    return self.do_open(httplib.HTTPConnection, req)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\urllib2.py\", line 1195, in do_open\r\n    h.request(req.get_method(), req.get_selector(), req.data, headers)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\httplib.py\", line 1042, in request\r\n    self._send_request(method, url, body, headers)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\httplib.py\", line 1082, in _send_request\r\n    self.endheaders(body)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\httplib.py\", line 1038, in endheaders\r\n    self._send_output(message_body)\r\n  File \"C:\\ProgramData\\Anaconda2\\lib\\httplib.py\", line 880, in _send_output\r\n    msg += message_body\r\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xe0 in position 277: ordinal not in range(128)\n```\n\nThis does not occur when removing the `unicode_literals` import.", "markup": "markdown", "html": "<p>Turns out I was unable to reproduce the bug because I was testing this in Python 3. In Python 2, I still get this traceback during <code>transition_to_buffered</code>:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"mi\">2018</span><span class=\"o\">-</span><span class=\"mo\">07</span><span class=\"o\">-</span><span class=\"mi\">31</span> <span class=\"mi\">14</span><span class=\"p\">:</span><span class=\"mi\">35</span><span class=\"p\">:</span><span class=\"mo\">05</span><span class=\"p\">,</span><span class=\"mi\">697</span> <span class=\"n\">ERROR</span> <span class=\"n\">BLACS</span><span class=\"o\">.</span><span class=\"n\">rf_blaster_2_main_worker</span><span class=\"o\">.</span><span class=\"n\">worker</span><span class=\"p\">:</span> <span class=\"ne\">Exception</span> <span class=\"ow\">in</span> <span class=\"n\">job</span><span class=\"p\">:</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_devices\\RFBlaster.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">418</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">transition_to_buffered</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">http_request</span><span class=\"p\">(</span><span class=\"n\">form</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_devices\\RFBlaster.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">454</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">http_request</span>\n    <span class=\"n\">page</span> <span class=\"o\">=</span> <span class=\"sa\">b</span><span class=\"s1\">&#39;&#39;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">urlopen</span><span class=\"p\">(</span><span class=\"n\">req</span><span class=\"p\">,</span> <span class=\"n\">timeout</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">timeout</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">readlines</span><span class=\"p\">())</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\urllib2.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">154</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">urlopen</span>\n    <span class=\"k\">return</span> <span class=\"n\">opener</span><span class=\"o\">.</span><span class=\"n\">open</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">timeout</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\urllib2.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">429</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"nb\">open</span>\n    <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_open</span><span class=\"p\">(</span><span class=\"n\">req</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\urllib2.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">447</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_open</span>\n    <span class=\"s1\">&#39;_open&#39;</span><span class=\"p\">,</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\urllib2.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">407</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_call_chain</span>\n    <span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">func</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\urllib2.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1228</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">http_open</span>\n    <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">do_open</span><span class=\"p\">(</span><span class=\"n\">httplib</span><span class=\"o\">.</span><span class=\"n\">HTTPConnection</span><span class=\"p\">,</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\urllib2.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1195</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">do_open</span>\n    <span class=\"n\">h</span><span class=\"o\">.</span><span class=\"n\">request</span><span class=\"p\">(</span><span class=\"n\">req</span><span class=\"o\">.</span><span class=\"n\">get_method</span><span class=\"p\">(),</span> <span class=\"n\">req</span><span class=\"o\">.</span><span class=\"n\">get_selector</span><span class=\"p\">(),</span> <span class=\"n\">req</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\httplib.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1042</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">request</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_send_request</span><span class=\"p\">(</span><span class=\"n\">method</span><span class=\"p\">,</span> <span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"n\">body</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\httplib.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1082</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_send_request</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">endheaders</span><span class=\"p\">(</span><span class=\"n\">body</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\httplib.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1038</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">endheaders</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_send_output</span><span class=\"p\">(</span><span class=\"n\">message_body</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\ProgramData\\Anaconda2\\lib\\httplib.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">880</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_send_output</span>\n    <span class=\"n\">msg</span> <span class=\"o\">+=</span> <span class=\"n\">message_body</span>\n<span class=\"ne\">UnicodeDecodeError</span><span class=\"p\">:</span> <span class=\"s1\">&#39;ascii&#39;</span> <span class=\"n\">codec</span> <span class=\"n\">can</span><span class=\"s1\">&#39;t decode byte 0xe0 in position 277: ordinal not in range(128)</span>\n</pre></div>\n\n\n<p>This does not occur when removing the <code>unicode_literals</code> import.</p>", "type": "rendered"}, "created_on": "2018-07-31T04:41:24.175057+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "updated_on": "2018-07-31T04:41:24.183648+00:00", "type": "pullrequest_comment", "id": 71478694}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71546453.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71546453"}}, "parent": {"id": 71478694, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38/comments/71478694.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38/_/diff#comment-71478694"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/38.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/38"}}, "title": "Python3 RFBlaster"}, "content": {"raw": "Thanks Russ! Can you check if this is resolved by pull request #44?", "markup": "markdown", "html": "<p>Thanks Russ! Can you check if this is resolved by <a href=\"#!/labscript_suite/labscript_devices/pull-requests/44/fix-remaining-issue-with-unicode_literals\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #44</a>?</p>", "type": "rendered"}, "created_on": "2018-07-31T13:54:00.672281+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-07-31T13:54:00.689544+00:00", "type": "pullrequest_comment", "id": 71546453}], "page": 1, "size": 15}