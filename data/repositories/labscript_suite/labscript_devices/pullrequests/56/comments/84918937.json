{"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/56/comments/84918937.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/56/_/diff#comment-84918937"}}, "parent": {"id": 83702984, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/56/comments/83702984.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/56/_/diff#comment-83702984"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 56, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/56.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/56"}}, "title": "Universal NI DAQmx support"}, "content": {"raw": "\u200c\n\n> Sounds like maybe the acquisition worker isn't getting the zprocess event from the wait monitor worker indicating that waits are processed. If you're going to debug this further, if you turn on \\(via labconfig\\) the progress bar plugin for BLACS, it should indicate whether it's getting stuck on a wait - the progress bar also listens for zprocess events from the wait monitor in order to display waiting status.\n\nThe wait completes, even in the event of timeout. Some observations:\n\n* The `wait_monitor_worker` completes `wait_monitor` \\(reporting \u2018All waits finished\u2019\\).\n* The `wait_monitor_worker` never begins `transition_to_manual`, and thus never runs `wait_durations_analysed.post()`.\n* The `acquisition_worker` subsequently hangs on the `wait_durations_analysed.wait()` call in `extract_measurements` \\(during `transition_to_manual`\\). \n\nOn a related note, calls to `zprocess.Event.wait()` should ultimately time out by specifying a reasonable timeout value.", "markup": "markdown", "html": "<p>\u200c</p>\n<blockquote>\n<p>Sounds like maybe the acquisition worker isn't getting the zprocess event from the wait monitor worker indicating that waits are processed. If you're going to debug this further, if you turn on (via labconfig) the progress bar plugin for BLACS, it should indicate whether it's getting stuck on a wait - the progress bar also listens for zprocess events from the wait monitor in order to display waiting status.</p>\n</blockquote>\n<p>The wait completes, even in the event of timeout. Some observations:</p>\n<ul>\n<li>The <code>wait_monitor_worker</code> completes <code>wait_monitor</code> (reporting \u2018All waits finished\u2019).</li>\n<li>The <code>wait_monitor_worker</code> never begins <code>transition_to_manual</code>, and thus never runs <code>wait_durations_analysed.post()</code>.</li>\n<li>The <code>acquisition_worker</code> subsequently hangs on the <code>wait_durations_analysed.wait()</code> call in <code>extract_measurements</code> (during <code>transition_to_manual</code>). </li>\n</ul>\n<p>On a related note, calls to <code>zprocess.Event.wait()</code> should ultimately time out by specifying a reasonable timeout value.</p>", "type": "rendered"}, "created_on": "2018-12-07T09:51:20.119928+00:00", "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}, "updated_on": "2018-12-07T09:51:20.132443+00:00", "type": "pullrequest_comment", "id": 84918937}