{"pagelen": 50, "values": [{"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75/comments/108320223.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75/_/diff#comment-108320223"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}, "content": {"raw": "Thanks Chris!", "markup": "markdown", "html": "<p>Thanks Chris!</p>", "type": "rendered"}, "created_on": "2019-07-06T11:44:54.883065+00:00", "user": {"display_name": "Lincoln Turner", "uuid": "{7e35ca32-09d7-4a25-a548-32edef727dda}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D"}, "html": {"href": "https://bitbucket.org/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/2ac774c664cd58fc011cc65e0980b4c1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsLT-3.png"}}, "nickname": "lincolndturner", "type": "user", "account_id": "5b46a53d845e7e2cdff75ad3"}, "updated_on": "2019-07-06T11:44:55.278089+00:00", "type": "pullrequest_comment", "id": 108320223}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"update": {"description": "## Symptoms\r\n\r\n* RfBlaster device drivers are not working under Py3. BLACS tabs read status but cannot set static freq/amp/phase on the kloned webserver. Nor can they seem to upload binary compiled DDS data to the RfB RAM. Suspect error is in RFBlaster.py multipart form POSTing code. \r\n\r\n## Bug\r\n\r\nProbably in string handling in assembling the HTTP POST request.\r\n\r\n## Solution\r\n\r\nChanged RFBlaster.py BLACStab to use [requests ](https://2.python-requests.org/en/master/)[packa](http://packa.ge)ge, rather than homebrewed multipart form uploader plus urllib2 and friends. Requests is the defacto standard web client library.\r\n\r\nI kept this python2 compatible \\(perhaps\\) up to the commit tagged as such. I didn\u2019t realise tags shouldn\u2019t be used intra-branch - sorry. \r\n\r\nAfter that, it\u2019s Python-3 only. I cleaned out a bunch of defunct code and the BLACS tab is shorter.\r\n\r\n## Testing\r\n\r\nStatic control works. Buffered works. Dipole laser, controlled by rfB0 AOMs, comes on and seems to do dipole evap ramp OK. Will test on atoms shortly.\r\n\r\n## Side effects\r\n\r\nI did not change any of the labscript class, or the h5 file write code. \r\n\r\nCode that reads rfblaster binary \u2018data\u2019 from h5 file change in final rev to remove h5deprecationwarning not to use .value but to use the \\[\\(\\)\\] syntax instead. Seems to work.\r\n\r\n## TODO\r\n\r\nWe are still using constant-length strings in h5 files to store BLOBs, whereas h5py new standard is to use OPAQUE h5 dtype for this. Eventually these will be \u201copen\u201dable a la files, and so could be passed directly to requests.", "title": "RfBlasterPy3 bugfix", "destination": {"commit": {"hash": "f55ba5a76098", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/commit/f55ba5a76098.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/commits/f55ba5a76098"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices.json"}, "html": {"href": "#!/labscript_suite/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{30c94cb1-feec-4534-8885-92452023c9c9}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "labscript_suite/labscript_devices", "uuid": "{30c94cb1-feec-4534-8885-92452023c9c9}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "4ce709c1b1f9", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices/commit/4ce709c1b1f9"}, "html": {"href": "#!/monashspinor/labscript_devices/commits/4ce709c1b1f9"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices"}, "html": {"href": "#!/monashspinor/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{be4c7d93-6a88-4228-b761-162375a0fb62}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "monashspinor/labscript_devices", "uuid": "{be4c7d93-6a88-4228-b761-162375a0fb62}"}, "branch": {"name": "RfBlasterPy3-bugfix"}}, "state": "MERGED", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-07-05T18:24:14.043958+00:00"}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"update": {"description": "## Symptoms\r\n\r\n* RfBlaster device drivers are not working under Py3. BLACS tabs read status but cannot set static freq/amp/phase on the kloned webserver. Nor can they seem to upload binary compiled DDS data to the RfB RAM. Suspect error is in RFBlaster.py multipart form POSTing code. \r\n\r\n## Bug\r\n\r\nProbably in string handling in assembling the HTTP POST request.\r\n\r\n## Solution\r\n\r\nChanged RFBlaster.py BLACStab to use [requests ](https://2.python-requests.org/en/master/)[packa](http://packa.ge)ge, rather than homebrewed multipart form uploader plus urllib2 and friends. Requests is the defacto standard web client library.\r\n\r\nI kept this python2 compatible \\(perhaps\\) up to the commit tagged as such. I didn\u2019t realise tags shouldn\u2019t be used intra-branch - sorry. \r\n\r\nAfter that, it\u2019s Python-3 only. I cleaned out a bunch of defunct code and the BLACS tab is shorter.\r\n\r\n## Testing\r\n\r\nStatic control works. Buffered works. Dipole laser, controlled by rfB0 AOMs, comes on and seems to do dipole evap ramp OK. Will test on atoms shortly.\r\n\r\n## Side effects\r\n\r\nI did not change any of the labscript class, or the h5 file write code. \r\n\r\nCode that reads rfblaster binary \u2018data\u2019 from h5 file change in final rev to remove h5deprecationwarning not to use .value but to use the \\[\\(\\)\\] syntax instead. Seems to work.\r\n\r\n## TODO\r\n\r\nWe are still using constant-length strings in h5 files to store BLOBs, whereas h5py new standard is to use OPAQUE h5 dtype for this. Eventually these will be \u201copen\u201dable a la files, and so could be passed directly to requests.", "title": "RfBlasterPy3 bugfix", "destination": {"commit": {"hash": "f55ba5a76098", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/commit/f55ba5a76098.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/commits/f55ba5a76098"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices.json"}, "html": {"href": "#!/labscript_suite/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{30c94cb1-feec-4534-8885-92452023c9c9}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "labscript_suite/labscript_devices", "uuid": "{30c94cb1-feec-4534-8885-92452023c9c9}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "4ce709c1b1f9", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices/commit/4ce709c1b1f9"}, "html": {"href": "#!/monashspinor/labscript_devices/commits/4ce709c1b1f9"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices"}, "html": {"href": "#!/monashspinor/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{be4c7d93-6a88-4228-b761-162375a0fb62}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "monashspinor/labscript_devices", "uuid": "{be4c7d93-6a88-4228-b761-162375a0fb62}"}, "branch": {"name": "RfBlasterPy3-bugfix"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-07-05T18:24:13.082338+00:00"}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"approval": {"date": "2019-07-05T18:24:03.637860+00:00", "pullrequest": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}, "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75/comments/108301940.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75/_/diff#comment-108301940"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}, "content": {"raw": "Great!\n\nSince Monash spinor are the only people using this and they're on this branch anyway, I'm going to merge this. Thanks Lincoln!", "markup": "markdown", "html": "<p>Great!</p>\n<p>Since Monash spinor are the only people using this and they're on this branch anyway, I'm going to merge this. Thanks Lincoln!</p>", "type": "rendered"}, "created_on": "2019-07-05T18:23:57.098698+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2019-07-05T18:23:57.109115+00:00", "type": "pullrequest_comment", "id": 108301940}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75/comments/108209754.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75/_/diff#comment-108209754"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}, "content": {"raw": "I have just updated G.99 to Py3 \\(and don\u2019t have any RFBlasters in here at the moment anyway\\), and G.96 is offline ready to be rebuilt when parts arrive, so should get a fresh Py3 update before things get going again in there too. I don\u2019t think that we need to worry about Py2.7 compatibility for RFBlasters anymore.", "markup": "markdown", "html": "<p>I have just updated G.99 to Py3 (and don\u2019t have any RFBlasters in here at the moment anyway), and G.96 is offline ready to be rebuilt when parts arrive, so should get a fresh Py3 update before things get going again in there too. I don\u2019t think that we need to worry about Py2.7 compatibility for RFBlasters anymore.</p>", "type": "rendered"}, "created_on": "2019-07-05T06:35:04.183630+00:00", "user": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}, "updated_on": "2019-07-05T06:35:04.193200+00:00", "type": "pullrequest_comment", "id": 108209754}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75/comments/107303021.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75/_/diff#comment-107303021"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}, "content": {"raw": "Thanks Chris\u2026 I believe mon-KRb is on py2 still. I had lost track of the fact that they are using rfBlasters.\n\nI wasn\u2019t very careful with my py2 compat rev, but hopefully it will work. I\u2019ll arrange to test with @{557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4} sometime soon.\n\nLet\u2019s park it for now. \n\n\u2026 And yes, that block code looks a lot like what I didn\u2019t write for the labscript class :\\)", "markup": "markdown", "html": "<p>Thanks Chris\u2026 I believe mon-KRb is on py2 still. I had lost track of the fact that they are using rfBlasters.</p>\n<p>I wasn\u2019t very careful with my py2 compat rev, but hopefully it will work. I\u2019ll arrange to test with <span class=\"ap-mention\" data-atlassian-id=\"557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4\">@Shaun Johnstone</span> sometime soon.</p>\n<p>Let\u2019s park it for now. </p>\n<p>\u2026 And yes, that block code looks a lot like what I didn\u2019t write for the labscript class :)</p>", "type": "rendered"}, "created_on": "2019-06-27T12:03:02.590672+00:00", "user": {"display_name": "Lincoln Turner", "uuid": "{7e35ca32-09d7-4a25-a548-32edef727dda}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D"}, "html": {"href": "https://bitbucket.org/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/2ac774c664cd58fc011cc65e0980b4c1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsLT-3.png"}}, "nickname": "lincolndturner", "type": "user", "account_id": "5b46a53d845e7e2cdff75ad3"}, "updated_on": "2019-06-27T12:03:03.052964+00:00", "type": "pullrequest_comment", "id": 107303021}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75/comments/107302852.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75/_/diff#comment-107302852"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}, "content": {"raw": "Oh, actually I am aware the Monash KRb experiment was disassembled. Maybe they just haven't used RFBlasters since! \n\n@{557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4} can you confirm you don't have any need to use RFBlasters on Python 2?", "markup": "markdown", "html": "<p>Oh, actually I am aware the Monash KRb experiment was disassembled. Maybe they just haven't used RFBlasters since! </p>\n<p><span class=\"ap-mention\" data-atlassian-id=\"557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4\">@Shaun Johnstone</span> can you confirm you don't have any need to use RFBlasters on Python 2?</p>", "type": "rendered"}, "created_on": "2019-06-27T12:01:59.882605+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2019-06-27T12:01:59.900210+00:00", "type": "pullrequest_comment", "id": 107302852}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75/comments/107301274.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75/_/diff#comment-107301274"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}, "content": {"raw": "Thanks Lincoln!\n\nI just backed out the tag. \n\nI am assuming monash-KRb is on Python 2 still , right (otherwise their RFBlasters would have had the same issue)? If so then it wouldn't be great to have the RFBlaster require Python 3 quite yet. Perhaps we can have them test the final commit with Python 2 compatibility, and if all goes well merge that commit into mainline. Then we can merge the rest once KRb is on Python 3. Since nobody else is using RFBlasters in labscript I think this should be fine, otherwise I would not want to break Python 2 compatibility with existing code until Python 2 is EOL at the end of this year. \n\nRequests is not stdlib so we could add it to the installer's list of dependencies, or just not do that since only two labs are using the RFBlaster. Probably need to add to the labscript_devices subfolder spec a way of listing dependencies on a per-device basis since it makes no sense to require dependencies for devices you are are not using. So I guess don't worry about having to do anything with the non-stdlib dependency for now.\n\nCan convert to opaque h5 dtype later - I think this is what the lightcrafter DMD is using to store images:\n\n```python\n        # Apparently you should use np.void for binary data in a h5 file. Then on the way out, we need to use data.tostring() to decode again.\n        out_table = np.void(output.raw_output)\n        grp = self.init_device_group(hdf5_file)\n        grp.create_dataset('IMAGE_TABLE',compression=config.compression,data=out_table)\n```", "markup": "markdown", "html": "<p>Thanks Lincoln!</p>\n<p>I just backed out the tag. </p>\n<p>I am assuming monash-KRb is on Python 2 still , right (otherwise their RFBlasters would have had the same issue)? If so then it wouldn't be great to have the RFBlaster require Python 3 quite yet. Perhaps we can have them test the final commit with Python 2 compatibility, and if all goes well merge that commit into mainline. Then we can merge the rest once KRb is on Python 3. Since nobody else is using RFBlasters in labscript I think this should be fine, otherwise I would not want to break Python 2 compatibility with existing code until Python 2 is EOL at the end of this year. </p>\n<p>Requests is not stdlib so we could add it to the installer's list of dependencies, or just not do that since only two labs are using the RFBlaster. Probably need to add to the labscript_devices subfolder spec a way of listing dependencies on a per-device basis since it makes no sense to require dependencies for devices you are are not using. So I guess don't worry about having to do anything with the non-stdlib dependency for now.</p>\n<p>Can convert to opaque h5 dtype later - I think this is what the lightcrafter DMD is using to store images:</p>\n<div class=\"codehilite language-python\"><pre><span></span>        <span class=\"c1\"># Apparently you should use np.void for binary data in a h5 file. Then on the way out, we need to use data.tostring() to decode again.</span>\n        <span class=\"n\">out_table</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">void</span><span class=\"p\">(</span><span class=\"n\">output</span><span class=\"o\">.</span><span class=\"n\">raw_output</span><span class=\"p\">)</span>\n        <span class=\"n\">grp</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">init_device_group</span><span class=\"p\">(</span><span class=\"n\">hdf5_file</span><span class=\"p\">)</span>\n        <span class=\"n\">grp</span><span class=\"o\">.</span><span class=\"n\">create_dataset</span><span class=\"p\">(</span><span class=\"s1\">&#39;IMAGE_TABLE&#39;</span><span class=\"p\">,</span><span class=\"n\">compression</span><span class=\"o\">=</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">compression</span><span class=\"p\">,</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"n\">out_table</span><span class=\"p\">)</span>\n</pre></div>", "type": "rendered"}, "created_on": "2019-06-27T11:52:39.074744+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2019-06-27T11:53:51.896426+00:00", "type": "pullrequest_comment", "id": 107301274}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"update": {"description": "## Symptoms\r\n\r\n* RfBlaster device drivers are not working under Py3. BLACS tabs read status but cannot set static freq/amp/phase on the kloned webserver. Nor can they seem to upload binary compiled DDS data to the RfB RAM. Suspect error is in RFBlaster.py multipart form POSTing code. \r\n\r\n## Bug\r\n\r\nProbably in string handling in assembling the HTTP POST request.\r\n\r\n## Solution\r\n\r\nChanged RFBlaster.py BLACStab to use [requests ](https://2.python-requests.org/en/master/)[packa](http://packa.ge)ge, rather than homebrewed multipart form uploader plus urllib2 and friends. Requests is the defacto standard web client library.\r\n\r\nI kept this python2 compatible \\(perhaps\\) up to the commit tagged as such. I didn\u2019t realise tags shouldn\u2019t be used intra-branch - sorry. \r\n\r\nAfter that, it\u2019s Python-3 only. I cleaned out a bunch of defunct code and the BLACS tab is shorter.\r\n\r\n## Testing\r\n\r\nStatic control works. Buffered works. Dipole laser, controlled by rfB0 AOMs, comes on and seems to do dipole evap ramp OK. Will test on atoms shortly.\r\n\r\n## Side effects\r\n\r\nI did not change any of the labscript class, or the h5 file write code. \r\n\r\nCode that reads rfblaster binary \u2018data\u2019 from h5 file change in final rev to remove h5deprecationwarning not to use .value but to use the \\[\\(\\)\\] syntax instead. Seems to work.\r\n\r\n## TODO\r\n\r\nWe are still using constant-length strings in h5 files to store BLOBs, whereas h5py new standard is to use OPAQUE h5 dtype for this. Eventually these will be \u201copen\u201dable a la files, and so could be passed directly to requests.", "title": "RfBlasterPy3 bugfix", "destination": {"commit": {"hash": "b680ed305954", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/commit/b680ed305954.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/commits/b680ed305954"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices.json"}, "html": {"href": "#!/labscript_suite/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{30c94cb1-feec-4534-8885-92452023c9c9}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "labscript_suite/labscript_devices", "uuid": "{30c94cb1-feec-4534-8885-92452023c9c9}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "4ce709c1b1f9", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices/commit/4ce709c1b1f9"}, "html": {"href": "#!/monashspinor/labscript_devices/commits/4ce709c1b1f9"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices"}, "html": {"href": "#!/monashspinor/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{be4c7d93-6a88-4228-b761-162375a0fb62}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "monashspinor/labscript_devices", "uuid": "{be4c7d93-6a88-4228-b761-162375a0fb62}"}, "branch": {"name": "RfBlasterPy3-bugfix"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-06-27T11:39:08.094634+00:00"}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75/comments/107246455.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75/_/diff#comment-107246455"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}, "content": {"raw": "This was a mistake\u2026 probably shouldn\u2019t tag like this in a branch as it will tag the whole repo as Russ pointed out. Sorry.", "markup": "markdown", "html": "<p>This was a mistake\u2026 probably shouldn\u2019t tag like this in a branch as it will tag the whole repo as Russ pointed out. Sorry.</p>", "type": "rendered"}, "created_on": "2019-06-27T06:24:57.475459+00:00", "user": {"display_name": "Lincoln Turner", "uuid": "{7e35ca32-09d7-4a25-a548-32edef727dda}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D"}, "html": {"href": "https://bitbucket.org/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/2ac774c664cd58fc011cc65e0980b4c1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsLT-3.png"}}, "nickname": "lincolndturner", "type": "user", "account_id": "5b46a53d845e7e2cdff75ad3"}, "inline": {}, "updated_on": "2019-06-27T06:24:57.630743+00:00", "type": "pullrequest_comment", "id": 107246455}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"update": {"description": "## Symptoms\r\n\r\n* RfBlaster device drivers are not working under Py3. BLACS tabs read status but cannot set static freq/amp/phase on the kloned webserver. Nor can they seem to upload binary compiled DDS data to the RfB RAM. Suspect error is in RFBlaster.py multipart form POSTing code. \r\n\r\n## Bug\r\n\r\nProbably in string handling in assembling the HTTP POST request.\r\n\r\n## Solution\r\n\r\nChanged RFBlaster.py BLACStab to use [requests ](https://2.python-requests.org/en/master/)[packa](http://packa.ge)ge, rather than homebrewed multipart form uploader plus urllib2 and friends. Requests is the defacto standard web client library.\r\n\r\nI kept this python2 compatible \\(perhaps\\) up to the commit tagged as such. I didn\u2019t realise tags shouldn\u2019t be used intra-branch - sorry. \r\n\r\nAfter that, it\u2019s Python-3 only. I cleaned out a bunch of defunct code and the BLACS tab is shorter.\r\n\r\n## Testing\r\n\r\nStatic control works. Buffered works. Dipole laser, controlled by rfB0 AOMs, comes on and seems to do dipole evap ramp OK. Will test on atoms shortly.\r\n\r\n## Side effects\r\n\r\nI did not change any of the labscript class, or the h5 file write code. \r\n\r\nCode that reads rfblaster binary \u2018data\u2019 from h5 file change in final rev to remove h5deprecationwarning not to use .value but to use the \\[\\(\\)\\] syntax instead. Seems to work.\r\n\r\n## TODO\r\n\r\nWe are still using constant-length strings in h5 files to store BLOBs, whereas h5py new standard is to use OPAQUE h5 dtype for this. Eventually these will be \u201copen\u201dable a la files, and so could be passed directly to requests.", "title": "RfBlasterPy3 bugfix", "destination": {"commit": {"hash": "b680ed305954", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/commit/b680ed305954.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/commits/b680ed305954"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices.json"}, "html": {"href": "#!/labscript_suite/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{30c94cb1-feec-4534-8885-92452023c9c9}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "labscript_suite/labscript_devices", "uuid": "{30c94cb1-feec-4534-8885-92452023c9c9}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a1ecee8938d1", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices/commit/a1ecee8938d1"}, "html": {"href": "#!/monashspinor/labscript_devices/commits/a1ecee8938d1"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices"}, "html": {"href": "#!/monashspinor/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{be4c7d93-6a88-4228-b761-162375a0fb62}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "monashspinor/labscript_devices", "uuid": "{be4c7d93-6a88-4228-b761-162375a0fb62}"}, "branch": {"name": "RfBlasterPy3-bugfix"}}, "state": "OPEN", "author": {"display_name": "Lincoln Turner", "uuid": "{7e35ca32-09d7-4a25-a548-32edef727dda}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D"}, "html": {"href": "https://bitbucket.org/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/2ac774c664cd58fc011cc65e0980b4c1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsLT-3.png"}}, "nickname": "lincolndturner", "type": "user", "account_id": "5b46a53d845e7e2cdff75ad3"}, "date": "2019-06-27T06:24:11.720062+00:00"}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}, {"update": {"description": "## Symptoms\r\n\r\n* RfBlaster device drivers are not working under Py3. BLACS tabs read status but cannot set static freq/amp/phase on the kloned webserver. Nor can they seem to upload binary compiled DDS data to the RfB RAM. Suspect error is in RFBlaster.py multipart form POSTing code. \r\n\r\n## Bug\r\n\r\nProbably in string handling in assembling the HTTP POST request.\r\n\r\n## Solution\r\n\r\nChanged RFBlaster.py BLACStab to use [requests ](https://2.python-requests.org/en/master/)[packa](http://packa.ge)ge, rather than homebrewed multipart form uploader plus urllib2 and friends. Requests is the defacto standard web client library.\r\n\r\nI kept this python2 compatible \\(perhaps\\) up to the commit tagged as such. I didn\u2019t realise tags shouldn\u2019t be used intra-branch - sorry. \r\n\r\nAfter that, it\u2019s Python-3 only. I cleaned out a bunch of defunct code and the BLACS tab is shorter.\r\n\r\n## Testing\r\n\r\nStatic control works. Buffered works. Dipole laser, controlled by rfB0 AOMs, comes on and seems to do dipole evap ramp OK. Will test on atoms shortly.\r\n\r\n## Side effects\r\n\r\nI did not change any of the labscript class, or the h5 file write code. \r\n\r\nCode that reads rfblaster binary \u2018data\u2019 from h5 file change in final rev to remove h5deprecationwarning not to use .value but to use the \\[\\(\\)\\] syntax instead. Seems to work.\r\n\r\n## TODO\r\n\r\nWe are still using constant-length strings in h5 files to store BLOBs, whereas h5py new standard is to use OPAQUE h5 dtype for this. Eventually these will be \u201copen\u201dable a la files, and so could be passed directly to requests.", "title": "RfBlasterPy3 bugfix", "destination": {"commit": {"hash": "b680ed305954", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/commit/b680ed305954.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/commits/b680ed305954"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices.json"}, "html": {"href": "#!/labscript_suite/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{30c94cb1-feec-4534-8885-92452023c9c9}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "labscript_suite/labscript_devices", "uuid": "{30c94cb1-feec-4534-8885-92452023c9c9}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a1ecee8938d1", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices/commit/a1ecee8938d1"}, "html": {"href": "#!/monashspinor/labscript_devices/commits/a1ecee8938d1"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashspinor/labscript_devices"}, "html": {"href": "#!/monashspinor/labscript_devices"}, "avatar": {"href": "data/bytebucket.org/ravatar/{be4c7d93-6a88-4228-b761-162375a0fb62}ts=python"}}, "type": "repository", "name": "labscript_devices", "full_name": "monashspinor/labscript_devices", "uuid": "{be4c7d93-6a88-4228-b761-162375a0fb62}"}, "branch": {"name": "RfBlasterPy3-bugfix"}}, "state": "OPEN", "author": {"display_name": "Lincoln Turner", "uuid": "{7e35ca32-09d7-4a25-a548-32edef727dda}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D"}, "html": {"href": "https://bitbucket.org/%7B7e35ca32-09d7-4a25-a548-32edef727dda%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/2ac774c664cd58fc011cc65e0980b4c1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsLT-3.png"}}, "nickname": "lincolndturner", "type": "user", "account_id": "5b46a53d845e7e2cdff75ad3"}, "date": "2019-06-27T06:24:11.649172+00:00"}, "pull_request": {"type": "pullrequest", "id": 75, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/75.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/75"}}, "title": "RfBlasterPy3 bugfix"}}]}