{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9/comments/19697862.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9/_/diff#comment-19697862"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 9, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9"}}, "title": "Update of NIBoard.py for DIO cards with multiple ports"}, "content": {"raw": "Hi Cameron,\n\nThanks for submitting a pull request!\n\nWe're going to need to make a few changes in order to maintain backwards compatibility with the other NI classes. I think this requires:\n\n* setting the default value for `n_ports` in NIBoard.py to `1`\n* renaming `n_ports` to `n_digital_ports` (just so the naming convention is more explicit)\n* Removing the class variable `n_lines` and defining a new Python property `n_digital_lines_per_port` in both the NIBoard.py labscript and runviewer classes. This avoids the need to go and edit every NI labscript class to define n_lines correctly, and will maintain compatibility with any NI classes that other groups have made, but have not been contributed back to our repository. The method definition should look something like:\n\n```\n#!python\n\n@property\ndef n_digital_lines_per_port(self):\n    assert self.n_digitals%self.n_ports == 0, 'The number of digital lines defined for device class %s is not divisible by the number of digital ports.'%self.__class__.__name__\n    return self.n_digitals//self.n_ports\n```\n\n* renaming `self.n_lines` to `self.n_digital_lines_per_port`\n\nI think this also means:\n\n* The above changes to the defaults will require you to actively specify correct values for `n_digitals` and `n_digital_ports` in your subclasses for labscript and runviewer in the NI PXI 6733 and NI PXIe 6535 files.\n* Your two subclasses seem to still be using myNIBoard as the parent. Could you change this to NIBoard and test both again.\n\nYou might also want to consider whether you can just subclass the NI_PCI_6733 classes for the NI_PXI_6733 classes. Are there actually any differences between the two classes? I notice you don't have the digital lines in the PXI_6733, although I believe it still has 8 like the PCI_6733?\n\nApologies for the long list of changes! I try and avoid major version number increases as much as possible so people with their own code don't have to regularly update to a new API.\n\nCheers,\nPhil", "markup": "markdown", "html": "<p>Hi Cameron,</p>\n<p>Thanks for submitting a pull request!</p>\n<p>We're going to need to make a few changes in order to maintain backwards compatibility with the other NI classes. I think this requires:</p>\n<ul>\n<li>setting the default value for <code>n_ports</code> in NIBoard.py to <code>1</code></li>\n<li>renaming <code>n_ports</code> to <code>n_digital_ports</code> (just so the naming convention is more explicit)</li>\n<li>Removing the class variable <code>n_lines</code> and defining a new Python property <code>n_digital_lines_per_port</code> in both the NIBoard.py labscript and runviewer classes. This avoids the need to go and edit every NI labscript class to define n_lines correctly, and will maintain compatibility with any NI classes that other groups have made, but have not been contributed back to our repository. The method definition should look something like:</li>\n</ul>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"nd\">@property</span>\n<span class=\"k\">def</span> <span class=\"nf\">n_digital_lines_per_port</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n    <span class=\"k\">assert</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_digitals</span><span class=\"o\">%</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_ports</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"s1\">&#39;The number of digital lines defined for device class </span><span class=\"si\">%s</span><span class=\"s1\"> is not divisible by the number of digital ports.&#39;</span><span class=\"o\">%</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"vm\">__class__</span><span class=\"o\">.</span><span class=\"vm\">__name__</span>\n    <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_digitals</span><span class=\"o\">//</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_ports</span>\n</pre></div>\n\n\n<ul>\n<li>renaming <code>self.n_lines</code> to <code>self.n_digital_lines_per_port</code></li>\n</ul>\n<p>I think this also means:</p>\n<ul>\n<li>The above changes to the defaults will require you to actively specify correct values for <code>n_digitals</code> and <code>n_digital_ports</code> in your subclasses for labscript and runviewer in the NI PXI 6733 and NI PXIe 6535 files.</li>\n<li>Your two subclasses seem to still be using myNIBoard as the parent. Could you change this to NIBoard and test both again.</li>\n</ul>\n<p>You might also want to consider whether you can just subclass the NI_PCI_6733 classes for the NI_PXI_6733 classes. Are there actually any differences between the two classes? I notice you don't have the digital lines in the PXI_6733, although I believe it still has 8 like the PCI_6733?</p>\n<p>Apologies for the long list of changes! I try and avoid major version number increases as much as possible so people with their own code don't have to regularly update to a new API.</p>\n<p>Cheers,\nPhil</p>", "type": "rendered"}, "created_on": "2016-06-13T23:59:28.678216+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2016-06-13T23:59:28.953056+00:00", "type": "pullrequest_comment", "id": 19697862}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9/comments/19697891.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9/_/diff#comment-19697891"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 9, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9"}}, "title": "Update of NIBoard.py for DIO cards with multiple ports"}, "content": {"raw": "@cbillington Can you also review", "markup": "markdown", "html": "<p>@cbillington Can you also review</p>", "type": "rendered"}, "created_on": "2016-06-14T00:00:32.584590+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2016-06-14T00:00:32.595167+00:00", "type": "pullrequest_comment", "id": 19697891}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9/comments/39180722.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9/_/diff#comment-39180722"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 9, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9"}}, "title": "Update of NIBoard.py for DIO cards with multiple ports"}, "content": {"raw": "Chris: have you pulled the modular \"NI_DAQmx\" class from the JQI branch yet?  This might have some impact on this pull request.  Since the code at JQI is fairly heavily tested (locally) I would want to get that pulled.", "markup": "markdown", "html": "<p>Chris: have you pulled the modular \"NI_DAQmx\" class from the JQI branch yet?  This might have some impact on this pull request.  Since the code at JQI is fairly heavily tested (locally) I would want to get that pulled.</p>", "type": "rendered"}, "created_on": "2017-06-20T13:36:32.736012+00:00", "user": {"display_name": "Ian B. Spielman", "uuid": "{bff0d3df-2ed5-4ff6-b13d-ce6cd935edb1}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bbff0d3df-2ed5-4ff6-b13d-ce6cd935edb1%7D"}, "html": {"href": "https://bitbucket.org/%7Bbff0d3df-2ed5-4ff6-b13d-ce6cd935edb1%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/54beee087619e1a612011791e203f277d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsIS-0.png"}}, "nickname": "Ian Spielman", "type": "user", "account_id": "557058:b0e98d01-12e7-4a9d-a274-a195def255d2"}, "updated_on": "2017-06-20T14:05:59.709540+00:00", "type": "pullrequest_comment", "id": 39180722}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9/comments/39184987.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9/_/diff#comment-39184987"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 9, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9"}}, "title": "Update of NIBoard.py for DIO cards with multiple ports"}, "content": {"raw": "Cameron,\n\nWe have made some changes to the NI card classes at JQI that allow for definitions of pretty much any NI card like this:\n\n```\nNI_DAQmx(name='ni_pci_6733_0', parent_device=pulseblaster_0_ni_pci_clock,\n        MAX_name='Dev1',\n        clock_terminal='/Dev1/RTSI0', \n        num_AO=8,\n        sample_rate_AO=700e3,\n        num_DO=8,\n        sample_rate_DO=2e6,\n        num_AI=0,\n        clock_terminal_AI='/Dev1/PFI0',\n        mode_AI='labscript', # 'labscript', 'gated', 'triggered'\n        sample_rate_AI=1000,\n        num_PFI=0\n)\n```\nin the actual lab script.  To a large extent this eliminates the need for different classes for essentially identical devices.  I would like to get this pulled and then (if needed) get your code in as well.  I think this solves your problem since you will define num_DO to get the different ports.  If this is not correct we could add a new ports_DO to the signature of this object.\n\nIn the JQI experiments, this is the only object we use for all of our NI devices, so it is fairly well tested.  We use the DO's heavily, so that aspect is strong as well.\n", "markup": "markdown", "html": "<p>Cameron,</p>\n<p>We have made some changes to the NI card classes at JQI that allow for definitions of pretty much any NI card like this:</p>\n<div class=\"codehilite\"><pre><span></span>NI_DAQmx(name=&#39;ni_pci_6733_0&#39;, parent_device=pulseblaster_0_ni_pci_clock,\n        MAX_name=&#39;Dev1&#39;,\n        clock_terminal=&#39;/Dev1/RTSI0&#39;, \n        num_AO=8,\n        sample_rate_AO=700e3,\n        num_DO=8,\n        sample_rate_DO=2e6,\n        num_AI=0,\n        clock_terminal_AI=&#39;/Dev1/PFI0&#39;,\n        mode_AI=&#39;labscript&#39;, # &#39;labscript&#39;, &#39;gated&#39;, &#39;triggered&#39;\n        sample_rate_AI=1000,\n        num_PFI=0\n)\n</pre></div>\n\n\n<p>in the actual lab script.  To a large extent this eliminates the need for different classes for essentially identical devices.  I would like to get this pulled and then (if needed) get your code in as well.  I think this solves your problem since you will define num_DO to get the different ports.  If this is not correct we could add a new ports_DO to the signature of this object.</p>\n<p>In the JQI experiments, this is the only object we use for all of our NI devices, so it is fairly well tested.  We use the DO's heavily, so that aspect is strong as well.</p>", "type": "rendered"}, "created_on": "2017-06-20T14:10:48.563817+00:00", "user": {"display_name": "Ian B. Spielman", "uuid": "{bff0d3df-2ed5-4ff6-b13d-ce6cd935edb1}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bbff0d3df-2ed5-4ff6-b13d-ce6cd935edb1%7D"}, "html": {"href": "https://bitbucket.org/%7Bbff0d3df-2ed5-4ff6-b13d-ce6cd935edb1%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/54beee087619e1a612011791e203f277d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsIS-0.png"}}, "nickname": "Ian Spielman", "type": "user", "account_id": "557058:b0e98d01-12e7-4a9d-a274-a195def255d2"}, "updated_on": "2017-06-20T14:12:19.471112+00:00", "type": "pullrequest_comment", "id": 39184987}, {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9/comments/81996633.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9/_/diff#comment-81996633"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 9, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_devices/pullrequests/9.json"}, "html": {"href": "#!/labscript_suite/labscript_devices/pull-requests/9"}}, "title": "Update of NIBoard.py for DIO cards with multiple ports"}, "content": {"raw": "Pull request #56, which adds general-purpose support for NI-DAQmx devices supersedes this one, and so I will decline this one. Thanks for your work on this @cast7989, I'm sure you understand that more general support is preferable to the code duplication that we have all been doing so far!\n\nThere seems to be an issue with the general-purpose code and the PXIe 6535 though, I will discuss it in the comment thread for PR #56.", "markup": "markdown", "html": "<p><a href=\"#!/labscript_suite/labscript_devices/pull-requests/56/universal-ni-daqmx-support\" rel=\"nofollow\" class=\"ap-connect-link\">Pull request #56</a>, which adds general-purpose support for NI-DAQmx devices supersedes this one, and so I will decline this one. Thanks for your work on this @cast7989, I'm sure you understand that more general support is preferable to the code duplication that we have all been doing so far!</p>\n<p>There seems to be an issue with the general-purpose code and the PXIe 6535 though, I will discuss it in the comment thread for <a href=\"#!/labscript_suite/labscript_devices/pull-requests/56/universal-ni-daqmx-support\" rel=\"nofollow\" class=\"ap-connect-link\">PR #56</a>.</p>", "type": "rendered"}, "created_on": "2018-11-10T18:13:27.545482+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-11-10T18:13:27.593574+00:00", "type": "pullrequest_comment", "id": 81996633}], "page": 1, "size": 5}