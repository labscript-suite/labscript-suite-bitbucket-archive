{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "links": {"attachments": {"href": "data/repositories/labscript_suite/labscript_utils/issues/18/attachments_page=1.json"}, "self": {"href": "data/repositories/labscript_suite/labscript_utils/issues/18.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_utils/issues/18/watch"}, "comments": {"href": "data/repositories/labscript_suite/labscript_utils/issues/18/comments_page=1.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/issues/18/double-import-denier-breaks-with-runviewer"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_utils/issues/18/vote"}}, "reporter": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "title": "Double import denier breaks with runviewer v2.1.0", "component": null, "votes": 0, "watches": 2, "content": {"raw": "The latest tagged version of runviewer is v2.1.0. When using the tagged (or tip) version of labscript utils, the following exception is raised:\r\n\r\n\r\n```\r\n#!python\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\labscript_suite\\labscript_py27\\runviewer\\__main__.py\", line 78, in <module>\r\n    from resample import resample as _resample\r\nRuntimeError: Double import! The same file has been imported under two different names, resulting in two copies of the module. This is almost certainly a mistake. If you are running a script from within a package and want to import another submodule of that package, import it by its full path: 'import module.submodule' instead of just 'import submodule.'\r\n\r\nPath imported: C:\\labscript_suite\\labscript_py27\\runviewer\\resample\r\n\r\nTraceback (first time imported, as resample):\r\n------------\r\n  File \"C:\\labscript_suite\\labscript_py27\\runviewer\\__main__.py\", line 78, in <module>\r\n    from resample import resample as _resample\r\n------------\r\n\r\nTraceback (second time imported, as runviewer.resample):\r\n------------\r\n  File \"C:\\labscript_suite\\labscript_py27\\runviewer\\__main__.py\", line 78, in <module>\r\n    from resample import resample as _resample\r\n  File \"C:\\labscript_suite\\labscript_py27\\runviewer\\resample\\__init__.py\", line 33, in <module>\r\n    module = importlib.import_module('runviewer.resample.%s.resample'%plat_name)\r\n  File \"C:\\Anaconda3\\envs\\labscript_py27\\lib\\importlib\\__init__.py\", line 37, in import_module\r\n    __import__(name)\r\n------------\r\n\r\n```\r\n\r\nUpdating runviewer to tip fixes the issue (and so we should really tag a new runviewer version ASAP), but only because we change the way we compile and use the resample algorithm. However it looks to me like the double import denier is still being too aggressive here because a single import line triggered the double import denier.", "markup": "markdown", "html": "<p>The latest tagged version of runviewer is v2.1.0. When using the tagged (or tip) version of labscript utils, the following exception is raised:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unviewer\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">78</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">resample</span> <span class=\"kn\">import</span> <span class=\"n\">resample</span> <span class=\"k\">as</span> <span class=\"n\">_resample</span>\n<span class=\"ne\">RuntimeError</span><span class=\"p\">:</span> <span class=\"n\">Double</span> <span class=\"n\">import</span><span class=\"err\">!</span> <span class=\"n\">The</span> <span class=\"n\">same</span> <span class=\"nb\">file</span> <span class=\"n\">has</span> <span class=\"n\">been</span> <span class=\"n\">imported</span> <span class=\"n\">under</span> <span class=\"n\">two</span> <span class=\"n\">different</span> <span class=\"n\">names</span><span class=\"p\">,</span> <span class=\"n\">resulting</span> <span class=\"ow\">in</span> <span class=\"n\">two</span> <span class=\"n\">copies</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">module</span><span class=\"o\">.</span> <span class=\"n\">This</span> <span class=\"ow\">is</span> <span class=\"n\">almost</span> <span class=\"n\">certainly</span> <span class=\"n\">a</span> <span class=\"n\">mistake</span><span class=\"o\">.</span> <span class=\"n\">If</span> <span class=\"n\">you</span> <span class=\"n\">are</span> <span class=\"n\">running</span> <span class=\"n\">a</span> <span class=\"n\">script</span> <span class=\"kn\">from</span> <span class=\"nn\">within</span> <span class=\"nn\">a</span> <span class=\"nn\">package</span> <span class=\"nn\">and</span> <span class=\"nn\">want</span> <span class=\"nn\">to</span> <span class=\"kn\">import</span> <span class=\"n\">another</span> <span class=\"n\">submodule</span> <span class=\"n\">of</span> <span class=\"n\">that</span> <span class=\"n\">package</span><span class=\"p\">,</span> <span class=\"kn\">import</span> <span class=\"nn\">it</span> <span class=\"nn\">by</span> <span class=\"nn\">its</span> <span class=\"nn\">full</span> <span class=\"nn\">path</span><span class=\"p\">:</span> <span class=\"s1\">&#39;import module.submodule&#39;</span> <span class=\"n\">instead</span> <span class=\"n\">of</span> <span class=\"n\">just</span> <span class=\"s1\">&#39;import submodule.&#39;</span>\n\n<span class=\"n\">Path</span> <span class=\"n\">imported</span><span class=\"p\">:</span> <span class=\"n\">C</span><span class=\"p\">:</span>\\<span class=\"n\">labscript_suite</span>\\<span class=\"n\">labscript_py27</span>\\<span class=\"n\">runviewer</span>\\<span class=\"n\">resample</span>\n\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">first</span> <span class=\"n\">time</span> <span class=\"n\">imported</span><span class=\"p\">,</span> <span class=\"k\">as</span> <span class=\"n\">resample</span><span class=\"p\">):</span>\n<span class=\"o\">------------</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unviewer\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">78</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">resample</span> <span class=\"kn\">import</span> <span class=\"n\">resample</span> <span class=\"k\">as</span> <span class=\"n\">_resample</span>\n<span class=\"o\">------------</span>\n\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">second</span> <span class=\"n\">time</span> <span class=\"n\">imported</span><span class=\"p\">,</span> <span class=\"k\">as</span> <span class=\"n\">runviewer</span><span class=\"o\">.</span><span class=\"n\">resample</span><span class=\"p\">):</span>\n<span class=\"o\">------------</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unviewer\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">78</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">resample</span> <span class=\"kn\">import</span> <span class=\"n\">resample</span> <span class=\"k\">as</span> <span class=\"n\">_resample</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unviewer</span><span class=\"se\">\\r</span><span class=\"s2\">esample\\__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">33</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"n\">module</span> <span class=\"o\">=</span> <span class=\"n\">importlib</span><span class=\"o\">.</span><span class=\"n\">import_module</span><span class=\"p\">(</span><span class=\"s1\">&#39;runviewer.resample.</span><span class=\"si\">%s</span><span class=\"s1\">.resample&#39;</span><span class=\"o\">%</span><span class=\"n\">plat_name</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\Anaconda3\\envs\\labscript_py27\\lib\\importlib\\__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">37</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">import_module</span>\n    <span class=\"nb\">__import__</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">)</span>\n<span class=\"o\">------------</span>\n</pre></div>\n\n\n<p>Updating runviewer to tip fixes the issue (and so we should really tag a new runviewer version ASAP), but only because we change the way we compile and use the resample algorithm. However it looks to me like the double import denier is still being too aggressive here because a single import line triggered the double import denier.</p>", "type": "rendered"}, "assignee": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "state": "resolved", "version": null, "edited_on": null, "created_on": "2018-04-30T04:12:10.656272+00:00", "milestone": null, "updated_on": "2018-04-30T08:23:40.755393+00:00", "type": "issue", "id": 18}