{"pagelen": 50, "values": [{"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs\r\n    within a tabbar~~.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    The lost functionality ~~can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet~~ has been restored.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "1ca691f3c898", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/1ca691f3c898.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/1ca691f3c898"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "da6423d3da5c", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/da6423d3da5c"}, "html": {"href": "#!/cbillington/labscript_utils/commits/da6423d3da5c"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "MERGED", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-10-04T16:27:33.523597+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs\r\n    within a tabbar~~.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    The lost functionality ~~can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet~~ has been restored.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "1ca691f3c898", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/1ca691f3c898.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/1ca691f3c898"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "da6423d3da5c", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/da6423d3da5c"}, "html": {"href": "#!/cbillington/labscript_utils/commits/da6423d3da5c"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-10-04T16:27:32.795031+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs\r\n    within a tabbar~~.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    The lost functionality ~~can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet~~ has been restored.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "1ca691f3c898", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/1ca691f3c898.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/1ca691f3c898"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "da6423d3da5c", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/da6423d3da5c"}, "html": {"href": "#!/cbillington/labscript_utils/commits/da6423d3da5c"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-10-04T16:27:11.722933+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43654641.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43654641"}}, "parent": {"id": 43654378, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43654378.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43654378"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "First is by design too - but I was undecided about it. Not sure which is more jarring, not being able to drop on a widget or having the tab snap to the tabBar when it's potentially miles away from your mouse.\n\nIt's trivial to change so you can revert it to accept drops anywhere by setting `accept_drops_bar_only=False` as the default in the `DragDropTabWidget` `__init__` args. I'm pretty ambivalent about this one.\n\nSecond was because it was going to involve reimplementing the scrolling and keeping track of the scroll position to work with that. It would have involved a lot more code at the pixel-pushing level than I already had to do!", "markup": "markdown", "html": "<p>First is by design too - but I was undecided about it. Not sure which is more jarring, not being able to drop on a widget or having the tab snap to the tabBar when it's potentially miles away from your mouse.</p>\n<p>It's trivial to change so you can revert it to accept drops anywhere by setting <code>accept_drops_bar_only=False</code> as the default in the <code>DragDropTabWidget</code> <code>__init__</code> args. I'm pretty ambivalent about this one.</p>\n<p>Second was because it was going to involve reimplementing the scrolling and keeping track of the scroll position to work with that. It would have involved a lot more code at the pixel-pushing level than I already had to do!</p>", "type": "rendered"}, "created_on": "2017-08-28T00:23:49.123709+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-28T00:26:10.264879+00:00", "type": "pullrequest_comment", "id": 43654641}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43654378.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43654378"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "So finally got around to testing this. Couple of lost features/unexpected changes I've found are:\n\n* You can't drop a tab onto the widget of another tab anymore (but you can if the notebook doesn't have any tabs yet)\n* If you have lots of tabs, the width of each tab shrinks rather than allowing scrolling\n\nThe second one looks like it is [by design](#!/labscript_suite/labscript_utils/pull-requests/21/dragdroptab/diff#Lqtwidgets/dragdroptab.pyT379). If this is personal taste, we should perhaps make it configurable through the preferences pane at a later date. The first one may be a bug. It's not a big bug though, so I may consider just merging this anyway and it can be fixed later when Chris Billington is available again.", "markup": "markdown", "html": "<p>So finally got around to testing this. Couple of lost features/unexpected changes I've found are:</p>\n<ul>\n<li>You can't drop a tab onto the widget of another tab anymore (but you can if the notebook doesn't have any tabs yet)</li>\n<li>If you have lots of tabs, the width of each tab shrinks rather than allowing scrolling</li>\n</ul>\n<p>The second one looks like it is <a data-is-external-link=\"true\" href=\"#!/labscript_suite/labscript_utils/pull-requests/21/dragdroptab/diff#Lqtwidgets/dragdroptab.pyT379\" rel=\"nofollow\">by design</a>. If this is personal taste, we should perhaps make it configurable through the preferences pane at a later date. The first one may be a bug. It's not a big bug though, so I may consider just merging this anyway and it can be fixed later when Chris Billington is available again.</p>", "type": "rendered"}, "created_on": "2017-08-28T00:06:28.720160+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2017-08-28T00:06:28.722937+00:00", "type": "pullrequest_comment", "id": 43654378}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"approval": {"date": "2017-08-25T05:05:03.360493+00:00", "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "user": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150702.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150702"}}, "parent": {"id": 43150680, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150680.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150680"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "The fix works! Thanks :)", "markup": "markdown", "html": "<p>The fix works! Thanks :)</p>", "type": "rendered"}, "created_on": "2017-08-19T14:33:18.580920+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-19T14:33:18.616448+00:00", "type": "pullrequest_comment", "id": 43150702}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150680.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150680"}}, "parent": {"id": 43150639, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150639.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150639"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "No problem. Just pushed what should be a fix.\n\nIt's a very simple fix and I didn't know about `grabMouse()` and `releaseMouse()`, hence the workaround with leaveEvent to detect when we were not going to receive future mouse events anymore. Now that I know about these two it's a cleaner implementation less likely to lose mouse events in any other unforseen ways. I was able to just delete the `leaveEvent()` method entirely.", "markup": "markdown", "html": "<p>No problem. Just pushed what should be a fix.</p>\n<p>It's a very simple fix and I didn't know about <code>grabMouse()</code> and <code>releaseMouse()</code>, hence the workaround with leaveEvent to detect when we were not going to receive future mouse events anymore. Now that I know about these two it's a cleaner implementation less likely to lose mouse events in any other unforseen ways. I was able to just delete the <code>leaveEvent()</code> method entirely.</p>", "type": "rendered"}, "created_on": "2017-08-19T14:30:52.572208+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T14:31:31.161976+00:00", "type": "pullrequest_comment", "id": 43150680}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs\r\n    within a tabbar~~.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    The lost functionality ~~can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet~~ has been restored.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "1ca691f3c898", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/1ca691f3c898.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/1ca691f3c898"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "ee9d77a95e92", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/ee9d77a95e92"}, "html": {"href": "#!/cbillington/labscript_utils/commits/ee9d77a95e92"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-19T14:28:51.809980+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150639.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150639"}}, "parent": {"id": 43150613, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150613.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150613"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Thanks for taking the time to fix this. \n\nIt is mostly annoyance  when testing plugin tabs at the moment so it is really nice to get that fixed.", "markup": "markdown", "html": "<p>Thanks for taking the time to fix this. </p>\n<p>It is mostly annoyance  when testing plugin tabs at the moment so it is really nice to get that fixed.</p>", "type": "rendered"}, "created_on": "2017-08-19T14:25:03.369426+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-19T14:25:03.409036+00:00", "type": "pullrequest_comment", "id": 43150639}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150613.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150613"}}, "parent": {"id": 43150585, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150585.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150585"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "I think I found a fix.\n\nI can call `self.grabMouse()` to insist that the widget receive all future mouse events, until mouse release, then I can call `self.releaseMouse()` That way we're guaranteed to get the mouseRelease event and we don't need to handle that edge case of losing focus before getting the mouseRelease event. Then I can just not handle leaveEvent and you won't see the premature drag cancelling.", "markup": "markdown", "html": "<p>I think I found a fix.</p>\n<p>I can call <code>self.grabMouse()</code> to insist that the widget receive all future mouse events, until mouse release, then I can call <code>self.releaseMouse()</code> That way we're guaranteed to get the mouseRelease event and we don't need to handle that edge case of losing focus before getting the mouseRelease event. Then I can just not handle leaveEvent and you won't see the premature drag cancelling.</p>", "type": "rendered"}, "created_on": "2017-08-19T14:21:38.514425+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T14:21:38.516816+00:00", "type": "pullrequest_comment", "id": 43150613}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150585.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150585"}}, "parent": {"id": 43150459, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150459.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150459"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Yes, exactly - it's just that in windows and linux, the leave events are supressed whilst a drag is in progress. Not supressing them makes mose sense honestly, but I needed some way to detect loss of focus (focusOutEvent doesn't seem to be called).\n\nIf I simply don't handle the leaveEvents - just delete the leaveEvent method completely - everything is fine for me in PyQt4. However, in PyQt5, I have one remaining problem - if you click and drag outside the application, and then press another mouse button (say you right click whilst not releasing the left mouse button), then the origin tabBar doesn't get a mouseRelease event (even if you subsequently release the mouse) - it only gets a leaveEvent. So handling that leaveEvent was important for ensuring the drag was cancelled in that case.\n\nHowever, since if you do this, you are clicking on the floating tab, perhaps i can make the floating tab detect the extra mousePressEvent and use that to cancel the drag (I could keep the drag going but that would be too much work - should just cancel it if the user is doing funky things with their mouse).\n\nHonestly this looks like a bug in Qt - really it should make up its mind - either keep delivering mouse events to the original widget, or if you're going to start delivering them somewhere else, please send the original widget a focusOutEvent so that it knows it's never going to see the mouseRelease event. But I think I can deal with it fine.\n", "markup": "markdown", "html": "<p>Yes, exactly - it's just that in windows and linux, the leave events are supressed whilst a drag is in progress. Not supressing them makes mose sense honestly, but I needed some way to detect loss of focus (focusOutEvent doesn't seem to be called).</p>\n<p>If I simply don't handle the leaveEvents - just delete the leaveEvent method completely - everything is fine for me in PyQt4. However, in PyQt5, I have one remaining problem - if you click and drag outside the application, and then press another mouse button (say you right click whilst not releasing the left mouse button), then the origin tabBar doesn't get a mouseRelease event (even if you subsequently release the mouse) - it only gets a leaveEvent. So handling that leaveEvent was important for ensuring the drag was cancelled in that case.</p>\n<p>However, since if you do this, you are clicking on the floating tab, perhaps i can make the floating tab detect the extra mousePressEvent and use that to cancel the drag (I could keep the drag going but that would be too much work - should just cancel it if the user is doing funky things with their mouse).</p>\n<p>Honestly this looks like a bug in Qt - really it should make up its mind - either keep delivering mouse events to the original widget, or if you're going to start delivering them somewhere else, please send the original widget a focusOutEvent so that it knows it's never going to see the mouseRelease event. But I think I can deal with it fine.</p>", "type": "rendered"}, "created_on": "2017-08-19T14:18:41.454335+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T14:18:41.456878+00:00", "type": "pullrequest_comment", "id": 43150585}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150459.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150459"}}, "parent": {"id": 43150443, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150443.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150443"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Tabs can be dragged in the tabbar without problems even in the buggy state. \n\nSo maybe a leave event is triggered, when the current parent widget is left? (this is just a guess but would make sense to me) ", "markup": "markdown", "html": "<p>Tabs can be dragged in the tabbar without problems even in the buggy state. </p>\n<p>So maybe a leave event is triggered, when the current parent widget is left? (this is just a guess but would make sense to me) </p>", "type": "rendered"}, "created_on": "2017-08-19T14:00:05.686678+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-19T14:00:30.940265+00:00", "type": "pullrequest_comment", "id": 43150459}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150443.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150443"}}, "parent": {"id": 43150428, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150428.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150428"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Excellent. Thanks for investigating. This makes sense.\n\nThe code is getting leaveEvents when I didn't expect them. I thought leaveEvents would not occur after a mousePressEvent but before a mouseReleaseEvent unless the application lost focus. Handling the leaveEvent is solely so that the drag gets cancelled if the application loses focus. When the application does not have focus, of course there are no leaveEvents, so that's why you're not seeing any problems when it has no focus. When it does have focus, it looks like Qt goes ahead and passes leaveEvents to the application after a mouse press but before a mouse release, which it does not do on Windows or linux. Perhaps I can use focusOutEvent or whatever its called instead to detect the application losing focus.\n\nThe problem being that if the application loses focus, it never gets the mouse release event, and so we need some way to still cancel the drag in this case otherwise you have a tab hovering in limbo forever.", "markup": "markdown", "html": "<p>Excellent. Thanks for investigating. This makes sense.</p>\n<p>The code is getting leaveEvents when I didn't expect them. I thought leaveEvents would not occur after a mousePressEvent but before a mouseReleaseEvent unless the application lost focus. Handling the leaveEvent is solely so that the drag gets cancelled if the application loses focus. When the application does not have focus, of course there are no leaveEvents, so that's why you're not seeing any problems when it has no focus. When it does have focus, it looks like Qt goes ahead and passes leaveEvents to the application after a mouse press but before a mouse release, which it does not do on Windows or linux. Perhaps I can use focusOutEvent or whatever its called instead to detect the application losing focus.</p>\n<p>The problem being that if the application loses focus, it never gets the mouse release event, and so we need some way to still cancel the drag in this case otherwise you have a tab hovering in limbo forever.</p>", "type": "rendered"}, "created_on": "2017-08-19T13:57:15.170043+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T13:58:38.439873+00:00", "type": "pullrequest_comment", "id": 43150443}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150428.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150428"}}, "parent": {"id": 43150365, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150365.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150365"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Ok I found out a bit more. \nIt seems to be linked to the window having focus/being active. For some reason windows are not active on first start of a python app on mac. If the window is not active everything works just fine. If the window becomes active (by clicking in it somewhere) tabs become buggy. That also applies to the demo code. So it's not just a BLACS problem anymore.", "markup": "markdown", "html": "<p>Ok I found out a bit more. \nIt seems to be linked to the window having focus/being active. For some reason windows are not active on first start of a python app on mac. If the window is not active everything works just fine. If the window becomes active (by clicking in it somewhere) tabs become buggy. That also applies to the demo code. So it's not just a BLACS problem anymore.</p>", "type": "rendered"}, "created_on": "2017-08-19T13:54:12.261009+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-19T13:54:12.312668+00:00", "type": "pullrequest_comment", "id": 43150428}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150366.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150366"}}, "parent": {"id": 43150347, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150347.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150347"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Thanks!", "markup": "markdown", "html": "<p>Thanks!</p>", "type": "rendered"}, "created_on": "2017-08-19T13:44:45.585095+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T13:44:45.587331+00:00", "type": "pullrequest_comment", "id": 43150366}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150365.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150365"}}, "parent": {"id": 43150192, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150192.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150192"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Actually, the fact that replacing\n\n```\n#!python\n\nif not self.drag_in_progress:\n            return\n```\nwith `return` makes that function not do anything means that `self.drag_in_progress` is `True`. Which is all good - it's just that I didn't expect for the code to get leaveEvents except in situations where the drag was actually supposed to be cancelled. Perhaps there are extra leaveEvents on macos.", "markup": "markdown", "html": "<p>Actually, the fact that replacing</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">drag_in_progress</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span>\n</pre></div>\n\n\n<p>with <code>return</code> makes that function not do anything means that <code>self.drag_in_progress</code> is <code>True</code>. Which is all good - it's just that I didn't expect for the code to get leaveEvents except in situations where the drag was actually supposed to be cancelled. Perhaps there are extra leaveEvents on macos.</p>", "type": "rendered"}, "created_on": "2017-08-19T13:44:35.270868+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T13:44:35.273801+00:00", "type": "pullrequest_comment", "id": 43150365}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150347.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150347"}}, "parent": {"id": 43150308, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150308.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150308"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "[Output both](https://pastebin.com/tpRSEBkX)", "markup": "markdown", "html": "<p><a data-is-external-link=\"true\" href=\"https://pastebin.com/tpRSEBkX\" rel=\"nofollow\">Output both</a></p>", "type": "rendered"}, "created_on": "2017-08-19T13:41:57.209855+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-19T13:41:57.255847+00:00", "type": "pullrequest_comment", "id": 43150347}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150308.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150308"}}, "parent": {"id": 43150285, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150285.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150285"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Yes, please! The way the successful drag ends may be leaving things in an incorrect state.", "markup": "markdown", "html": "<p>Yes, please! The way the successful drag ends may be leaving things in an incorrect state.</p>", "type": "rendered"}, "created_on": "2017-08-19T13:36:44.904513+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T13:36:44.906794+00:00", "type": "pullrequest_comment", "id": 43150308}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150285.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150285"}}, "parent": {"id": 43150268, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150268.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150268"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "No it's just a buggy drag. Do you want a successful one too?", "markup": "markdown", "html": "<p>No it's just a buggy drag. Do you want a successful one too?</p>", "type": "rendered"}, "created_on": "2017-08-19T13:34:06.269107+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-19T13:34:06.316458+00:00", "type": "pullrequest_comment", "id": 43150285}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150268.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150268"}}, "parent": {"id": 43150192, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150192.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150192"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Well, at least on linux, if you drag a tab outside the whole window, and then release it, you get both a mouseRelease event and a leaveEvent. So the idea was that whichever happens first sets  `self.drag_in_progress = False` so that the other one doesn't run as well. \n\nBut I'll look at the debug info. So does the debug output show what happens when you do a successful drag, and then one that gets cut short by this bug?", "markup": "markdown", "html": "<p>Well, at least on linux, if you drag a tab outside the whole window, and then release it, you get both a mouseRelease event and a leaveEvent. So the idea was that whichever happens first sets  <code>self.drag_in_progress = False</code> so that the other one doesn't run as well. </p>\n<p>But I'll look at the debug info. So does the debug output show what happens when you do a successful drag, and then one that gets cut short by this bug?</p>", "type": "rendered"}, "created_on": "2017-08-19T13:32:01.678533+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T13:32:01.681001+00:00", "type": "pullrequest_comment", "id": 43150268}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150192.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150192"}}, "parent": {"id": 43150144, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150144.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150144"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Sure but the output with debug active is really long after just one drag. [Output](https://pastebin.com/iTLsm2TN)\n\nUpdate:\nI replaced the followning code in ```leaveEvent``` with just ```return``` and everything is working fine\n```\n#!python\n\n        if not self.drag_in_progress:\n            return\n```\n\nSo somewhere ```self.drag_in_progress``` is set to False. I'll investigate.", "markup": "markdown", "html": "<p>Sure but the output with debug active is really long after just one drag. <a data-is-external-link=\"true\" href=\"https://pastebin.com/iTLsm2TN\" rel=\"nofollow\">Output</a></p>\n<p>Update:\nI replaced the followning code in <code>leaveEvent</code> with just <code>return</code> and everything is working fine</p>\n<div class=\"codehilite language-python\"><pre><span></span>        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">drag_in_progress</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span>\n</pre></div>\n\n\n<p>So somewhere <code>self.drag_in_progress</code> is set to False. I'll investigate.</p>", "type": "rendered"}, "created_on": "2017-08-19T13:20:05.656975+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-19T13:27:54.814075+00:00", "type": "pullrequest_comment", "id": 43150192}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150144.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150144"}}, "parent": {"id": 43150008, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150008.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150008"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "I haven't noticed this under Windows - I deployed this update to a lab at NIST using Windows because they wanted to use Qt5. I was definitely able to drag tabs more than once!\n\n\n Could you enable debugging in dragdroptab.py and post what it prints to the terminal?\n\nDragging is cancelled on a leaveEvent and a mouseReleaseEvent, so one guess is that spurious leaveEvents are being generated. The debug output will print what event triggered the cancelling.", "markup": "markdown", "html": "<p>I haven't noticed this under Windows - I deployed this update to a lab at NIST using Windows because they wanted to use Qt5. I was definitely able to drag tabs more than once!</p>\n<p>Could you enable debugging in dragdroptab.py and post what it prints to the terminal?</p>\n<p>Dragging is cancelled on a leaveEvent and a mouseReleaseEvent, so one guess is that spurious leaveEvents are being generated. The debug output will print what event triggered the cancelling.</p>", "type": "rendered"}, "created_on": "2017-08-19T13:12:38.180199+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-19T13:12:38.182651+00:00", "type": "pullrequest_comment", "id": 43150144}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/43150008.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-43150008"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Ok so I noticed something strange under mac with both PyQt4 and PyQt5 in BLACS with the new Tabs. I haven't checked on windows yet.\nIf you drag the tabs once everything works just fine. But if you then drag any tab after that dragging will stop after less then a second.\n![bug.gif](data/bitbucket.org/repo/xg9BdE/images/1467006556-bug.gif)\n\nThis only happens in BLACS and only 90% of the time and I have no clue on why/when it is happening.\n", "markup": "markdown", "html": "<p>Ok so I noticed something strange under mac with both PyQt4 and PyQt5 in BLACS with the new Tabs. I haven't checked on windows yet.\nIf you drag the tabs once everything works just fine. But if you then drag any tab after that dragging will stop after less then a second.\n<img alt=\"bug.gif\" src=\"data/bitbucket.org/repo/xg9BdE/images/1467006556-bug.gif\" /></p>\n<p>This only happens in BLACS and only 90% of the time and I have no clue on why/when it is happening.</p>", "type": "rendered"}, "created_on": "2017-08-19T12:48:04.347025+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-19T13:05:57.781709+00:00", "type": "pullrequest_comment", "id": 43150008}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42955624.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42955624"}}, "parent": {"id": 42953906, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42953906.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42953906"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Just checked my change log it's exactly 7 days ago that I added it to our labs main machine. \nNo problems until now. \n\nI also think that since tabs don't get dragged that often it will take a long time to find bugs (if there are any). \nSo we might as well merge now.", "markup": "markdown", "html": "<p>Just checked my change log it's exactly 7 days ago that I added it to our labs main machine. \nNo problems until now. </p>\n<p>I also think that since tabs don't get dragged that often it will take a long time to find bugs (if there are any). \nSo we might as well merge now.</p>", "type": "rendered"}, "created_on": "2017-08-16T19:39:26.297041+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-16T19:39:40.347876+00:00", "type": "pullrequest_comment", "id": 42955624}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42953906.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42953906"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "@PhyNerd has said that they've had this live in their lab for about a week (in a PyQt4 environment, pre-qtutils v2, but now they are running on qtutils v2 - still with PyQt4, so it's live there too).\n\n@pstarkey or @shjohnst are you happy for it to be merged on that basis?\n\nOnce it's merged then the main repo's default branches will have no known problems with PyQt5, which would be a nice place to be.", "markup": "markdown", "html": "<p>@PhyNerd has said that they've had this live in their lab for about a week (in a PyQt4 environment, pre-qtutils v2, but now they are running on qtutils v2 - still with PyQt4, so it's live there too).</p>\n<p>@pstarkey or @shjohnst are you happy for it to be merged on that basis?</p>\n<p>Once it's merged then the main repo's default branches will have no known problems with PyQt5, which would be a nice place to be.</p>", "type": "rendered"}, "created_on": "2017-08-16T19:14:09.310981+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-16T19:14:09.329031+00:00", "type": "pullrequest_comment", "id": 42953906}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42953470.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42953470"}}, "parent": {"id": 42886531, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42886531.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42886531"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Resolved!", "markup": "markdown", "html": "<p>Resolved!</p>", "type": "rendered"}, "created_on": "2017-08-16T19:08:15.348716+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-16T19:08:15.352114+00:00", "type": "pullrequest_comment", "id": 42953470}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs\r\n    within a tabbar~~.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    The lost functionality ~~can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet~~ has been restored.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "8f563b6f2aed", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/8f563b6f2aed.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/8f563b6f2aed"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "e08fbf61efff", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/e08fbf61efff"}, "html": {"href": "#!/cbillington/labscript_utils/commits/e08fbf61efff"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-16T19:03:16.838627+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42886531.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42886531"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "This pull request has merge conflicts due to the qtutils 2 merge.", "markup": "markdown", "html": "<p>This pull request has merge conflicts due to the qtutils 2 merge.</p>", "type": "rendered"}, "created_on": "2017-08-16T06:39:38.013983+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-16T06:39:38.053818+00:00", "type": "pullrequest_comment", "id": 42886531}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42607203.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42607203"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Approving my own pull request here indicates that I think this is ready to be in the next round of things pulled to lab working copies for testing.\n\nEdit: actually, approving my own pull request doesn't show up in bitbucket's list of pull requests - only reviewers show up. And I can't be a reviewer for my own pull request.\n\nI'll just like, email a list of pull requests to Shaun and Phil instead, like a caveman.", "markup": "markdown", "html": "<p>Approving my own pull request here indicates that I think this is ready to be in the next round of things pulled to lab working copies for testing.</p>\n<p>Edit: actually, approving my own pull request doesn't show up in bitbucket's list of pull requests - only reviewers show up. And I can't be a reviewer for my own pull request.</p>\n<p>I'll just like, email a list of pull requests to Shaun and Phil instead, like a caveman.</p>", "type": "rendered"}, "created_on": "2017-08-10T19:22:37.194933+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-10T19:25:32.889353+00:00", "type": "pullrequest_comment", "id": 42607203}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs\r\n    within a tabbar~~.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    The lost functionality ~~can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet~~ has been restored.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "102dc12cc39c", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/102dc12cc39c.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/102dc12cc39c"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a61725f48ecf", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/a61725f48ecf"}, "html": {"href": "#!/cbillington/labscript_utils/commits/a61725f48ecf"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-10T03:33:50.228020+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"approval": {"date": "2017-08-09T21:37:14.218682+00:00", "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42521741.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42521741"}}, "parent": {"id": 42521048, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42521048.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42521048"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Great! I'll test a bit and then deploy in the lab again tomorrow.\n\nWell I aliased the progress bars already so why not add QStyleOptionTab as well? I'm gone do that in a minute.\n\nOhhh you haven't seen macOS + PyQt4 + BLACS yet.\n![blacs.png](data/bitbucket.org/repo/xg9BdE/images/3729578202-blacs.png)\nI always though that PyQt5 looked much cleaner but couldn't pin down what it was until I found that blog post. I don't mind the design bugs as long as functionality is not affected.\n\n", "markup": "markdown", "html": "<p>Great! I'll test a bit and then deploy in the lab again tomorrow.</p>\n<p>Well I aliased the progress bars already so why not add QStyleOptionTab as well? I'm gone do that in a minute.</p>\n<p>Ohhh you haven't seen macOS + PyQt4 + BLACS yet.\n<img alt=\"blacs.png\" src=\"data/bitbucket.org/repo/xg9BdE/images/3729578202-blacs.png\" />\nI always though that PyQt5 looked much cleaner but couldn't pin down what it was until I found that blog post. I don't mind the design bugs as long as functionality is not affected.</p>", "type": "rendered"}, "created_on": "2017-08-09T21:27:15.957473+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-09T21:27:16.029489+00:00", "type": "pullrequest_comment", "id": 42521741}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs\r\n    within a tabbar~~.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    The lost functionality ~~can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet~~ has been restored.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "102dc12cc39c", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/102dc12cc39c.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/102dc12cc39c"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "71061d58f131", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/71061d58f131"}, "html": {"href": "#!/cbillington/labscript_utils/commits/71061d58f131"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-09T21:17:01.099535+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42521048.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42521048"}}, "parent": {"id": 42517201, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42517201.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42517201"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Fixed. Wasn't really a bug, it was a backward compatibility thing of their own. They had this class called `QStyleOptionTab` which you use if you want to reimplement the painting of widgets themselves. Qt itself on two occasions updated the way the tabs painted by default, but so as to not break other people's custom painting code, they named the new objects `QStyleOptionTabV2` and `QStyleOptionTabV3` and used them internally - letting existing painting code continue to use the older objects that worked in the old way. So to reproduce the default behaviour I just needed to use `QStyleOptionTabV3` in PyQt4. In PyQt5 they removed these backward compatibility objects and there is only one `QStyleOptionTab` referring to the latest functionality.\n\nIf the Qt wrapper were really pedantic, it could alias the name `QStyleOptionTab` to refer to  `QStyleOptionTabV3` in PyQt4, but unless there is a complete list of renames somewhere I suspect this isn't worth it. I just put a flag in there.\n\nGood to hear macos icon size is fixed in Qt5 - I saw your screenshot of runmanager was looking pretty miserable and wasn't looking forward to fixing it!", "markup": "markdown", "html": "<p>Fixed. Wasn't really a bug, it was a backward compatibility thing of their own. They had this class called <code>QStyleOptionTab</code> which you use if you want to reimplement the painting of widgets themselves. Qt itself on two occasions updated the way the tabs painted by default, but so as to not break other people's custom painting code, they named the new objects <code>QStyleOptionTabV2</code> and <code>QStyleOptionTabV3</code> and used them internally - letting existing painting code continue to use the older objects that worked in the old way. So to reproduce the default behaviour I just needed to use <code>QStyleOptionTabV3</code> in PyQt4. In PyQt5 they removed these backward compatibility objects and there is only one <code>QStyleOptionTab</code> referring to the latest functionality.</p>\n<p>If the Qt wrapper were really pedantic, it could alias the name <code>QStyleOptionTab</code> to refer to  <code>QStyleOptionTabV3</code> in PyQt4, but unless there is a complete list of renames somewhere I suspect this isn't worth it. I just put a flag in there.</p>\n<p>Good to hear macos icon size is fixed in Qt5 - I saw your screenshot of runmanager was looking pretty miserable and wasn't looking forward to fixing it!</p>", "type": "rendered"}, "created_on": "2017-08-09T21:16:11.579218+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-09T21:16:11.581881+00:00", "type": "pullrequest_comment", "id": 42521048}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42517201.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42517201"}}, "parent": {"id": 42510238, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42510238.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42510238"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "It looks like this is a bug in Qt4, and it is not platform specific. I just didn't notice it because I was only testing the icons in BLACS which I was running in PyQt5.\n\nSo everything is great in Qt5. But I'll add a workaround for Qt4.", "markup": "markdown", "html": "<p>It looks like this is a bug in Qt4, and it is not platform specific. I just didn't notice it because I was only testing the icons in BLACS which I was running in PyQt5.</p>\n<p>So everything is great in Qt5. But I'll add a workaround for Qt4.</p>", "type": "rendered"}, "created_on": "2017-08-09T20:18:33.621781+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-09T20:18:33.624366+00:00", "type": "pullrequest_comment", "id": 42517201}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42510238.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42510238"}}, "parent": {"id": 42509056, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42509056.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42509056"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Our lab computer is running on windows so you shouldn't have problems to reproduce this.\n\nJust tested icons on mac and same problem. \nInterestingly icons are way too huge on mac in tabs this is a [qt problem](http://blog.qt.io/blog/2013/04/25/retina-display-support-for-mac-os-ios-and-x11/) though and fixed in qt5 so one more reason to switch. And the bug of no icons is not present under PyQt5 on mac either.", "markup": "markdown", "html": "<p>Our lab computer is running on windows so you shouldn't have problems to reproduce this.</p>\n<p>Just tested icons on mac and same problem. \nInterestingly icons are way too huge on mac in tabs this is a <a data-is-external-link=\"true\" href=\"http://blog.qt.io/blog/2013/04/25/retina-display-support-for-mac-os-ios-and-x11/\" rel=\"nofollow\">qt problem</a> though and fixed in qt5 so one more reason to switch. And the bug of no icons is not present under PyQt5 on mac either.</p>", "type": "rendered"}, "created_on": "2017-08-09T18:35:54.519390+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-09T18:55:21.926932+00:00", "type": "pullrequest_comment", "id": 42510238}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42509056.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42509056"}}, "parent": {"id": 42471471, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42471471.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42471471"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Thanks for testing!\n\nThat's pretty annoying - it looks like it's about the painting - that the icons are still set correctly but just not being painted. I am simply calling the exact same sequence of:\n\n\n```\n#!python\n\nself.initStyleOption(option, index)\npainter.drawControl(QStyle.CE_TabBarTab, option)\n```\n\nin my paint method that the qtabbar itself does in its paint method - this is supposed to draw the whole tab! I can easily add in 'and draw the icon too please', but I didn't expect to have to (and I don't have to on linux).\n\nI'll try to reproduce on Windows and see what I can do!", "markup": "markdown", "html": "<p>Thanks for testing!</p>\n<p>That's pretty annoying - it looks like it's about the painting - that the icons are still set correctly but just not being painted. I am simply calling the exact same sequence of:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">initStyleOption</span><span class=\"p\">(</span><span class=\"n\">option</span><span class=\"p\">,</span> <span class=\"n\">index</span><span class=\"p\">)</span>\n<span class=\"n\">painter</span><span class=\"o\">.</span><span class=\"n\">drawControl</span><span class=\"p\">(</span><span class=\"n\">QStyle</span><span class=\"o\">.</span><span class=\"n\">CE_TabBarTab</span><span class=\"p\">,</span> <span class=\"n\">option</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>in my paint method that the qtabbar itself does in its paint method - this is supposed to draw the whole tab! I can easily add in 'and draw the icon too please', but I didn't expect to have to (and I don't have to on linux).</p>\n<p>I'll try to reproduce on Windows and see what I can do!</p>", "type": "rendered"}, "created_on": "2017-08-09T18:20:03.798135+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-09T18:20:03.801322+00:00", "type": "pullrequest_comment", "id": 42509056}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42471471.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42471471"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Ok so guys in the lab noticed that the tabs don't display icons anymore when not being dragged.\nI'll removed the new tabs from our lab again until this is fixed, as it's important for quickly finding error states.\n\nThis screenshot shows the tab being dragged left and not dragged right.\n![tabbug.png](data/bitbucket.org/repo/xg9BdE/images/2962113669-tabbug.png)", "markup": "markdown", "html": "<p>Ok so guys in the lab noticed that the tabs don't display icons anymore when not being dragged.\nI'll removed the new tabs from our lab again until this is fixed, as it's important for quickly finding error states.</p>\n<p>This screenshot shows the tab being dragged left and not dragged right.\n<img alt=\"tabbug.png\" src=\"data/bitbucket.org/repo/xg9BdE/images/2962113669-tabbug.png\" /></p>", "type": "rendered"}, "created_on": "2017-08-09T12:02:17.163300+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-09T12:04:34.853374+00:00", "type": "pullrequest_comment", "id": 42471471}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs\r\n    within a tabbar~~.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    The lost functionality ~~can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet~~ has been restored.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "102dc12cc39c", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/102dc12cc39c.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/102dc12cc39c"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "fe20c761a6f3", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/fe20c761a6f3"}, "html": {"href": "#!/cbillington/labscript_utils/commits/fe20c761a6f3"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-07T18:55:44.550400+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, ~~animation when moving tabs~~\r\n    within a tabbar.\r\n\r\n    Gained: Doesn't crash or lose tabs, tabs are always in a tabbar (just possibly one floating in free    \r\n    space) reducing the need for workarounds when a tab wants to manipulate its state (title, icon\r\n    etc) while a drag is in progress.\r\n\r\n    ~~The lost functionality can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet.~~\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "102dc12cc39c", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/102dc12cc39c.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/102dc12cc39c"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "fe20c761a6f3", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/fe20c761a6f3"}, "html": {"href": "#!/cbillington/labscript_utils/commits/fe20c761a6f3"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-07T18:55:00.338973+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, animation when moving tabs\r\n    within a tabbar.\r\n\r\n    Gained: Doesn't crash or lose tabs.\r\n\r\n    The lost functionality can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "e5becb62eedf", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/e5becb62eedf.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/e5becb62eedf"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "fe20c761a6f3", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/fe20c761a6f3"}, "html": {"href": "#!/cbillington/labscript_utils/commits/fe20c761a6f3"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-07T17:03:02.551428+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42260681.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42260681"}}, "parent": {"id": 42260621, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42260621.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42260621"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "I'll do some testing later too on windows and mac as always.\n\nUpdate: Everything seems to work fine and I was not able to create any unexpected behavior on my test machines. Will add it to our lab machine now for longtime testing.", "markup": "markdown", "html": "<p>I'll do some testing later too on windows and mac as always.</p>\n<p>Update: Everything seems to work fine and I was not able to create any unexpected behavior on my test machines. Will add it to our lab machine now for longtime testing.</p>", "type": "rendered"}, "created_on": "2017-08-07T06:13:27.016750+00:00", "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}, "updated_on": "2017-08-07T15:34:22.884788+00:00", "type": "pullrequest_comment", "id": 42260681}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42260742.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42260742"}}, "parent": {"id": 42260621, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42260621.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42260621"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Absolutely! Sounds great.", "markup": "markdown", "html": "<p>Absolutely! Sounds great.</p>", "type": "rendered"}, "created_on": "2017-08-07T06:14:52.567193+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-07T06:14:52.570477+00:00", "type": "pullrequest_comment", "id": 42260742}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42260621.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42260621"}}, "parent": {"id": 42260090, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42260090.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42260090"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "Cool. We'll try and test in our lab soon. We should probably hold off merging until it's been soak tested a bit if that's OK?", "markup": "markdown", "html": "<p>Cool. We'll try and test in our lab soon. We should probably hold off merging until it's been soak tested a bit if that's OK?</p>", "type": "rendered"}, "created_on": "2017-08-07T06:11:55.373499+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2017-08-07T06:11:55.378034+00:00", "type": "pullrequest_comment", "id": 42260621}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42260090.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42260090"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "OK. Pending bugfixes I'm done with this now. It was a lot of work, and I now understand why I've never seen a Qt app (other than BLACS) with drag-drop tabs before. It's practically a quarter of the length of the actual Qt code for the tab bar itself, and given the normal python to C++ verbosity ratio, that means you're reimplementing a decent chunk of the behaviour of the whole thing just to get the tabs to move.", "markup": "markdown", "html": "<p>OK. Pending bugfixes I'm done with this now. It was a lot of work, and I now understand why I've never seen a Qt app (other than BLACS) with drag-drop tabs before. It's practically a quarter of the length of the actual Qt code for the tab bar itself, and given the normal python to C++ verbosity ratio, that means you're reimplementing a decent chunk of the behaviour of the whole thing just to get the tabs to move.</p>", "type": "rendered"}, "created_on": "2017-08-07T05:57:23.026923+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-07T05:57:23.028914+00:00", "type": "pullrequest_comment", "id": 42260090}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, animation when moving tabs\r\n    within a tabbar.\r\n\r\n    Gained: Doesn't crash or lose tabs.\r\n\r\n    The lost functionality can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "e5becb62eedf", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/e5becb62eedf.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/e5becb62eedf"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "27a934b9cff8", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/27a934b9cff8"}, "html": {"href": "#!/cbillington/labscript_utils/commits/27a934b9cff8"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-07T05:29:13.974495+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, animation when moving tabs\r\n    within a tabbar.\r\n\r\n    Gained: Doesn't crash or lose tabs.\r\n\r\n    The lost functionality can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "e5becb62eedf", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/e5becb62eedf.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/e5becb62eedf"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "e1ddc3b74ac0", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/e1ddc3b74ac0"}, "html": {"href": "#!/cbillington/labscript_utils/commits/e1ddc3b74ac0"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-07T04:51:22.022719+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"update": {"description": "* Reimplemented dragdroptab.\r\n\r\n    Lost: ~~mouse icon changing during drag~~, animation when moving tabs\r\n    within a tabbar.\r\n\r\n    Gained: Doesn't crash or lose tabs.\r\n\r\n    The lost functionality can plausible be re-added without compromising\r\n    on the lack of crashing. I just haven't looked into it much yet.\r\n\r\nThis pull request may fix issue #13 (I can't test, I don't have a mac, but I expect it will since I'm now storing which tab is being dragged based on the position of the mouse click rather than which tab was active at the time of the click), [likely fixes BLACS issue #17](#!/labscript_suite/blacs/issues/17/tab-becomes-unselected-when-moving), and does fix the issue I've seen in testing pull request #20.\r\n\r\nThis reimplementation is based on abandoning Qt's drag and drop functionality, and implementing it instead with just mouseEvents. It turns out to be much easier, since there was unending subtleties with Qt's drag events. The main one being that if during an event you called functions that modified the GUI, this could actually cause *new events to be processed, including the very event handler you were already in*. So you would have to write all the code to be re-entrant even though it's single threaded. I attempted to serialise the events by catching them and putting them in a queue to process in order rather than re-entrantly but that caused Qt to fire seemingly nonsensical events like two leave events in a row for the same widget and other nonsense that entirely defeats the purpose of the drag events if you can't trust anything about them.\r\n\r\nThis change is compatible with the Qt5 pull request (it just has a try/except for the imports for now so that it works regardless, can be changed to just use qtutils.qt after that branch is merged), though the merge might have to be done locally to discard the other file as otherwise it looks like a merge conflict.", "title": "Dragdroptab", "destination": {"commit": {"hash": "e5becb62eedf", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/e5becb62eedf.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/e5becb62eedf"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "aca6c6007ba4", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/aca6c6007ba4"}, "html": {"href": "#!/cbillington/labscript_utils/commits/aca6c6007ba4"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "dragdroptab"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-08-07T01:04:36.123425+00:00"}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42252795.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42252795"}}, "parent": {"id": 42251608, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/comments/42251608.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21/_/diff#comment-42251608"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}, "content": {"raw": "I found a problem that caused the tab to not animate back (the underlying tab had the right position but the animation had not been prodded to run), so that might be fixed. And I'm not sure about the flickering, but I just added a buffer zone - so that you have to drag ten pixels out for the tab to pop out, and then you would have to go ten pixels back again before it popped back in, rather than it just being neighbouring pixels counting as in or out.", "markup": "markdown", "html": "<p>I found a problem that caused the tab to not animate back (the underlying tab had the right position but the animation had not been prodded to run), so that might be fixed. And I'm not sure about the flickering, but I just added a buffer zone - so that you have to drag ten pixels out for the tab to pop out, and then you would have to go ten pixels back again before it popped back in, rather than it just being neighbouring pixels counting as in or out.</p>", "type": "rendered"}, "created_on": "2017-08-07T00:01:51.672976+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-08-07T00:01:51.675633+00:00", "type": "pullrequest_comment", "id": 42252795}, "pull_request": {"type": "pullrequest", "id": 21, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/21.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/21"}}, "title": "Dragdroptab"}}], "next": "data/repositories/labscript_suite/labscript_utils/pullrequests/21/activity_ctx=KRt9zId.json"}