{"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/26/comments/56360991.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/26/_/diff#comment-56360991"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 26, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/26.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/26"}}, "title": "Feature PyCaptureCamServer"}, "content": {"raw": "Hi Dan,\n\nThanks for creating this server (and thanks David for referring me to it). I'm excited to have an all-python data acquisition system! I am a grad student in the Thompson lab at JILA. \n\nI grabbed the code and have been testing it with a Point Grey Chameleon3 CM3-U3-13S2M camera. I have noticed a few things: \n\n- On line 249,  i=idx should probably be i=idx+1 so that if there is an error retrieving the buffer, it displays the correct image number\n\n- For a shot with one image, if it returns an empty image, it can take 40s to timeout the save\n```\nZ:\\Experiments\\example_experiment\\test_ptgrey\\2018\\02\\08\\20180208T130955_test_ptgrey_0.h5\nmax_wait = 0.1 s\nConfigured for 1 images.\nCapture started.\ndone\nTimeout in image acquisition. Returning empty images.\nSaving 0 images.\nfluoro camera shots saving time: 40.7279999256 s\n```\n\n- If I have a sequence with two pictures, there is a timeout error when retrieving the buffer for the 2nd image. I can increase the wait time to be arbitrarily long (say 1s) and I still see this error. The exposure time is 100us (according to documentation, min should be 46us) and the minimum recovery time is 1ms. I teed into the trigger line and the triggers seem to be reasonable. They are 100us square wave pulses, spaced by the time between the pictures. I tried using 3.3 V and 5 V pulses, but it didn't make a difference. I also tried changing the number of images. With more than 2 images, I got exactly the same response. With one image, if the camera server has just been initialized, it seems to be ok. If I run another shot with the same camera server, the image acquisition times out. The server messages for a shot with two images are:\n\n\n```\nZ:\\Experiments\\example_experiment\\test_ptgrey\\2018\\02\\14\\20180214T162806_test_ptgrey_0.h5\nmax_wait = 0.01 s\nConfigured for 2 images.\nCapture started.\nn_Rows = 964, n_Cols = 1288\nretrieved 1th image of 2 images\nError retrieving buffer: 'Timeout error.' at 2th image.\ngot 1 images.\nCapture stopped.\ndone\nSaving 1 images.\natoms camera shots saving time: 0.00500011444092 s\n```\n\n\nI am not very familiar with bitbucket, sorry for the formatting!\n\nThanks,\nJulia", "markup": "markdown", "html": "<p>Hi Dan,</p>\n<p>Thanks for creating this server (and thanks David for referring me to it). I'm excited to have an all-python data acquisition system! I am a grad student in the Thompson lab at JILA. </p>\n<p>I grabbed the code and have been testing it with a Point Grey Chameleon3 CM3-U3-13S2M camera. I have noticed a few things: </p>\n<ul>\n<li>\n<p>On line 249,  i=idx should probably be i=idx+1 so that if there is an error retrieving the buffer, it displays the correct image number</p>\n</li>\n<li>\n<p>For a shot with one image, if it returns an empty image, it can take 40s to timeout the save</p>\n</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span>Z:\\Experiments\\example_experiment\\test_ptgrey\\2018\\02\\08\\20180208T130955_test_ptgrey_0.h5\nmax_wait = 0.1 s\nConfigured for 1 images.\nCapture started.\ndone\nTimeout in image acquisition. Returning empty images.\nSaving 0 images.\nfluoro camera shots saving time: 40.7279999256 s\n</pre></div>\n\n\n<ul>\n<li>If I have a sequence with two pictures, there is a timeout error when retrieving the buffer for the 2nd image. I can increase the wait time to be arbitrarily long (say 1s) and I still see this error. The exposure time is 100us (according to documentation, min should be 46us) and the minimum recovery time is 1ms. I teed into the trigger line and the triggers seem to be reasonable. They are 100us square wave pulses, spaced by the time between the pictures. I tried using 3.3 V and 5 V pulses, but it didn't make a difference. I also tried changing the number of images. With more than 2 images, I got exactly the same response. With one image, if the camera server has just been initialized, it seems to be ok. If I run another shot with the same camera server, the image acquisition times out. The server messages for a shot with two images are:</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span>Z:\\Experiments\\example_experiment\\test_ptgrey\\2018\\02\\14\\20180214T162806_test_ptgrey_0.h5\nmax_wait = 0.01 s\nConfigured for 2 images.\nCapture started.\nn_Rows = 964, n_Cols = 1288\nretrieved 1th image of 2 images\nError retrieving buffer: &#39;Timeout error.&#39; at 2th image.\ngot 1 images.\nCapture stopped.\ndone\nSaving 1 images.\natoms camera shots saving time: 0.00500011444092 s\n</pre></div>\n\n\n<p>I am not very familiar with bitbucket, sorry for the formatting!</p>\n<p>Thanks,\nJulia</p>", "type": "rendered"}, "created_on": "2018-02-15T00:12:28.339391+00:00", "user": {"display_name": "Julia Cline", "uuid": "{97718b1a-c50c-4a7e-9335-e1766097a67e}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B97718b1a-c50c-4a7e-9335-e1766097a67e%7D"}, "html": {"href": "https://bitbucket.org/%7B97718b1a-c50c-4a7e-9335-e1766097a67e%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/514287ed8f5d88b9ad075409a8813a48d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJC-0.png"}}, "nickname": "julia_cline", "type": "user", "account_id": "5a4bf63de0a6f308201e17c4"}, "updated_on": "2018-02-15T00:12:28.482543+00:00", "type": "pullrequest_comment", "id": 56360991}