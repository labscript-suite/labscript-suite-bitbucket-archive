{"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/26/comments/56434877.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/26/_/diff#comment-56434877"}}, "parent": {"id": 56360991, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/26/comments/56360991.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/26/_/diff#comment-56360991"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 26, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/26.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/26"}}, "title": "Feature PyCaptureCamServer"}, "content": {"raw": "Hi Julia,\n\n* Yes, that should be idx+1. \n* This is a known bug that I hadn't got around to fixing.\n\nI just pushed a commit that should correct both problems. However, I have not fully tested them yet since we're in the midst of an experimental rebuild. Let me know if there's an issue and I can revert/update the code.\n\n* This is trickier. I suspect that the problem is with the camera and not the server. When I've seen similar errors, the problem has always been that I was not waiting long enough between images (if the timeout occurs at image 2) or that my trigger width is insufficient (if the timeout is at image 1). It looks like the frame rate for your camera is 30 FPS, so the time between triggers will need to be at least 34 ms for full frame readout. I have found that FLIR cameras often slightly under perform their frame rate spec when they're used with custom software, so you may need to increase the delay between images further. Your max_wait is set for 10 ms, so that may be part of the problem.\n\nThe issue with sequential single image runs worries me more. I haven't seen this behavior before, so it may be an edge case bug. Your single shot routine does not exit the grab loop cleanly (there's no \"Capture stopped\" print out). Maybe the experimental cycle time is shorter than the camera readout time? max_wait defaults to 100 ms with a single image, so the cycle could come around before the camera buffer retrieval times out. I'll dig into this more when I have more time and the ability to test.", "markup": "markdown", "html": "<p>Hi Julia,</p>\n<ul>\n<li>Yes, that should be idx+1. </li>\n<li>This is a known bug that I hadn't got around to fixing.</li>\n</ul>\n<p>I just pushed a commit that should correct both problems. However, I have not fully tested them yet since we're in the midst of an experimental rebuild. Let me know if there's an issue and I can revert/update the code.</p>\n<ul>\n<li>This is trickier. I suspect that the problem is with the camera and not the server. When I've seen similar errors, the problem has always been that I was not waiting long enough between images (if the timeout occurs at image 2) or that my trigger width is insufficient (if the timeout is at image 1). It looks like the frame rate for your camera is 30 FPS, so the time between triggers will need to be at least 34 ms for full frame readout. I have found that FLIR cameras often slightly under perform their frame rate spec when they're used with custom software, so you may need to increase the delay between images further. Your max_wait is set for 10 ms, so that may be part of the problem.</li>\n</ul>\n<p>The issue with sequential single image runs worries me more. I haven't seen this behavior before, so it may be an edge case bug. Your single shot routine does not exit the grab loop cleanly (there's no \"Capture stopped\" print out). Maybe the experimental cycle time is shorter than the camera readout time? max_wait defaults to 100 ms with a single image, so the cycle could come around before the camera buffer retrieval times out. I'll dig into this more when I have more time and the ability to test.</p>", "type": "rendered"}, "created_on": "2018-02-15T15:31:39.199172+00:00", "user": {"display_name": "Daniel Barker", "uuid": "{6f3f4446-92ab-4af6-83ed-bb2906b3a304}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6f3f4446-92ab-4af6-83ed-bb2906b3a304%7D"}, "html": {"href": "https://bitbucket.org/%7B6f3f4446-92ab-4af6-83ed-bb2906b3a304%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/fbcf4c479308ad530548be5884a7c70fd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsDB-4.png"}}, "nickname": "dsbarker", "type": "user", "account_id": "557058:02be919f-267c-4793-9e86-ef07d163b58b"}, "updated_on": "2018-02-15T15:33:08.114622+00:00", "type": "pullrequest_comment", "id": 56434877}