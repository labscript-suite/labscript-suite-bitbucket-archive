{"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/34/comments/58878865.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/34/_/diff#comment-58878865"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 34, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/34.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/34"}}, "title": "Prepare Connectiontable for Remote Workers"}, "content": {"raw": "I'm currently extending zprocess such that launching a subprocess on another computer will be as simple as passing in a hostname and port to `zprocess.subprocess_with_queues`. Once I'm done that, BLACS will be able to launch tabs almost as normal, except that it will have to extract the hostname from BLACS_connection (and the zprocess \"command server\" port from labconfig - the other computer will have to be running a zprocess daemon similar to zlock, but for launching subprocesses) and pass these as additional arguments to zprocess.subprocess_with_queues(), which will handle the rest. That way subprocesses on the same computer, or on another computer, can be almost completely transparent, and we can use it for things like running lyse routines on different computers even, or any of the other multiprocessing that we do. I think making our multiprocessing library handle most of the work is better than building it into BLACS, especially since it will be important to have the remote devices (or any remote subprocesses) still be able to use zprocess events and heartbeating, so zprocess will be intimately involved.\n\nSo connections.py should continue to return all devices.\n\nIt is useful to return the remote connection, yes, but I'm going to be talking to phil about that, since I suspect only a hostname will be needed and not a hostname and port (the zprocess command servers will be running on fixed ports, and so really that belongs in labconfig like other port numbers, even that means a list in labconfig if the ports are different for different computers). And also that perhaps we can deprecate BLACS_connection and store only the hostname there (with BLACS_connection moving to connection_table_properties with a device-specific name).\n\nSo I'd vote to decline this, though I'll wait to let phil comment if he wants.", "markup": "markdown", "html": "<p>I'm currently extending zprocess such that launching a subprocess on another computer will be as simple as passing in a hostname and port to <code>zprocess.subprocess_with_queues</code>. Once I'm done that, BLACS will be able to launch tabs almost as normal, except that it will have to extract the hostname from BLACS_connection (and the zprocess \"command server\" port from labconfig - the other computer will have to be running a zprocess daemon similar to zlock, but for launching subprocesses) and pass these as additional arguments to zprocess.subprocess_with_queues(), which will handle the rest. That way subprocesses on the same computer, or on another computer, can be almost completely transparent, and we can use it for things like running lyse routines on different computers even, or any of the other multiprocessing that we do. I think making our multiprocessing library handle most of the work is better than building it into BLACS, especially since it will be important to have the remote devices (or any remote subprocesses) still be able to use zprocess events and heartbeating, so zprocess will be intimately involved.</p>\n<p>So connections.py should continue to return all devices.</p>\n<p>It is useful to return the remote connection, yes, but I'm going to be talking to phil about that, since I suspect only a hostname will be needed and not a hostname and port (the zprocess command servers will be running on fixed ports, and so really that belongs in labconfig like other port numbers, even that means a list in labconfig if the ports are different for different computers). And also that perhaps we can deprecate BLACS_connection and store only the hostname there (with BLACS_connection moving to connection_table_properties with a device-specific name).</p>\n<p>So I'd vote to decline this, though I'll wait to let phil comment if he wants.</p>", "type": "rendered"}, "created_on": "2018-03-15T01:54:38.557263+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-03-15T01:54:38.560832+00:00", "type": "pullrequest_comment", "id": 58878865}