{"rendered": {"description": {"raw": "Add a function `get_unit_conversion_class(fullname)` to unitconversions module. If a fully qualified class name is provided, this will import just the class specified (even if it is not located within the unitconversions folder), without importing the entire contents of the unitconversions submodule, as is presently done.\r\n\r\nOtherwise, if just a class name is given without a full import path,\r\nthe function falls back to importing everything to find the class of the given\r\nname. This provides backward compatibility with shots compiled with versions\r\nof labscript that save the class name only (i.e. the current version).\r\n\r\nA custom `__all__` provides backward compatibility for versions of BLACS\r\n(i.e. the current version) that dont' know about this new function, and which import * from unitconversions. Submodules\r\nare only imported en-masse if `__all__` is actually accessed, at which point\r\nall the classes are imported and loaded into the globals dictionary (and their\r\nnames added to `__all__`).\r\n\r\nThis custom `__all__` even takes the bizarre step of adding items to the\r\n`globals()` dictionary (and to `__all__`) with the fully qualified names, e.g.\r\n'labscript_utils.unitconversions.submodule.SomeClass', usually disallowed\r\nvariable names in Python. This ensures that if an old version of BLACS\r\n(i.e. the current version) imports * and inspects its `globals()` dict looking\r\nfor unit conversion classes, it will still find them, even if the shot file\r\nthe conversion class name is coming from was compiled with a newer version of\r\nlabscript that saves the full paths.\r\n\r\nThis change paves the way for:\r\n\r\n* lascript to save fully qualified unit conversion class names, allowing\r\n  unit conversion classes to be stored within userlib instead of labscript_utils.\r\n\r\n* BLACS to improve performance by not importing all the classes en-masse.\r\n\r\nwhilst supporting full backward compatibility.", "markup": "markdown", "html": "<p>Add a function <code>get_unit_conversion_class(fullname)</code> to unitconversions module. If a fully qualified class name is provided, this will import just the class specified (even if it is not located within the unitconversions folder), without importing the entire contents of the unitconversions submodule, as is presently done.</p>\n<p>Otherwise, if just a class name is given without a full import path,\nthe function falls back to importing everything to find the class of the given\nname. This provides backward compatibility with shots compiled with versions\nof labscript that save the class name only (i.e. the current version).</p>\n<p>A custom <code>__all__</code> provides backward compatibility for versions of BLACS\n(i.e. the current version) that dont' know about this new function, and which import * from unitconversions. Submodules\nare only imported en-masse if <code>__all__</code> is actually accessed, at which point\nall the classes are imported and loaded into the globals dictionary (and their\nnames added to <code>__all__</code>).</p>\n<p>This custom <code>__all__</code> even takes the bizarre step of adding items to the\n<code>globals()</code> dictionary (and to <code>__all__</code>) with the fully qualified names, e.g.\n'labscript_utils.unitconversions.submodule.SomeClass', usually disallowed\nvariable names in Python. This ensures that if an old version of BLACS\n(i.e. the current version) imports * and inspects its <code>globals()</code> dict looking\nfor unit conversion classes, it will still find them, even if the shot file\nthe conversion class name is coming from was compiled with a newer version of\nlabscript that saves the full paths.</p>\n<p>This change paves the way for:</p>\n<ul>\n<li>\n<p>lascript to save fully qualified unit conversion class names, allowing\n  unit conversion classes to be stored within userlib instead of labscript_utils.</p>\n</li>\n<li>\n<p>BLACS to improve performance by not importing all the classes en-masse.</p>\n</li>\n</ul>\n<p>whilst supporting full backward compatibility.</p>", "type": "rendered"}, "title": {"raw": "Unit conversion restructuring", "markup": "markdown", "html": "<p>Unit conversion restructuring</p>", "type": "rendered"}}, "type": "pullrequest", "description": "Add a function `get_unit_conversion_class(fullname)` to unitconversions module. If a fully qualified class name is provided, this will import just the class specified (even if it is not located within the unitconversions folder), without importing the entire contents of the unitconversions submodule, as is presently done.\r\n\r\nOtherwise, if just a class name is given without a full import path,\r\nthe function falls back to importing everything to find the class of the given\r\nname. This provides backward compatibility with shots compiled with versions\r\nof labscript that save the class name only (i.e. the current version).\r\n\r\nA custom `__all__` provides backward compatibility for versions of BLACS\r\n(i.e. the current version) that dont' know about this new function, and which import * from unitconversions. Submodules\r\nare only imported en-masse if `__all__` is actually accessed, at which point\r\nall the classes are imported and loaded into the globals dictionary (and their\r\nnames added to `__all__`).\r\n\r\nThis custom `__all__` even takes the bizarre step of adding items to the\r\n`globals()` dictionary (and to `__all__`) with the fully qualified names, e.g.\r\n'labscript_utils.unitconversions.submodule.SomeClass', usually disallowed\r\nvariable names in Python. This ensures that if an old version of BLACS\r\n(i.e. the current version) imports * and inspects its `globals()` dict looking\r\nfor unit conversion classes, it will still find them, even if the shot file\r\nthe conversion class name is coming from was compiled with a newer version of\r\nlabscript that saves the full paths.\r\n\r\nThis change paves the way for:\r\n\r\n* lascript to save fully qualified unit conversion class names, allowing\r\n  unit conversion classes to be stored within userlib instead of labscript_utils.\r\n\r\n* BLACS to improve performance by not importing all the classes en-masse.\r\n\r\nwhilst supporting full backward compatibility.", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_utils/pullrequests/58/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_utils/diffstat/labscript_suite/labscript_utils:5f7618c64d6c%0D49f8562b0620?from_pullrequest_id=58"}, "commits": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/58/commits.json"}, "self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/58.json"}, "comments": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/58/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_utils/pullrequests/58/merge"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/58"}, "activity": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/58/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_utils/diff/labscript_suite/labscript_utils:5f7618c64d6c%0D49f8562b0620?from_pullrequest_id=58"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/labscript_utils/pullrequests/58/approve"}, "statuses": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/58/statuses_page=1.json"}}, "title": "Unit conversion restructuring", "close_source_branch": true, "reviewers": [{"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}], "id": 58, "destination": {"commit": {"hash": "49f8562b0620", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/49f8562b0620.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/49f8562b0620"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "created_on": "2018-10-04T03:17:17.226078+00:00", "summary": {"raw": "Add a function `get_unit_conversion_class(fullname)` to unitconversions module. If a fully qualified class name is provided, this will import just the class specified (even if it is not located within the unitconversions folder), without importing the entire contents of the unitconversions submodule, as is presently done.\r\n\r\nOtherwise, if just a class name is given without a full import path,\r\nthe function falls back to importing everything to find the class of the given\r\nname. This provides backward compatibility with shots compiled with versions\r\nof labscript that save the class name only (i.e. the current version).\r\n\r\nA custom `__all__` provides backward compatibility for versions of BLACS\r\n(i.e. the current version) that dont' know about this new function, and which import * from unitconversions. Submodules\r\nare only imported en-masse if `__all__` is actually accessed, at which point\r\nall the classes are imported and loaded into the globals dictionary (and their\r\nnames added to `__all__`).\r\n\r\nThis custom `__all__` even takes the bizarre step of adding items to the\r\n`globals()` dictionary (and to `__all__`) with the fully qualified names, e.g.\r\n'labscript_utils.unitconversions.submodule.SomeClass', usually disallowed\r\nvariable names in Python. This ensures that if an old version of BLACS\r\n(i.e. the current version) imports * and inspects its `globals()` dict looking\r\nfor unit conversion classes, it will still find them, even if the shot file\r\nthe conversion class name is coming from was compiled with a newer version of\r\nlabscript that saves the full paths.\r\n\r\nThis change paves the way for:\r\n\r\n* lascript to save fully qualified unit conversion class names, allowing\r\n  unit conversion classes to be stored within userlib instead of labscript_utils.\r\n\r\n* BLACS to improve performance by not importing all the classes en-masse.\r\n\r\nwhilst supporting full backward compatibility.", "markup": "markdown", "html": "<p>Add a function <code>get_unit_conversion_class(fullname)</code> to unitconversions module. If a fully qualified class name is provided, this will import just the class specified (even if it is not located within the unitconversions folder), without importing the entire contents of the unitconversions submodule, as is presently done.</p>\n<p>Otherwise, if just a class name is given without a full import path,\nthe function falls back to importing everything to find the class of the given\nname. This provides backward compatibility with shots compiled with versions\nof labscript that save the class name only (i.e. the current version).</p>\n<p>A custom <code>__all__</code> provides backward compatibility for versions of BLACS\n(i.e. the current version) that dont' know about this new function, and which import * from unitconversions. Submodules\nare only imported en-masse if <code>__all__</code> is actually accessed, at which point\nall the classes are imported and loaded into the globals dictionary (and their\nnames added to <code>__all__</code>).</p>\n<p>This custom <code>__all__</code> even takes the bizarre step of adding items to the\n<code>globals()</code> dictionary (and to <code>__all__</code>) with the fully qualified names, e.g.\n'labscript_utils.unitconversions.submodule.SomeClass', usually disallowed\nvariable names in Python. This ensures that if an old version of BLACS\n(i.e. the current version) imports * and inspects its <code>globals()</code> dict looking\nfor unit conversion classes, it will still find them, even if the shot file\nthe conversion class name is coming from was compiled with a newer version of\nlabscript that saves the full paths.</p>\n<p>This change paves the way for:</p>\n<ul>\n<li>\n<p>lascript to save fully qualified unit conversion class names, allowing\n  unit conversion classes to be stored within userlib instead of labscript_utils.</p>\n</li>\n<li>\n<p>BLACS to improve performance by not importing all the classes en-masse.</p>\n</li>\n</ul>\n<p>whilst supporting full backward compatibility.</p>", "type": "rendered"}, "source": {"commit": {"hash": "b419656e0ce8", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/b419656e0ce8"}, "html": {"href": "#!/cbillington/labscript_utils/commits/b419656e0ce8"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "defer_unit_conversion_imports"}}, "comment_count": 5, "state": "MERGED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2018-10-25T18:53:10.601606+00:00", "type": "participant", "approved": false, "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}}, {"role": "PARTICIPANT", "participated_on": "2018-10-05T15:06:51.988474+00:00", "type": "participant", "approved": false, "user": {"display_name": "Lars Kohfahl", "uuid": "{14b59397-cbc0-4d8c-8a4a-fe99fb4d2d4a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B14b59397-cbc0-4d8c-8a4a-fe99fb4d2d4a%7D"}, "html": {"href": "https://bitbucket.org/%7B14b59397-cbc0-4d8c-8a4a-fe99fb4d2d4a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/630642264cd55e22515678a3a0489ac7d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsLK-2.png"}}, "nickname": "lkohfahl", "type": "user", "account_id": "5aafc5d11396802a57aa7f3b"}}, {"role": "REVIEWER", "participated_on": "2018-10-14T05:37:22.705127+00:00", "type": "participant", "approved": false, "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}}, {"role": "PARTICIPANT", "participated_on": "2018-10-05T16:43:00.088634+00:00", "type": "participant", "approved": false, "user": {"display_name": "Jan Werkmann", "uuid": "{44c4905c-2b90-4045-a5f1-652b8e228626}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D"}, "html": {"href": "https://bitbucket.org/%7B44c4905c-2b90-4045-a5f1-652b8e228626%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5/07e5095a-4741-4dc0-a462-9c7d455f961d/128"}}, "nickname": "PhyNerd", "type": "user", "account_id": "557058:a70cc9cf-684e-4849-a61a-9ade4d7218b5"}}], "reason": "", "updated_on": "2018-10-25T18:53:15.018981+00:00", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "merge_commit": {"hash": "5f7618c64d6c", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/5f7618c64d6c.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/5f7618c64d6c"}}}, "closed_by": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}}