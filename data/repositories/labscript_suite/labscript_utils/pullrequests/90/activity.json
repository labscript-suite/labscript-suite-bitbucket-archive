{"pagelen": 50, "values": [{"update": {"description": "Bugfix for double_import_denier and better error message for h5_lock\r\n\r\n* Double import denier had a bug where a module that was already imported\r\n  when double import denier was enabled would be stored in its list of modules\r\n  by its `__file__` attribute. However, the import machinery as used later\r\n  by double import denier actually identifies modules by their directory for the\r\n  case of an `__init__.py` file. Therefore to match with later checks, this\r\n  directory should be stored instead when the module's file is `__init__.py`.\r\n\r\n* h5_lock must be imported before h5py, and raises an error if h5py is already\r\n  imported. This commit improves the error message by using the double import\r\n  denier, if enabled, to show the traceback it saved from when h5py was imported.\r\n\r\nThe motivation for this is a bug I've heard about from two people that they're\r\ngetting an error from h5_lock saying h5py was already imported, and I don't know\r\nwhere. There are hacks you can do to diagnose this locally, but making the error\r\nmessage better will allow us to handle such bugs easier in the future.\r\n\r\nLonger term we should probably stop monkey-patching h5py and instead just use\r\na subclass, but that's a change for another day.", "title": "Bugfix for double_import_denier and better error message for h5_lock", "destination": {"commit": {"hash": "61f4c846e51b", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/61f4c846e51b.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/61f4c846e51b"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "68178dac527d", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/68178dac527d"}, "html": {"href": "#!/cbillington/labscript_utils/commits/68178dac527d"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "h5_lock_better_error"}}, "state": "MERGED", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-09-13T20:33:25.796185+00:00"}, "pull_request": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}}, {"update": {"description": "Bugfix for double_import_denier and better error message for h5_lock\r\n\r\n* Double import denier had a bug where a module that was already imported\r\n  when double import denier was enabled would be stored in its list of modules\r\n  by its `__file__` attribute. However, the import machinery as used later\r\n  by double import denier actually identifies modules by their directory for the\r\n  case of an `__init__.py` file. Therefore to match with later checks, this\r\n  directory should be stored instead when the module's file is `__init__.py`.\r\n\r\n* h5_lock must be imported before h5py, and raises an error if h5py is already\r\n  imported. This commit improves the error message by using the double import\r\n  denier, if enabled, to show the traceback it saved from when h5py was imported.\r\n\r\nThe motivation for this is a bug I've heard about from two people that they're\r\ngetting an error from h5_lock saying h5py was already imported, and I don't know\r\nwhere. There are hacks you can do to diagnose this locally, but making the error\r\nmessage better will allow us to handle such bugs easier in the future.\r\n\r\nLonger term we should probably stop monkey-patching h5py and instead just use\r\na subclass, but that's a change for another day.", "title": "Bugfix for double_import_denier and better error message for h5_lock", "destination": {"commit": {"hash": "61f4c846e51b", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/61f4c846e51b.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/61f4c846e51b"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "68178dac527d", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/68178dac527d"}, "html": {"href": "#!/cbillington/labscript_utils/commits/68178dac527d"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "h5_lock_better_error"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-09-13T20:33:23.637557+00:00"}, "pull_request": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90/comments/114136090.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90/_/diff#comment-114136090"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}, "content": {"raw": "Using the better error message, we found the bug and fixed it. It was `labscript_utils.properties` importing h5py without importing h5\\_lock. This bug was introduced in the recent serialised-attributes changes. ", "markup": "markdown", "html": "<p>Using the better error message, we found the bug and fixed it. It was <code>labscript_utils.properties</code> importing h5py without importing h5_lock. This bug was introduced in the recent serialised-attributes changes. </p>", "type": "rendered"}, "created_on": "2019-08-22T17:56:50.184153+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2019-08-22T17:56:50.192790+00:00", "type": "pullrequest_comment", "id": 114136090}, "pull_request": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}}, {"update": {"description": "Bugfix for double_import_denier and better error message for h5_lock\r\n\r\n* Double import denier had a bug where a module that was already imported\r\n  when double import denier was enabled would be stored in its list of modules\r\n  by its `__file__` attribute. However, the import machinery as used later\r\n  by double import denier actually identifies modules by their directory for the\r\n  case of an `__init__.py` file. Therefore to match with later checks, this\r\n  directory should be stored instead when the module's file is `__init__.py`.\r\n\r\n* h5_lock must be imported before h5py, and raises an error if h5py is already\r\n  imported. This commit improves the error message by using the double import\r\n  denier, if enabled, to show the traceback it saved from when h5py was imported.\r\n\r\nThe motivation for this is a bug I've heard about from two people that they're\r\ngetting an error from h5_lock saying h5py was already imported, and I don't know\r\nwhere. There are hacks you can do to diagnose this locally, but making the error\r\nmessage better will allow us to handle such bugs easier in the future.\r\n\r\nLonger term we should probably stop monkey-patching h5py and instead just use\r\na subclass, but that's a change for another day.", "title": "Bugfix for double_import_denier and better error message for h5_lock", "destination": {"commit": {"hash": "61f4c846e51b", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/61f4c846e51b.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/61f4c846e51b"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "68178dac527d", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/68178dac527d"}, "html": {"href": "#!/cbillington/labscript_utils/commits/68178dac527d"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "h5_lock_better_error"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-08-22T17:55:28.591990+00:00"}, "pull_request": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90/comments/114109234.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90/_/diff#comment-114109234"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}, "content": {"raw": "Looks like this:\n\n```python\nTraceback (most recent call last):\n  File \"303.py\", line 4, in <module>\n    import labscript_utils.h5_lock\n  File \"/home/bilbo/labscript_suite/labscript_utils/h5_lock.py\", line 41, in <module>\n    raise ImportError(msg)\nImportError: Error importing h5_lock: h5py has already been imported. h5_lock must be imported before any code imports h5py. The above traceback shows where h5_lock was imported, and the below traceback shows where h5py was imported prior.\n\nTraceback (h5py import):\n------------\n  File \"303.py\", line 3, in <module>\n    import h5py\n------------\n```\n\n\u200c", "markup": "markdown", "html": "<p>Looks like this:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;303.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">labscript_utils.h5_lock</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/bilbo/labscript_suite/labscript_utils/h5_lock.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">41</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"k\">raise</span> <span class=\"ne\">ImportError</span><span class=\"p\">(</span><span class=\"n\">msg</span><span class=\"p\">)</span>\n<span class=\"ne\">ImportError</span><span class=\"p\">:</span> <span class=\"n\">Error</span> <span class=\"n\">importing</span> <span class=\"n\">h5_lock</span><span class=\"p\">:</span> <span class=\"n\">h5py</span> <span class=\"n\">has</span> <span class=\"n\">already</span> <span class=\"n\">been</span> <span class=\"n\">imported</span><span class=\"o\">.</span> <span class=\"n\">h5_lock</span> <span class=\"n\">must</span> <span class=\"n\">be</span> <span class=\"n\">imported</span> <span class=\"n\">before</span> <span class=\"nb\">any</span> <span class=\"n\">code</span> <span class=\"n\">imports</span> <span class=\"n\">h5py</span><span class=\"o\">.</span> <span class=\"n\">The</span> <span class=\"n\">above</span> <span class=\"n\">traceback</span> <span class=\"n\">shows</span> <span class=\"n\">where</span> <span class=\"n\">h5_lock</span> <span class=\"n\">was</span> <span class=\"n\">imported</span><span class=\"p\">,</span> <span class=\"ow\">and</span> <span class=\"n\">the</span> <span class=\"n\">below</span> <span class=\"n\">traceback</span> <span class=\"n\">shows</span> <span class=\"n\">where</span> <span class=\"n\">h5py</span> <span class=\"n\">was</span> <span class=\"n\">imported</span> <span class=\"n\">prior</span><span class=\"o\">.</span>\n\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">h5py</span> <span class=\"n\">import</span><span class=\"p\">):</span>\n<span class=\"o\">------------</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;303.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">h5py</span>\n<span class=\"o\">------------</span>\n</pre></div>\n\n\n<p>\u200c</p>", "type": "rendered"}, "created_on": "2019-08-22T14:58:03.818904+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2019-08-22T14:58:03.838583+00:00", "type": "pullrequest_comment", "id": 114109234}, "pull_request": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}}, {"update": {"description": "Bugfix for double_import_denier and better error message for h5_lock\r\n\r\n* Double import denier had a bug where a module that was already imported\r\n  when double import denier was enabled would be stored in its list of modules\r\n  by its `__file__` attribute. However, the import machinery as used later\r\n  by double import denier actually identifies modules by their directory for the\r\n  case of an `__init__.py` file. Therefore to match with later checks, this\r\n  directory should be stored instead when the module's file is `__init__.py`.\r\n\r\n* h5_lock must be imported before h5py, and raises an error if h5py is already\r\n  imported. This commit improves the error message by using the double import\r\n  denier, if enabled, to show the traceback it saved from when h5py was imported.\r\n\r\nThe motivation for this is a bug I've heard about from two people that they're\r\ngetting an error from h5_lock saying h5py was already imported, and I don't know\r\nwhere. There are hacks you can do to diagnose this locally, but making the error\r\nmessage better will allow us to handle such bugs easier in the future.\r\n\r\nLonger term we should probably stop monkey-patching h5py and instead just use\r\na subclass, but that's a change for another day.", "title": "Bugfix for double_import_denier and better error message for h5_lock", "destination": {"commit": {"hash": "61f4c846e51b", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/61f4c846e51b.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/61f4c846e51b"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "4e160126d73f", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/4e160126d73f"}, "html": {"href": "#!/cbillington/labscript_utils/commits/4e160126d73f"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "h5_lock_better_error"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-08-22T14:57:33.794657+00:00"}, "pull_request": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}}, {"update": {"description": "Bugfix for double_import_denier and better error message for h5_lock\r\n\r\n* Double import denier had a bug where a module that was already imported\r\n  when double import denier was enabled would be stored in its list of modules\r\n  by its `__file__` attribute. However, the import machinery as used later\r\n  by double import denier actually identifies modules by their directory for the\r\n  case of an `__init__.py` file. Therefore to match with later checks, this\r\n  directory should be stored instead when the module's file is `__init__.py`.\r\n\r\n* h5_lock must be imported before h5py, and raises an error if h5py is already\r\n  imported. This commit improves the error message by using the double import\r\n  denier, if enabled, to show the traceback it saved from when h5py was imported.\r\n\r\nThe motivation for this is a bug I've heard about from two people that they're\r\ngetting an error from h5_lock saying h5py was already imported, and I don't know\r\nwhere. There are hacks you can do to diagnose this locally, but making the error\r\nmessage better will allow us to handle such bugs easier in the future.\r\n\r\nLonger term we should probably stop monkey-patching h5py and instead just use\r\na subclass, but that's a change for another day.", "title": "Bugfix for double_import_denier and better error message for h5_lock", "destination": {"commit": {"hash": "61f4c846e51b", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/61f4c846e51b.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/61f4c846e51b"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "05e69ac87c90", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/05e69ac87c90"}, "html": {"href": "#!/cbillington/labscript_utils/commits/05e69ac87c90"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "h5_lock_better_error"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-08-22T14:55:37.809515+00:00"}, "pull_request": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}}, {"update": {"description": "Bugfix for double_import_denier and better error message for h5_lock\r\n\r\n* Double import denier had a bug where a module that was already imported\r\n  when double import denier was enabled would be stored in its list of modules\r\n  by its `__file__` attribute. However, the import machinery as used later\r\n  by double import denier actually identifies modules by their directory for the\r\n  case of an `__init__.py` file. Therefore to match with later checks, this\r\n  directory should be stored instead when the module's file is `__init__.py`.\r\n\r\n* h5_lock must be imported before h5py, and raises an error if h5py is already\r\n  imported. This commit improves the error message by using the double import\r\n  denier, if enabled, to show the traceback it saved from when h5py was imported.\r\n\r\nThe motivation for this is a bug I've heard about from two people that they're\r\ngetting an error from h5_lock saying h5py was already imported, and I don't know\r\nwhere. There are hacks you can do to diagnose this locally, but making the error\r\nmessage better will allow us to handle such bugs easier in the future.\r\n\r\nLonger term we should probably stop monkey-patching h5py and instead just use\r\na subclass, but that's a change for another day.", "title": "Bugfix for double_import_denier and better error message for h5_lock", "destination": {"commit": {"hash": "61f4c846e51b", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/commit/61f4c846e51b.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/commits/61f4c846e51b"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils.json"}, "html": {"href": "#!/labscript_suite/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{68347210-fb1e-4b58-86c0-bd2c04396e63}ts=249922"}}, "type": "repository", "name": "labscript_utils", "full_name": "labscript_suite/labscript_utils", "uuid": "{68347210-fb1e-4b58-86c0-bd2c04396e63}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "05e69ac87c90", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils/commit/05e69ac87c90"}, "html": {"href": "#!/cbillington/labscript_utils/commits/05e69ac87c90"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/labscript_utils"}, "html": {"href": "#!/cbillington/labscript_utils"}, "avatar": {"href": "data/bytebucket.org/ravatar/{455d0b5d-4852-4e4a-b8b1-f5ba77882210}ts=python"}}, "type": "repository", "name": "labscript_utils", "full_name": "cbillington/labscript_utils", "uuid": "{455d0b5d-4852-4e4a-b8b1-f5ba77882210}"}, "branch": {"name": "h5_lock_better_error"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2019-08-22T14:55:37.635472+00:00"}, "pull_request": {"type": "pullrequest", "id": 90, "links": {"self": {"href": "data/repositories/labscript_suite/labscript_utils/pullrequests/90.json"}, "html": {"href": "#!/labscript_suite/labscript_utils/pull-requests/90"}}, "title": "Bugfix for double_import_denier and better error message for h5_lock"}}]}