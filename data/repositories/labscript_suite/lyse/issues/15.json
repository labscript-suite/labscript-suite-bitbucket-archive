{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "links": {"attachments": {"href": "data/repositories/labscript_suite/lyse/issues/15/attachments_page=1.json"}, "self": {"href": "data/repositories/labscript_suite/lyse/issues/15.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/issues/15/watch"}, "comments": {"href": "data/repositories/labscript_suite/lyse/issues/15/comments_page=1.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/15/exceptions-in-scientific-notation-package"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/issues/15/vote"}}, "reporter": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}, "title": "Exceptions in scientific notation package should be caught", "component": null, "votes": 0, "watches": 2, "content": {"raw": "I experienced a traceback which required a restart of lyse to recover from:\r\n\r\n\r\n```\r\n#!python\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\Anaconda\\lib\\threading.py\", line 763, in run\r\n    self.__target(*self.__args, **self.__kwargs)\r\n  File \"C:\\labscript_suite\\lyse\\__main__.py\", line 1535, in analysis_loop\r\n    self.do_singleshot_analysis(filepath)\r\n  File \"C:\\labscript_suite\\lyse\\__main__.py\", line 1564, in do_singleshot_analysis\r\n    self.shots_model.update_row(filepath, status_percent=status_percent, new_row_data=new_row_data)\r\n  File \"C:\\Anaconda\\lib\\site-packages\\qtutils\\invoke_in_main.py\", line 105, in f\r\n    return inmain(fn, *args, **kwargs)\r\n  File \"C:\\Anaconda\\lib\\site-packages\\qtutils\\invoke_in_main.py\", line 68, in inmain\r\n    return get_inmain_result(in_main_later(fn,False,*args,**kwargs))\r\n  File \"C:\\Anaconda\\lib\\site-packages\\qtutils\\invoke_in_main.py\", line 47, in event\r\n    result = event.fn(*event.args, **event.kwargs)\r\n  File \"C:\\labscript_suite\\lyse\\__main__.py\", line 1264, in update_row\r\n    value_str = scientific_notation(value)\r\n  File \"C:\\labscript_suite\\lyse\\__main__.py\", line 154, in scientific_notation\r\n    prefix = prefixes[exponent]\r\nKeyError: 84\r\n```\r\n\r\nYes, it was trying to update a value which was something by 10^84 - the culprit was the width in a failed fit. While the crazy number really should be caught in the analysis script, it still isn't nice to have the whole program taken down by the scientific notation function not knowing what to do with a septemvigintillion!", "markup": "markdown", "html": "<p>I experienced a traceback which required a restart of lyse to recover from:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\Anaconda\\lib</span><span class=\"se\">\\t</span><span class=\"s2\">hreading.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">763</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">__target</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">__args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">__kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\lyse\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1535</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">analysis_loop</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">do_singleshot_analysis</span><span class=\"p\">(</span><span class=\"n\">filepath</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\lyse\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1564</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">do_singleshot_analysis</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">shots_model</span><span class=\"o\">.</span><span class=\"n\">update_row</span><span class=\"p\">(</span><span class=\"n\">filepath</span><span class=\"p\">,</span> <span class=\"n\">status_percent</span><span class=\"o\">=</span><span class=\"n\">status_percent</span><span class=\"p\">,</span> <span class=\"n\">new_row_data</span><span class=\"o\">=</span><span class=\"n\">new_row_data</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\Anaconda\\lib\\site-packages\\qtutils\\invoke_in_main.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">105</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">f</span>\n    <span class=\"k\">return</span> <span class=\"n\">inmain</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\Anaconda\\lib\\site-packages\\qtutils\\invoke_in_main.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">68</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">inmain</span>\n    <span class=\"k\">return</span> <span class=\"n\">get_inmain_result</span><span class=\"p\">(</span><span class=\"n\">in_main_later</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"p\">,</span><span class=\"bp\">False</span><span class=\"p\">,</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span><span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">))</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\Anaconda\\lib\\site-packages\\qtutils\\invoke_in_main.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">47</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">event</span>\n    <span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">fn</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\lyse\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1264</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">update_row</span>\n    <span class=\"n\">value_str</span> <span class=\"o\">=</span> <span class=\"n\">scientific_notation</span><span class=\"p\">(</span><span class=\"n\">value</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\lyse\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">154</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">scientific_notation</span>\n    <span class=\"n\">prefix</span> <span class=\"o\">=</span> <span class=\"n\">prefixes</span><span class=\"p\">[</span><span class=\"n\">exponent</span><span class=\"p\">]</span>\n<span class=\"ne\">KeyError</span><span class=\"p\">:</span> <span class=\"mi\">84</span>\n</pre></div>\n\n\n<p>Yes, it was trying to update a value which was something by 10^84 - the culprit was the width in a failed fit. While the crazy number really should be caught in the analysis script, it still isn't nice to have the whole program taken down by the scientific notation function not knowing what to do with a septemvigintillion!</p>", "type": "rendered"}, "assignee": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "state": "resolved", "version": null, "edited_on": null, "created_on": "2015-06-18T06:31:30.827833+00:00", "milestone": null, "updated_on": "2015-07-16T04:21:31.910062+00:00", "type": "issue", "id": 15}