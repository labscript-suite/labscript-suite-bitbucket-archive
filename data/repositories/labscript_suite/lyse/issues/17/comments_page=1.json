{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17/comments/20513462.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/17#comment-20513462"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17.json"}}, "type": "issue", "id": 17, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Main interface is slow/unresponsive when multi-shot routines are running"}, "content": {"raw": "Huh. I was going to say that it's slow because pickling is slow, and it's unresponsive because pickling holds the GIL. But...I just grabbed the dataframe from your running copy of lyse (which took 7 seconds), and pickling and unpickling it locally on my computer is almost instantaneous. And it's only 19MB, and we're connected by gigabit Ethernet...I don't get it. Looks like it should be fast. Profiling is in order.", "markup": "markdown", "html": "<p>Huh. I was going to say that it's slow because pickling is slow, and it's unresponsive because pickling holds the GIL. But...I just grabbed the dataframe from your running copy of lyse (which took 7 seconds), and pickling and unpickling it locally on my computer is almost instantaneous. And it's only 19MB, and we're connected by gigabit Ethernet...I don't get it. Looks like it should be fast. Profiling is in order.</p>", "type": "rendered"}, "created_on": "2015-07-28T07:58:34.974349+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 20513462}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17/comments/20516104.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/17#comment-20516104"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17.json"}}, "type": "issue", "id": 17, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Main interface is slow/unresponsive when multi-shot routines are running"}, "content": {"raw": "Progress! The dataframe in lyse is slow to pickle. After the processing lyse.data() does on it, the resulting dataframe is *fast* to pickle. The processing that appears to make pickling fast is df.convert_objects(). Before this call, one has a slow pickling object, after this call, one has a fast pickling object.\n\nMy impression is that convert_objects is replacing big hulking Python object containing column objects with fast, nimble, array datatype columns, where possible. Since most of the data in columns is numeric, it can replace them all with float/int/whatever arrays and this is much faster for pickle than considering each item a Python object of an arbitrary datatype.\n\nCommitting a fix to krb fork for testing.", "markup": "markdown", "html": "<p>Progress! The dataframe in lyse is slow to pickle. After the processing lyse.data() does on it, the resulting dataframe is <em>fast</em> to pickle. The processing that appears to make pickling fast is df.convert_objects(). Before this call, one has a slow pickling object, after this call, one has a fast pickling object.</p>\n<p>My impression is that convert_objects is replacing big hulking Python object containing column objects with fast, nimble, array datatype columns, where possible. Since most of the data in columns is numeric, it can replace them all with float/int/whatever arrays and this is much faster for pickle than considering each item a Python object of an arbitrary datatype.</p>\n<p>Committing a fix to krb fork for testing.</p>", "type": "rendered"}, "created_on": "2015-07-28T09:31:18.571665+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 20516104}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17/comments/25313622.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/17#comment-25313622"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17.json"}}, "type": "issue", "id": 17, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Main interface is slow/unresponsive when multi-shot routines are running"}, "content": {"raw": "Merged in monashkrb/lyse (pull request #3)\n\nFixes #16 and #17\n\n\u2192 <<cset c8342f48860c>>", "markup": "markdown", "html": "<p>Merged in <a href=\"#!/monashkrb/lyse\" rel=\"nofollow\" class=\"ap-connect-link\">monashkrb/lyse</a> (<a href=\"#!/labscript_suite/lyse/pull-requests/3/fixes-16-and-17\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #3</a>)</p>\n<p>Fixes <a href=\"#!/labscript_suite/lyse/issues/16/multi-shot-routines-run-out-of-order\" rel=\"nofollow\" title=\"Multi-shot routines run out of order\" class=\"ap-connect-link\"><s>#16</s></a> and <a href=\"#!/labscript_suite/lyse/issues/17/main-interface-is-slow-unresponsive-when\" rel=\"nofollow\" title=\"Main interface is slow/unresponsive when multi-shot routines are running\" class=\"ap-connect-link\"><s>#17</s></a></p>\n<p>\u2192 &lt;&lt;cset <a href=\"#!/labscript_suite/lyse/commits/c8342f48860c\" rel=\"nofollow\" class=\"ap-connect-link\">c8342f48860c</a>&gt;&gt;</p>", "type": "rendered"}, "created_on": "2016-02-08T01:33:27.472393+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 25313622}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17/comments/25313624.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/17#comment-25313624"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17.json"}}, "type": "issue", "id": 17, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Main interface is slow/unresponsive when multi-shot routines are running"}, "content": {"raw": "Fixes #17 by speeding up dataframe transfers.\n\nMoved call to df.convert_objects to the lyse server, which makes dataframes more\nefficiently picklable by replacing columns containing only a single array datatype\nwith an array of that datatype. Previously df.convert_obects was only called\nafter the transfer, so the preceding pickling was slow.\n\nFor the large, mostly numeric dataframe tested, this speeds\nup pickling and unpickling by approx a factor of 5.\n\nAlso set convert_numeric=False in the call to df.convert_objects. It was\npreviously set to True, but I don't think this is what we want. With it False,\nall-numeric columns are still converted as desired. With it True, *strings* are\nconverted to numbers even if only a single string is convertible to a numeric\nvalue, with all non-convertable values in the column becoming NaNs. I don't\nthink this is what we want. If the user asked for a string, the data should\nremain a string. It is presumptuous to assume otherwise and I suspect a\nmisunderstanding by whoever wrote this line originally.\n\n\u2192 <<cset dd55417f2a64>>", "markup": "markdown", "html": "<p>Fixes <a href=\"#!/labscript_suite/lyse/issues/17/main-interface-is-slow-unresponsive-when\" rel=\"nofollow\" title=\"Main interface is slow/unresponsive when multi-shot routines are running\" class=\"ap-connect-link\"><s>#17</s></a> by speeding up dataframe transfers.</p>\n<p>Moved call to df.convert_objects to the lyse server, which makes dataframes more\nefficiently picklable by replacing columns containing only a single array datatype\nwith an array of that datatype. Previously df.convert_obects was only called\nafter the transfer, so the preceding pickling was slow.</p>\n<p>For the large, mostly numeric dataframe tested, this speeds\nup pickling and unpickling by approx a factor of 5.</p>\n<p>Also set convert_numeric=False in the call to df.convert_objects. It was\npreviously set to True, but I don't think this is what we want. With it False,\nall-numeric columns are still converted as desired. With it True, <em>strings</em> are\nconverted to numbers even if only a single string is convertible to a numeric\nvalue, with all non-convertable values in the column becoming NaNs. I don't\nthink this is what we want. If the user asked for a string, the data should\nremain a string. It is presumptuous to assume otherwise and I suspect a\nmisunderstanding by whoever wrote this line originally.</p>\n<p>\u2192 &lt;&lt;cset <a href=\"#!/labscript_suite/lyse/commits/dd55417f2a64\" rel=\"nofollow\" class=\"ap-connect-link\">dd55417f2a64</a>&gt;&gt;</p>", "type": "rendered"}, "created_on": "2016-02-08T01:33:27.646273+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 25313624}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17/comments/25313626.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/17#comment-25313626"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/17.json"}}, "type": "issue", "id": 17, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Main interface is slow/unresponsive when multi-shot routines are running"}, "content": {"raw": "Merged in monashkrb/lyse (pull request #3)\n\nFixes #16 and #17\n\n\u2192 <<cset c8342f48860c>>", "markup": "markdown", "html": "<p>Merged in <a href=\"#!/monashkrb/lyse\" rel=\"nofollow\" class=\"ap-connect-link\">monashkrb/lyse</a> (<a href=\"#!/labscript_suite/lyse/pull-requests/3/fixes-16-and-17\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #3</a>)</p>\n<p>Fixes <a href=\"#!/labscript_suite/lyse/issues/16/multi-shot-routines-run-out-of-order\" rel=\"nofollow\" title=\"Multi-shot routines run out of order\" class=\"ap-connect-link\"><s>#16</s></a> and <a href=\"#!/labscript_suite/lyse/issues/17/main-interface-is-slow-unresponsive-when\" rel=\"nofollow\" title=\"Main interface is slow/unresponsive when multi-shot routines are running\" class=\"ap-connect-link\"><s>#17</s></a></p>\n<p>\u2192 &lt;&lt;cset <a href=\"#!/labscript_suite/lyse/commits/c8342f48860c\" rel=\"nofollow\" class=\"ap-connect-link\">c8342f48860c</a>&gt;&gt;</p>", "type": "rendered"}, "created_on": "2016-02-08T01:33:27.699349+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 25313626}], "page": 1, "size": 5}