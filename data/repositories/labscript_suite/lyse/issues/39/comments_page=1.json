{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39/comments/48540297.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/39#comment-48540297"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39.json"}}, "type": "issue", "id": 39, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Bug with module watcher reloading when mpl_toolkit used"}, "content": {"raw": "Global variables get set to None in modules before they are garbage collected.\n\nLooks like mpl_toolkits does something funky with its imports, which is conflicting with the magic we do.\n\nI notice mpl_toolkits is a 'builtin' module (it has no `__file__` attribute). We probably shouldn't unload these. Or maybe we aren't, but we're unloading their dependencies.\n\nNot sure. I'll look into it. Might consider just whitelisting everything in site-packages.", "markup": "markdown", "html": "<p>Global variables get set to None in modules before they are garbage collected.</p>\n<p>Looks like mpl_toolkits does something funky with its imports, which is conflicting with the magic we do.</p>\n<p>I notice mpl_toolkits is a 'builtin' module (it has no <code>__file__</code> attribute). We probably shouldn't unload these. Or maybe we aren't, but we're unloading their dependencies.</p>\n<p>Not sure. I'll look into it. Might consider just whitelisting everything in site-packages.</p>", "type": "rendered"}, "created_on": "2018-10-24T15:09:43.685312+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 48540297}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39/comments/48544617.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/39#comment-48544617"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39.json"}}, "type": "issue", "id": 39, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Bug with module watcher reloading when mpl_toolkit used"}, "content": {"raw": "I'm not able to reproduce this, on Ubuntu at least. What versions of python, matplotlib, etc do you see this with? Windows, presumably?", "markup": "markdown", "html": "<p>I'm not able to reproduce this, on Ubuntu at least. What versions of python, matplotlib, etc do you see this with? Windows, presumably?</p>", "type": "rendered"}, "created_on": "2018-10-24T19:29:28.793326+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-10-24T19:29:40.061575+00:00", "type": "issue_comment", "id": 48544617}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39/comments/48544686.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/39#comment-48544686"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39.json"}}, "type": "issue", "id": 39, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Bug with module watcher reloading when mpl_toolkit used"}, "content": {"raw": "Hmm odd. I'm using Python 2.7, matplotlib 1.5.1 on windows.", "markup": "markdown", "html": "<p>Hmm odd. I'm using Python 2.7, matplotlib 1.5.1 on windows.</p>", "type": "rendered"}, "created_on": "2018-10-24T19:33:31.555323+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{0147401a-13ed-4e39-a0d0-63108c18738b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0147401a-13ed-4e39-a0d0-63108c18738b%7D"}, "html": {"href": "https://bitbucket.org/%7B0147401a-13ed-4e39-a0d0-63108c18738b%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/fa0698c306b3470c00717c146b5296e9d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "philipstarkey", "type": "user", "account_id": "557058:2f99420c-1dbd-4837-952c-82c421b8fbdd"}, "updated_on": null, "type": "issue_comment", "id": 48544686}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39/comments/48544787.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/39#comment-48544787"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39.json"}}, "type": "issue", "id": 39, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Bug with module watcher reloading when mpl_toolkit used"}, "content": {"raw": "Well I'm using matplotlib 2.2, so would not be too surprising for it to be different. Is just upgrading a solution? The visual differences between version 1 and version 2 are pretty considerable, so maybe you don't want this as it would change the look of things with the data sharing for Shaun's paper.\n\nNonetheless I'll try downgrading to see if it reproduces.", "markup": "markdown", "html": "<p>Well I'm using matplotlib 2.2, so would not be too surprising for it to be different. Is just upgrading a solution? The visual differences between version 1 and version 2 are pretty considerable, so maybe you don't want this as it would change the look of things with the data sharing for Shaun's paper.</p>\n<p>Nonetheless I'll try downgrading to see if it reproduces.</p>", "type": "rendered"}, "created_on": "2018-10-24T19:38:43.927932+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 48544787}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39/comments/48545590.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/39#comment-48545590"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39.json"}}, "type": "issue", "id": 39, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Bug with module watcher reloading when mpl_toolkit used"}, "content": {"raw": "Ok, I can reproduce and I see the problem.\n\n``setuptools.pkg_resources.extern.VendorImporter``, which is used by ``mpl_toolkits`` to import its submodules, adds itself to ``sys.meta_path`` (a list of objects for overriding import behaviour). The module it lives in is deleted from ``sys.modules``, but the importer instance is still in ``sys.meta_path`` and one of its methods expects to be able to look up global variables still. That method gets called next time ``mpl_toolkits`` tries to load some submodules, but that instance sees a global scope where everything is ``None``, and breaks.\n\nSolution is likely to have ``ModuleWatcher`` roll back ``sys.meta_path`` the same way it rolls back ``sys.path``. I'll look into it.", "markup": "markdown", "html": "<p>Ok, I can reproduce and I see the problem.</p>\n<p><code>setuptools.pkg_resources.extern.VendorImporter</code>, which is used by <code>mpl_toolkits</code> to import its submodules, adds itself to <code>sys.meta_path</code> (a list of objects for overriding import behaviour). The module it lives in is deleted from <code>sys.modules</code>, but the importer instance is still in <code>sys.meta_path</code> and one of its methods expects to be able to look up global variables still. That method gets called next time <code>mpl_toolkits</code> tries to load some submodules, but that instance sees a global scope where everything is <code>None</code>, and breaks.</p>\n<p>Solution is likely to have <code>ModuleWatcher</code> roll back <code>sys.meta_path</code> the same way it rolls back <code>sys.path</code>. I'll look into it.</p>", "type": "rendered"}, "created_on": "2018-10-24T20:46:04.202386+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-10-24T20:46:38.610521+00:00", "type": "issue_comment", "id": 48545590}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39/comments/48545896.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/39#comment-48545896"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39.json"}}, "type": "issue", "id": 39, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Bug with module watcher reloading when mpl_toolkit used"}, "content": {"raw": "This should be fixed by [labscript_utils pull request 59](#!/labscript_suite/labscript_utils/pull-requests/59/modulewatcher-handle-sysmeta_path-issue-39).", "markup": "markdown", "html": "<p>This should be fixed by <a data-is-external-link=\"true\" href=\"#!/labscript_suite/labscript_utils/pull-requests/59/modulewatcher-handle-sysmeta_path-issue-39\" rel=\"nofollow\">labscript_utils pull request 59</a>.</p>", "type": "rendered"}, "created_on": "2018-10-24T21:12:58.766070+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 48545896}, {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39/comments/52413518.json"}, "html": {"href": "#!/labscript_suite/lyse/issues/39#comment-52413518"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/issues/39.json"}}, "type": "issue", "id": 39, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "title": "Bug with module watcher reloading when mpl_toolkit used"}, "content": {"raw": "", "markup": "markdown", "html": "", "type": "rendered"}, "created_on": "2019-06-03T13:42:51.959697+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": null, "type": "issue_comment", "id": 52413518}], "page": 1, "size": 7}