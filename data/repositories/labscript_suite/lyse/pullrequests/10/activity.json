{"pagelen": 50, "values": [{"update": {"description": "Whenever lyse tries to read a HDF5 file that has been deleted, it\r\npreviously would crash. Now, the shot's row\r\nin the filebox is marked with an icon showing it as deleted off disk\r\nand a warning is printed. No more singleshot analysis will be run on that shot\r\nfile, but its data will be kept in the dataframe until the user removes it\r\nfrom the filebox, and thus still be available for multishot analysis.\r\n\r\nThe use case for this is when an experiment is cycling just to 'keep warm' or\r\nwhatever, and shots are being deleted so as not to consume hard drive space.\r\n\r\nI removed some of the unused optional ways of calling some of lyse's\r\ninternal methods so as to decrease the number of places where\r\nlyse reads a HDF5 file. Previously multiple code paths were allowed - one\r\nwhich was a bit cleaner (reading HDF5 files at the last minute)\r\n and one which was a performance optimisation (read them in advance, outside the\r\n GUI thread, and pass the results to the GUI-related methods). Now only\r\nthe performant way of calling these methods is allowed - which is what all\r\nthe calling code was using anyway.\r\n\r\n![lyse_screenshot.png](https://bitbucket.org/repo/oEX56b/images/107755377-lyse_screenshot.png)", "title": "Make lyse handle gracefully shot files that have been deleted off disk.", "destination": {"commit": {"hash": "f6184e67ecfb", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/f6184e67ecfb.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/f6184e67ecfb"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "0b35e6e97062", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse/commit/0b35e6e97062"}, "html": {"href": "#!/cbillington/lyse/commits/0b35e6e97062"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse"}, "html": {"href": "#!/cbillington/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{47c91022-279d-4058-88a8-959fe9ffb409}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "cbillington/lyse", "uuid": "{47c91022-279d-4058-88a8-959fe9ffb409}"}, "branch": {"name": "feature"}}, "state": "MERGED", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-05-26T17:28:53.709084+00:00"}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"update": {"description": "Whenever lyse tries to read a HDF5 file that has been deleted, it\r\npreviously would crash. Now, the shot's row\r\nin the filebox is marked with an icon showing it as deleted off disk\r\nand a warning is printed. No more singleshot analysis will be run on that shot\r\nfile, but its data will be kept in the dataframe until the user removes it\r\nfrom the filebox, and thus still be available for multishot analysis.\r\n\r\nThe use case for this is when an experiment is cycling just to 'keep warm' or\r\nwhatever, and shots are being deleted so as not to consume hard drive space.\r\n\r\nI removed some of the unused optional ways of calling some of lyse's\r\ninternal methods so as to decrease the number of places where\r\nlyse reads a HDF5 file. Previously multiple code paths were allowed - one\r\nwhich was a bit cleaner (reading HDF5 files at the last minute)\r\n and one which was a performance optimisation (read them in advance, outside the\r\n GUI thread, and pass the results to the GUI-related methods). Now only\r\nthe performant way of calling these methods is allowed - which is what all\r\nthe calling code was using anyway.\r\n\r\n![lyse_screenshot.png](https://bitbucket.org/repo/oEX56b/images/107755377-lyse_screenshot.png)", "title": "Make lyse handle gracefully shot files that have been deleted off disk.", "destination": {"commit": {"hash": "f6184e67ecfb", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/f6184e67ecfb.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/f6184e67ecfb"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "0b35e6e97062", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse/commit/0b35e6e97062"}, "html": {"href": "#!/cbillington/lyse/commits/0b35e6e97062"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse"}, "html": {"href": "#!/cbillington/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{47c91022-279d-4058-88a8-959fe9ffb409}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "cbillington/lyse", "uuid": "{47c91022-279d-4058-88a8-959fe9ffb409}"}, "branch": {"name": "feature"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-05-26T17:28:53.348033+00:00"}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"approval": {"date": "2017-05-23T04:25:20.950554+00:00", "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "user": {"display_name": "Russell Anderson", "uuid": "{6c12ac6e-1980-466d-86fe-6c163bd116c2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D"}, "html": {"href": "https://bitbucket.org/%7B6c12ac6e-1980-466d-86fe-6c163bd116c2%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e/e307ce36-5fb6-4418-8090-b9e533eab225/128"}}, "nickname": "rpanderson", "type": "user", "account_id": "557058:443e4cd1-86c9-4cd5-8034-22bab14d9d1e"}}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37377989.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37377989"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "I guess so, or adding a context menu action to select-all that have been marked as deleted off disk and mark them as not done, or something like that.\n\nBut yes, detecting that shots are deleted only happens when analysis is run on them, so low collision rate. I imagine if we were trying to make our programs function better in the presence of a dodgy network, we would hit other problems first! Such as the fact that a few seconds of downtime of zlock can take down any program.", "markup": "markdown", "html": "<p>I guess so, or adding a context menu action to select-all that have been marked as deleted off disk and mark them as not done, or something like that.</p>\n<p>But yes, detecting that shots are deleted only happens when analysis is run on them, so low collision rate. I imagine if we were trying to make our programs function better in the presence of a dodgy network, we would hit other problems first! Such as the fact that a few seconds of downtime of zlock can take down any program.</p>", "type": "rendered"}, "created_on": "2017-05-23T00:50:55.307998+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-05-23T00:50:55.310908+00:00", "type": "pullrequest_comment", "id": 37377989}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"approval": {"date": "2017-05-23T00:42:44.765873+00:00", "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37377786.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37377786"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "Thanks! We may need to daemonise the checking if it ends up regularly and incorrectly marking shots as deleted (due to network issues), but I guess we'll wait and see. I suppose it only marks them as deleted if you are actually trying to run a single shot analysis at the same time as the network glitch, so the collision rate should be pretty low.", "markup": "markdown", "html": "<p>Thanks! We may need to daemonise the checking if it ends up regularly and incorrectly marking shots as deleted (due to network issues), but I guess we'll wait and see. I suppose it only marks them as deleted if you are actually trying to run a single shot analysis at the same time as the network glitch, so the collision rate should be pretty low.</p>", "type": "rendered"}, "created_on": "2017-05-23T00:42:41.482275+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2017-05-23T00:42:41.484686+00:00", "type": "pullrequest_comment", "id": 37377786}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37377593.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37377593"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "OK done. Shots marked as deleted and then marked as not done by the user will be checked to see if they are accessible once more, and have the 'deleted' status removed if they are.", "markup": "markdown", "html": "<p>OK done. Shots marked as deleted and then marked as not done by the user will be checked to see if they are accessible once more, and have the 'deleted' status removed if they are.</p>", "type": "rendered"}, "created_on": "2017-05-23T00:36:06.786939+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-05-23T00:36:06.789009+00:00", "type": "pullrequest_comment", "id": 37377593}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"update": {"description": "Whenever lyse tries to read a HDF5 file that has been deleted, it\r\npreviously would crash. Now, the shot's row\r\nin the filebox is marked with an icon showing it as deleted off disk\r\nand a warning is printed. No more singleshot analysis will be run on that shot\r\nfile, but its data will be kept in the dataframe until the user removes it\r\nfrom the filebox, and thus still be available for multishot analysis.\r\n\r\nThe use case for this is when an experiment is cycling just to 'keep warm' or\r\nwhatever, and shots are being deleted so as not to consume hard drive space.\r\n\r\nI removed some of the unused optional ways of calling some of lyse's\r\ninternal methods so as to decrease the number of places where\r\nlyse reads a HDF5 file. Previously multiple code paths were allowed - one\r\nwhich was a bit cleaner (reading HDF5 files at the last minute)\r\n and one which was a performance optimisation (read them in advance, outside the\r\n GUI thread, and pass the results to the GUI-related methods). Now only\r\nthe performant way of calling these methods is allowed - which is what all\r\nthe calling code was using anyway.\r\n\r\n![lyse_screenshot.png](https://bitbucket.org/repo/oEX56b/images/107755377-lyse_screenshot.png)", "title": "Make lyse handle gracefully shot files that have been deleted off disk.", "destination": {"commit": {"hash": "f6184e67ecfb", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/f6184e67ecfb.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/f6184e67ecfb"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "0b35e6e97062", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse/commit/0b35e6e97062"}, "html": {"href": "#!/cbillington/lyse/commits/0b35e6e97062"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse"}, "html": {"href": "#!/cbillington/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{47c91022-279d-4058-88a8-959fe9ffb409}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "cbillington/lyse", "uuid": "{47c91022-279d-4058-88a8-959fe9ffb409}"}, "branch": {"name": "feature"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-05-23T00:34:02.306274+00:00"}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37374976.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37374976"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "Ah yes, I see it. Line 1197:\n\n```\n#!python\n-            status_item.setData(0, self.ROLE_STATUS_PERCENT)\n+            # Only mark as not done if it's not deleted off disk:\n+            if not status_item.data(self.ROLE_DELETED_OFF_DISK):\n+                status_item.setData(0, self.ROLE_STATUS_PERCENT)\n```\nCool, I'll make it check if the file is accessible again and mark it as not deleted if so.\n", "markup": "markdown", "html": "<p>Ah yes, I see it. Line 1197:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"o\">-</span>            <span class=\"n\">status_item</span><span class=\"o\">.</span><span class=\"n\">setData</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ROLE_STATUS_PERCENT</span><span class=\"p\">)</span>\n<span class=\"o\">+</span>            <span class=\"c1\"># Only mark as not done if it&#39;s not deleted off disk:</span>\n<span class=\"o\">+</span>            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">status_item</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ROLE_DELETED_OFF_DISK</span><span class=\"p\">):</span>\n<span class=\"o\">+</span>                <span class=\"n\">status_item</span><span class=\"o\">.</span><span class=\"n\">setData</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ROLE_STATUS_PERCENT</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>Cool, I'll make it check if the file is accessible again and mark it as not deleted if so.</p>", "type": "rendered"}, "created_on": "2017-05-22T23:06:40.695246+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-05-22T23:06:40.697715+00:00", "type": "pullrequest_comment", "id": 37374976}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37374765.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37374765"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "Actually, I can't see where I wrote code to do this, I must be misremembering. I'll investigate.", "markup": "markdown", "html": "<p>Actually, I can't see where I wrote code to do this, I must be misremembering. I'll investigate.</p>", "type": "rendered"}, "created_on": "2017-05-22T22:59:26.700769+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-05-22T22:59:26.703226+00:00", "type": "pullrequest_comment", "id": 37374765}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37374637.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37374637"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "Ah, no, I explicitly made it not check the file again after it was found unreadable. How about I make it so that if you mark-as-not-done it checks again if the file exists and marks the file normal if it is once-again readable?", "markup": "markdown", "html": "<p>Ah, no, I explicitly made it not check the file again after it was found unreadable. How about I make it so that if you mark-as-not-done it checks again if the file exists and marks the file normal if it is once-again readable?</p>", "type": "rendered"}, "created_on": "2017-05-22T22:54:54.570363+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-05-22T22:54:54.572734+00:00", "type": "pullrequest_comment", "id": 37374637}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37374504.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37374504"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "Sorry to be a pain, I have one more question.\n\nWhat happens if the shot is detected as being deleted because the network drive went down temporarily? Does the shot become marked as normal again once the network drive is back up? Will this only happen if a singleshot analysis is run on it? I just want to make sure we don't hit a scenario where you have to remove and then re-add the shots into lyse just so it doesn't think they're deleted (it would kind of be a bit confusing for users I think if lyse indicated shots were deleted when they are not).", "markup": "markdown", "html": "<p>Sorry to be a pain, I have one more question.</p>\n<p>What happens if the shot is detected as being deleted because the network drive went down temporarily? Does the shot become marked as normal again once the network drive is back up? Will this only happen if a singleshot analysis is run on it? I just want to make sure we don't hit a scenario where you have to remove and then re-add the shots into lyse just so it doesn't think they're deleted (it would kind of be a bit confusing for users I think if lyse indicated shots were deleted when they are not).</p>", "type": "rendered"}, "created_on": "2017-05-22T22:50:24.888696+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2017-05-22T22:50:24.890759+00:00", "type": "pullrequest_comment", "id": 37374504}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37348855.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37348855"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "No, there is no reason for that - that line was copied from elsewhere and you're right that it is not needed here - we don't need the row index. I've changed it to the more readable check.\n\nI've verified that deleted shots in the middle of the Dataframe are correctly detected as such.\n\nThere's nothing to check about what dataframe analysis scripts receive though, as detecting a shot as deleted does not modify the dataframe, it just marks those rows as not to be subject to singleshot analysis any more. One can still do multishot analysis including the data from deleted shots, and the rows in the dataframe won't be removed until you delete the FileBox entries for the shots as normal. This seems like good behaviour since you can run a shot on repeat all day, delete old shots and still get plots for how things varied over the day (here at NIST we have a feature in BLACS (which I'll be modifying a bit before making a pull request about) that will delete shots not immediately after they run, but some settable number of shots later. So we run in repeat mode with \"number of shots to keep on disk\" equal to 10 or something, meaning there's still time for single shot analysis to run on these shots before they are deleted). ", "markup": "markdown", "html": "<p>No, there is no reason for that - that line was copied from elsewhere and you're right that it is not needed here - we don't need the row index. I've changed it to the more readable check.</p>\n<p>I've verified that deleted shots in the middle of the Dataframe are correctly detected as such.</p>\n<p>There's nothing to check about what dataframe analysis scripts receive though, as detecting a shot as deleted does not modify the dataframe, it just marks those rows as not to be subject to singleshot analysis any more. One can still do multishot analysis including the data from deleted shots, and the rows in the dataframe won't be removed until you delete the FileBox entries for the shots as normal. This seems like good behaviour since you can run a shot on repeat all day, delete old shots and still get plots for how things varied over the day (here at NIST we have a feature in BLACS (which I'll be modifying a bit before making a pull request about) that will delete shots not immediately after they run, but some settable number of shots later. So we run in repeat mode with \"number of shots to keep on disk\" equal to 10 or something, meaning there's still time for single shot analysis to run on these shots before they are deleted). </p>", "type": "rendered"}, "created_on": "2017-05-22T15:16:05.819699+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-05-22T15:26:17.277002+00:00", "type": "pullrequest_comment", "id": 37348855}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"update": {"description": "Whenever lyse tries to read a HDF5 file that has been deleted, it\r\npreviously would crash. Now, the shot's row\r\nin the filebox is marked with an icon showing it as deleted off disk\r\nand a warning is printed. No more singleshot analysis will be run on that shot\r\nfile, but its data will be kept in the dataframe until the user removes it\r\nfrom the filebox, and thus still be available for multishot analysis.\r\n\r\nThe use case for this is when an experiment is cycling just to 'keep warm' or\r\nwhatever, and shots are being deleted so as not to consume hard drive space.\r\n\r\nI removed some of the unused optional ways of calling some of lyse's\r\ninternal methods so as to decrease the number of places where\r\nlyse reads a HDF5 file. Previously multiple code paths were allowed - one\r\nwhich was a bit cleaner (reading HDF5 files at the last minute)\r\n and one which was a performance optimisation (read them in advance, outside the\r\n GUI thread, and pass the results to the GUI-related methods). Now only\r\nthe performant way of calling these methods is allowed - which is what all\r\nthe calling code was using anyway.\r\n\r\n![lyse_screenshot.png](https://bitbucket.org/repo/oEX56b/images/107755377-lyse_screenshot.png)", "title": "Make lyse handle gracefully shot files that have been deleted off disk.", "destination": {"commit": {"hash": "f6184e67ecfb", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/f6184e67ecfb.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/f6184e67ecfb"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "2d42df91a117", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse/commit/2d42df91a117"}, "html": {"href": "#!/cbillington/lyse/commits/2d42df91a117"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse"}, "html": {"href": "#!/cbillington/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{47c91022-279d-4058-88a8-959fe9ffb409}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "cbillington/lyse", "uuid": "{47c91022-279d-4058-88a8-959fe9ffb409}"}, "branch": {"name": "feature"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-05-22T15:16:03.500032+00:00"}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37294795.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37294795"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "Couple of questions:\n\n1. is there a reason line 1259 (`np.where(self.dataframe['filepath'].values == filepath)[0][0]`) is not just `if filepath in self.dataframe['filepath'].values`? I'm reasonably certain the latter is slightly faster and is definitely clearer to read.\n2. Your screenshot only shows deletion of shots that are at the start of the dataframe. Could you confirm it works as expected when deleting shots that exist in the middle of the dataframe (and that the analysis scripts then still get the correct dataframe - aka the correct row of the dataframe was removed in this case)\n", "markup": "markdown", "html": "<p>Couple of questions:</p>\n<ol>\n<li>is there a reason line 1259 (<code>np.where(self.dataframe['filepath'].values == filepath)[0][0]</code>) is not just <code>if filepath in self.dataframe['filepath'].values</code>? I'm reasonably certain the latter is slightly faster and is definitely clearer to read.</li>\n<li>Your screenshot only shows deletion of shots that are at the start of the dataframe. Could you confirm it works as expected when deleting shots that exist in the middle of the dataframe (and that the analysis scripts then still get the correct dataframe - aka the correct row of the dataframe was removed in this case)</li>\n</ol>", "type": "rendered"}, "created_on": "2017-05-21T23:43:39.694482+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2017-05-21T23:43:39.697488+00:00", "type": "pullrequest_comment", "id": 37294795}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10/comments/37265851.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10/_/diff#comment-37265851"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}, "content": {"raw": "If there are no objections, could this be merged?", "markup": "markdown", "html": "<p>If there are no objections, could this be merged?</p>", "type": "rendered"}, "created_on": "2017-05-19T18:08:53.585627+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-05-19T18:08:53.588056+00:00", "type": "pullrequest_comment", "id": 37265851}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"update": {"description": "Whenever lyse tries to read a HDF5 file that has been deleted, it\r\npreviously would crash. Now, the shot's row\r\nin the filebox is marked with an icon showing it as deleted off disk\r\nand a warning is printed. No more singleshot analysis will be run on that shot\r\nfile, but its data will be kept in the dataframe until the user removes it\r\nfrom the filebox, and thus still be available for multishot analysis.\r\n\r\nThe use case for this is when an experiment is cycling just to 'keep warm' or\r\nwhatever, and shots are being deleted so as not to consume hard drive space.\r\n\r\nI removed some of the unused optional ways of calling some of lyse's\r\ninternal methods so as to decrease the number of places where\r\nlyse reads a HDF5 file. Previously multiple code paths were allowed - one\r\nwhich was a bit cleaner (reading HDF5 files at the last minute)\r\n and one which was a performance optimisation (read them in advance, outside the\r\n GUI thread, and pass the results to the GUI-related methods). Now only\r\nthe performant way of calling these methods is allowed - which is what all\r\nthe calling code was using anyway.\r\n\r\n![lyse_screenshot.png](https://bitbucket.org/repo/oEX56b/images/107755377-lyse_screenshot.png)", "title": "Make lyse handle gracefully shot files that have been deleted off disk.", "destination": {"commit": {"hash": "c4908e5d0a94", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/c4908e5d0a94.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/c4908e5d0a94"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "c664a54cb6da", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse/commit/c664a54cb6da"}, "html": {"href": "#!/cbillington/lyse/commits/c664a54cb6da"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse"}, "html": {"href": "#!/cbillington/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{47c91022-279d-4058-88a8-959fe9ffb409}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "cbillington/lyse", "uuid": "{47c91022-279d-4058-88a8-959fe9ffb409}"}, "branch": {"name": "feature"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-04-12T01:46:36.270820+00:00"}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"update": {"description": "Whenever lyse tries to read a HDF5 file that has been deleted, it\r\npreviously would crash. Now, the shot's row\r\nin the filebox is marked with an icon showing it as deleted off disk\r\nand a warning is printed. No more singleshot analysis will be run on that shot\r\nfile, but its data will be kept in the dataframe until the user removes it\r\nfrom the filebox, and thus still be available for multishot analysis.\r\n\r\nThe use case for this is when an experiment is cycling just to 'keep warm' or\r\nwhatever, and shots are being deleted so as not to consume hard drive space.\r\n\r\nI removed some of the unused optional ways of calling some of lyse's\r\ninternal methods so as to decrease the number of places where\r\nlyse reads a HDF5 file. Previously multiple code paths were allowed - one\r\nwhich was a bit cleaner (reading HDF5 files at the last minute)\r\n and one which was a performance optimisation (read them in advance, outside the\r\n GUI thread, and pass the results to the GUI-related methods). Now only\r\nthe performant way of calling these methods is allowed - which is what all\r\nthe calling code was using anyway.\r\n\r\n![lyse_screenshot.png](https://bitbucket.org/repo/oEX56b/images/107755377-lyse_screenshot.png)", "title": "Make lyse handle gracefully shot files that have been deleted off disk.", "destination": {"commit": {"hash": "c4908e5d0a94", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/c4908e5d0a94.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/c4908e5d0a94"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a252f823dc33", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse/commit/a252f823dc33"}, "html": {"href": "#!/cbillington/lyse/commits/a252f823dc33"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse"}, "html": {"href": "#!/cbillington/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{47c91022-279d-4058-88a8-959fe9ffb409}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "cbillington/lyse", "uuid": "{47c91022-279d-4058-88a8-959fe9ffb409}"}, "branch": {"name": "feature"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-04-11T21:46:34.052259+00:00"}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}, {"update": {"description": "Whenever lyse tries to read a HDF5 file that has been deleted, it\r\npreviously would crash. Now, the shot's row\r\nin the filebox is marked with an icon showing it as deleted off disk\r\nand a warning is printed. No more singleshot analysis will be run on that shot\r\nfile, but its data will be kept in the dataframe until the user removes it\r\nfrom the filebox, and thus still be available for multishot analysis.\r\n\r\nThe use case for this is when an experiment is cycling just to 'keep warm' or\r\nwhatever, and shots are being deleted so as not to consume hard drive space.\r\n\r\nI removed some of the unused optional ways of calling some of lyse's\r\ninternal methods so as to decrease the number of places where\r\nlyse reads a HDF5 file. Previously multiple code paths were allowed - one\r\nwhich was a bit cleaner (reading HDF5 files at the last minute)\r\n and one which was a performance optimisation (read them in advance, outside the\r\n GUI thread, and pass the results to the GUI-related methods). Now only\r\nthe performant way of calling these methods is allowed - which is what all\r\nthe calling code was using anyway.\r\n\r\n![lyse_screenshot.png](https://bitbucket.org/repo/oEX56b/images/107755377-lyse_screenshot.png)", "title": "Make lyse handle gracefully shot files that have been deleted off disk.", "destination": {"commit": {"hash": "c4908e5d0a94", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/c4908e5d0a94.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/c4908e5d0a94"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a252f823dc33", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse/commit/a252f823dc33"}, "html": {"href": "#!/cbillington/lyse/commits/a252f823dc33"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/cbillington/lyse"}, "html": {"href": "#!/cbillington/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{47c91022-279d-4058-88a8-959fe9ffb409}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "cbillington/lyse", "uuid": "{47c91022-279d-4058-88a8-959fe9ffb409}"}, "branch": {"name": "feature"}}, "state": "OPEN", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "date": "2017-04-11T21:46:34.002366+00:00"}, "pull_request": {"type": "pullrequest", "id": 10, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/10.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/10"}}, "title": "Make lyse handle gracefully shot files that have been deleted off disk."}}]}