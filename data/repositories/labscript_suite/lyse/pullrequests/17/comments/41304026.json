{"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/17/comments/41304026.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/17/_/diff#comment-41304026"}}, "parent": {"id": 41101296, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/17/comments/41101296.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/17/_/diff#comment-41101296"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 17, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/17.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/17"}}, "title": "Update Dataframe without Readoperations"}, "content": {"raw": "I don't use BIAS, actually. But I probably have some shot files somewhere that are from Monash (or I know enough to fake them), so I will see if I can reproduce it and whether the proposed fix works.\n\nAlso for consistency with only bytestrings being used as column labels, since lyse converts them all to bytestrings when it reads from the HDF5 file, the following line:\n\n`_updated_data[self.h5_path][self.group, name] = value`\n\nshould be changed to\n\n`_updated_data[self.h5_path][str(self.group), name] = value`\n\nTo ensure the group name is a bytestrings (I see in shaun's tracebacks that it's a unicode string `u'test'`). It's also possible that this could have something to do with the bug, since reading the existing column from the dataframe would result in bytestring column labels whereas your updating method is looking for unicode string column labels. I would think that they would be treated the same (in python 2 `u'x' == b'x'` is True, but in Python 3 it's False), but you never know.\n\nSo I know that's not ideal, but we can convert all of lyse's column labels to unicode strings in a different pull request, and consistency is better for now.", "markup": "markdown", "html": "<p>I don't use BIAS, actually. But I probably have some shot files somewhere that are from Monash (or I know enough to fake them), so I will see if I can reproduce it and whether the proposed fix works.</p>\n<p>Also for consistency with only bytestrings being used as column labels, since lyse converts them all to bytestrings when it reads from the HDF5 file, the following line:</p>\n<p><code>_updated_data[self.h5_path][self.group, name] = value</code></p>\n<p>should be changed to</p>\n<p><code>_updated_data[self.h5_path][str(self.group), name] = value</code></p>\n<p>To ensure the group name is a bytestrings (I see in shaun's tracebacks that it's a unicode string <code>u'test'</code>). It's also possible that this could have something to do with the bug, since reading the existing column from the dataframe would result in bytestring column labels whereas your updating method is looking for unicode string column labels. I would think that they would be treated the same (in python 2 <code>u'x' == b'x'</code> is True, but in Python 3 it's False), but you never know.</p>\n<p>So I know that's not ideal, but we can convert all of lyse's column labels to unicode strings in a different pull request, and consistency is better for now.</p>", "type": "rendered"}, "created_on": "2017-07-23T22:35:38.120061+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2017-07-23T22:35:38.123344+00:00", "type": "pullrequest_comment", "id": 41304026}