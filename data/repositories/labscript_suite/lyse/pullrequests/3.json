{"rendered": {"description": {"raw": "**Fix for issue #16, wrong execution order of routines after reordering with GUI buttons:**\r\n\r\nProblem was confusing a passive transformation with an active transformation when reordering a list:\r\n\r\npassive transformation: constructing a new list from a list of indices saying where in the old list each item should come from (what we were doing)\r\n\r\nactive transformation: constructing a new list out of a list of indices for where in the new list items in the old list should be moved to (what we should have been doing)\r\n\r\nWhen a single routine was moved, this simply swapped it with the one above or below it and so a passive and active transformation of the order were identical, so we didn't notice a problem. But for reordering multiple routines at once it gave the wrong result.\r\n\r\nThe GUI reordering was done with an active transformation as required, but the list used to determine the execution order was erroneously using a passive transformation which is now fixed.\r\n\r\n\r\n**Fix for issue #17, slow dataframe transfers:**\r\n\r\n\r\nMoved call to `df.convert_objects()` to the lyse server, which makes dataframes more\r\nefficiently picklable by replacing columns containing only a single array datatype\r\nwith an array of that datatype. Previously `df.convert_obects()` was only called\r\nafter the transfer, so the preceding pickling was slow.\r\n\r\nFor the large, mostly numeric dataframe tested, this speeds\r\nup pickling and unpickling by approx a factor of 5.\r\n\r\nAlso set `convert_numeric=False` in the call to `df.convert_objects()`. It was\r\npreviously set to `True`, but I don't think this is what we want. With it `False`,\r\nall-numeric columns are still converted as desired. With it `True`, *strings* are\r\nconverted to numbers even if only a single string is convertible to a numeric\r\nvalue, with all non-convertable values in the column becoming NaNs. I don't\r\nthink this is what we want. If the user asked for a string, the data should\r\nremain a string. It is presumptuous to assume otherwise and I suspect a\r\nmisunderstanding by whoever wrote this line originally.", "markup": "markdown", "html": "<p><strong>Fix for issue <a href=\"#!/labscript_suite/lyse/issues/16/multi-shot-routines-run-out-of-order\" rel=\"nofollow\" title=\"Multi-shot routines run out of order\" class=\"ap-connect-link\"><s>#16</s></a>, wrong execution order of routines after reordering with GUI buttons:</strong></p>\n<p>Problem was confusing a passive transformation with an active transformation when reordering a list:</p>\n<p>passive transformation: constructing a new list from a list of indices saying where in the old list each item should come from (what we were doing)</p>\n<p>active transformation: constructing a new list out of a list of indices for where in the new list items in the old list should be moved to (what we should have been doing)</p>\n<p>When a single routine was moved, this simply swapped it with the one above or below it and so a passive and active transformation of the order were identical, so we didn't notice a problem. But for reordering multiple routines at once it gave the wrong result.</p>\n<p>The GUI reordering was done with an active transformation as required, but the list used to determine the execution order was erroneously using a passive transformation which is now fixed.</p>\n<p><strong>Fix for issue <a href=\"#!/labscript_suite/lyse/issues/17/main-interface-is-slow-unresponsive-when\" rel=\"nofollow\" title=\"Main interface is slow/unresponsive when multi-shot routines are running\" class=\"ap-connect-link\"><s>#17</s></a>, slow dataframe transfers:</strong></p>\n<p>Moved call to <code>df.convert_objects()</code> to the lyse server, which makes dataframes more\nefficiently picklable by replacing columns containing only a single array datatype\nwith an array of that datatype. Previously <code>df.convert_obects()</code> was only called\nafter the transfer, so the preceding pickling was slow.</p>\n<p>For the large, mostly numeric dataframe tested, this speeds\nup pickling and unpickling by approx a factor of 5.</p>\n<p>Also set <code>convert_numeric=False</code> in the call to <code>df.convert_objects()</code>. It was\npreviously set to <code>True</code>, but I don't think this is what we want. With it <code>False</code>,\nall-numeric columns are still converted as desired. With it <code>True</code>, <em>strings</em> are\nconverted to numbers even if only a single string is convertible to a numeric\nvalue, with all non-convertable values in the column becoming NaNs. I don't\nthink this is what we want. If the user asked for a string, the data should\nremain a string. It is presumptuous to assume otherwise and I suspect a\nmisunderstanding by whoever wrote this line originally.</p>", "type": "rendered"}, "title": {"raw": "Fixes #16 and #17", "markup": "markdown", "html": "<p>Fixes <a href=\"#!/labscript_suite/lyse/issues/16/multi-shot-routines-run-out-of-order\" rel=\"nofollow\" title=\"Multi-shot routines run out of order\" class=\"ap-connect-link\"><s>#16</s></a> and <a href=\"#!/labscript_suite/lyse/issues/17/main-interface-is-slow-unresponsive-when\" rel=\"nofollow\" title=\"Main interface is slow/unresponsive when multi-shot routines are running\" class=\"ap-connect-link\"><s>#17</s></a></p>", "type": "rendered"}}, "type": "pullrequest", "description": "**Fix for issue #16, wrong execution order of routines after reordering with GUI buttons:**\r\n\r\nProblem was confusing a passive transformation with an active transformation when reordering a list:\r\n\r\npassive transformation: constructing a new list from a list of indices saying where in the old list each item should come from (what we were doing)\r\n\r\nactive transformation: constructing a new list out of a list of indices for where in the new list items in the old list should be moved to (what we should have been doing)\r\n\r\nWhen a single routine was moved, this simply swapped it with the one above or below it and so a passive and active transformation of the order were identical, so we didn't notice a problem. But for reordering multiple routines at once it gave the wrong result.\r\n\r\nThe GUI reordering was done with an active transformation as required, but the list used to determine the execution order was erroneously using a passive transformation which is now fixed.\r\n\r\n\r\n**Fix for issue #17, slow dataframe transfers:**\r\n\r\n\r\nMoved call to `df.convert_objects()` to the lyse server, which makes dataframes more\r\nefficiently picklable by replacing columns containing only a single array datatype\r\nwith an array of that datatype. Previously `df.convert_obects()` was only called\r\nafter the transfer, so the preceding pickling was slow.\r\n\r\nFor the large, mostly numeric dataframe tested, this speeds\r\nup pickling and unpickling by approx a factor of 5.\r\n\r\nAlso set `convert_numeric=False` in the call to `df.convert_objects()`. It was\r\npreviously set to `True`, but I don't think this is what we want. With it `False`,\r\nall-numeric columns are still converted as desired. With it `True`, *strings* are\r\nconverted to numbers even if only a single string is convertible to a numeric\r\nvalue, with all non-convertable values in the column becoming NaNs. I don't\r\nthink this is what we want. If the user asked for a string, the data should\r\nremain a string. It is presumptuous to assume otherwise and I suspect a\r\nmisunderstanding by whoever wrote this line originally.", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/pullrequests/3/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/diffstat/labscript_suite/lyse:c8342f48860c%0D7e2ccc7c66c3?from_pullrequest_id=3"}, "commits": {"href": "data/repositories/labscript_suite/lyse/pullrequests/3/commits.json"}, "self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/3.json"}, "comments": {"href": "data/repositories/labscript_suite/lyse/pullrequests/3/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/pullrequests/3/merge"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/3"}, "activity": {"href": "data/repositories/labscript_suite/lyse/pullrequests/3/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/diff/labscript_suite/lyse:c8342f48860c%0D7e2ccc7c66c3?from_pullrequest_id=3"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/pullrequests/3/approve"}, "statuses": {"href": "data/repositories/labscript_suite/lyse/pullrequests/3/statuses_page=1.json"}}, "title": "Fixes #16 and #17", "close_source_branch": false, "reviewers": [{"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}], "id": 3, "destination": {"commit": {"hash": "7e2ccc7c66c3", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/7e2ccc7c66c3.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/7e2ccc7c66c3"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "created_on": "2015-07-28T07:06:34.743712+00:00", "summary": {"raw": "**Fix for issue #16, wrong execution order of routines after reordering with GUI buttons:**\r\n\r\nProblem was confusing a passive transformation with an active transformation when reordering a list:\r\n\r\npassive transformation: constructing a new list from a list of indices saying where in the old list each item should come from (what we were doing)\r\n\r\nactive transformation: constructing a new list out of a list of indices for where in the new list items in the old list should be moved to (what we should have been doing)\r\n\r\nWhen a single routine was moved, this simply swapped it with the one above or below it and so a passive and active transformation of the order were identical, so we didn't notice a problem. But for reordering multiple routines at once it gave the wrong result.\r\n\r\nThe GUI reordering was done with an active transformation as required, but the list used to determine the execution order was erroneously using a passive transformation which is now fixed.\r\n\r\n\r\n**Fix for issue #17, slow dataframe transfers:**\r\n\r\n\r\nMoved call to `df.convert_objects()` to the lyse server, which makes dataframes more\r\nefficiently picklable by replacing columns containing only a single array datatype\r\nwith an array of that datatype. Previously `df.convert_obects()` was only called\r\nafter the transfer, so the preceding pickling was slow.\r\n\r\nFor the large, mostly numeric dataframe tested, this speeds\r\nup pickling and unpickling by approx a factor of 5.\r\n\r\nAlso set `convert_numeric=False` in the call to `df.convert_objects()`. It was\r\npreviously set to `True`, but I don't think this is what we want. With it `False`,\r\nall-numeric columns are still converted as desired. With it `True`, *strings* are\r\nconverted to numbers even if only a single string is convertible to a numeric\r\nvalue, with all non-convertable values in the column becoming NaNs. I don't\r\nthink this is what we want. If the user asked for a string, the data should\r\nremain a string. It is presumptuous to assume otherwise and I suspect a\r\nmisunderstanding by whoever wrote this line originally.", "markup": "markdown", "html": "<p><strong>Fix for issue <a href=\"#!/labscript_suite/lyse/issues/16/multi-shot-routines-run-out-of-order\" rel=\"nofollow\" title=\"Multi-shot routines run out of order\" class=\"ap-connect-link\"><s>#16</s></a>, wrong execution order of routines after reordering with GUI buttons:</strong></p>\n<p>Problem was confusing a passive transformation with an active transformation when reordering a list:</p>\n<p>passive transformation: constructing a new list from a list of indices saying where in the old list each item should come from (what we were doing)</p>\n<p>active transformation: constructing a new list out of a list of indices for where in the new list items in the old list should be moved to (what we should have been doing)</p>\n<p>When a single routine was moved, this simply swapped it with the one above or below it and so a passive and active transformation of the order were identical, so we didn't notice a problem. But for reordering multiple routines at once it gave the wrong result.</p>\n<p>The GUI reordering was done with an active transformation as required, but the list used to determine the execution order was erroneously using a passive transformation which is now fixed.</p>\n<p><strong>Fix for issue <a href=\"#!/labscript_suite/lyse/issues/17/main-interface-is-slow-unresponsive-when\" rel=\"nofollow\" title=\"Main interface is slow/unresponsive when multi-shot routines are running\" class=\"ap-connect-link\"><s>#17</s></a>, slow dataframe transfers:</strong></p>\n<p>Moved call to <code>df.convert_objects()</code> to the lyse server, which makes dataframes more\nefficiently picklable by replacing columns containing only a single array datatype\nwith an array of that datatype. Previously <code>df.convert_obects()</code> was only called\nafter the transfer, so the preceding pickling was slow.</p>\n<p>For the large, mostly numeric dataframe tested, this speeds\nup pickling and unpickling by approx a factor of 5.</p>\n<p>Also set <code>convert_numeric=False</code> in the call to <code>df.convert_objects()</code>. It was\npreviously set to <code>True</code>, but I don't think this is what we want. With it <code>False</code>,\nall-numeric columns are still converted as desired. With it <code>True</code>, <em>strings</em> are\nconverted to numbers even if only a single string is convertible to a numeric\nvalue, with all non-convertable values in the column becoming NaNs. I don't\nthink this is what we want. If the user asked for a string, the data should\nremain a string. It is presumptuous to assume otherwise and I suspect a\nmisunderstanding by whoever wrote this line originally.</p>", "type": "rendered"}, "source": {"commit": {"hash": "7e7c56c7fc4c", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashkrb/lyse/commit/7e7c56c7fc4c"}, "html": {"href": "#!/monashkrb/lyse/commits/7e7c56c7fc4c"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/monashkrb/lyse"}, "html": {"href": "#!/monashkrb/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{4ad93bc7-ea3c-4386-833a-9f321a894870}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "monashkrb/lyse", "uuid": "{4ad93bc7-ea3c-4386-833a-9f321a894870}"}, "branch": {"name": "default"}}, "comment_count": 0, "state": "MERGED", "task_count": 0, "participants": [{"role": "REVIEWER", "participated_on": null, "type": "participant", "approved": false, "user": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}}], "reason": "", "updated_on": "2016-02-08T01:33:27.015125+00:00", "author": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "merge_commit": {"hash": "c8342f48860c", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/c8342f48860c.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/c8342f48860c"}}}, "closed_by": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}}