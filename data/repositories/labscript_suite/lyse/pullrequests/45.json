{"rendered": {"description": {"raw": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "markup": "markdown", "html": "<p>This allows you to provide custom behaviour in plot windows (such as additional actions)</p>\n<p>Use <code>lyse.register_plot_class(identifier, cls)</code> to register a class for lyse to use when creating window for <code>figure(identifier)</code>, where cls must be a subclass of <code>lyse.Plot</code> (which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis_subprocess)</p>\n<p>Currently we do not support changing the class from one run of the script to the next, without restarting the worker process (as that would require re-instantiating the plot which has a large number of problems). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default <code>Plot</code> class is used and message is printed in the lyse terminal.</p>\n<p>I also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via <code>lyse.plots</code>, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.</p>\n<p>Finally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances (if they use <code>lyse.register_plot_class()</code>)</p>\n<p>This was motivated by the vortex research Shaun did for his thesis, for which he directly modified the <code>Plot</code> class to implement custom functionality.</p>\n<p><strong>Update</strong></p>\n<p>Also added a threading.Event to delay the return of results to lyse if the user requests it.</p>\n<p>This allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar (which could be the result of user interaction with the plot) and then return the results to lyse (for example either on a button click, or after a timeout, or whatever you like!)</p>\n<p>To use, call `lyse.delay_results_return()` at the end of your script.<br />\nResults will then only be returned to lyse (so lyse will be stuck waiting for your analysis script to complete) until `lyse.delay_event.set()` is called (through some event ultimately processed by the Qt event loop).</p>", "type": "rendered"}, "title": {"raw": "Added the ability for analysis scripts to register a custom Plot class", "markup": "markdown", "html": "<p>Added the ability for analysis scripts to register a custom Plot class</p>", "type": "rendered"}}, "type": "pullrequest", "description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/pullrequests/45/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/diffstat/labscript_suite/lyse:c94b027c6994%0De652c2de1a31?from_pullrequest_id=45"}, "commits": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/commits.json"}, "self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "comments": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/pullrequests/45/merge"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}, "activity": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/diff/labscript_suite/lyse:c94b027c6994%0De652c2de1a31?from_pullrequest_id=45"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/lyse/pullrequests/45/approve"}, "statuses": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/statuses_page=1.json"}}, "title": "Added the ability for analysis scripts to register a custom Plot class", "close_source_branch": true, "reviewers": [{"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}], "id": 45, "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "created_on": "2018-10-19T06:21:51.419755+00:00", "summary": {"raw": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "markup": "markdown", "html": "<p>This allows you to provide custom behaviour in plot windows (such as additional actions)</p>\n<p>Use <code>lyse.register_plot_class(identifier, cls)</code> to register a class for lyse to use when creating window for <code>figure(identifier)</code>, where cls must be a subclass of <code>lyse.Plot</code> (which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis_subprocess)</p>\n<p>Currently we do not support changing the class from one run of the script to the next, without restarting the worker process (as that would require re-instantiating the plot which has a large number of problems). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default <code>Plot</code> class is used and message is printed in the lyse terminal.</p>\n<p>I also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via <code>lyse.plots</code>, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.</p>\n<p>Finally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances (if they use <code>lyse.register_plot_class()</code>)</p>\n<p>This was motivated by the vortex research Shaun did for his thesis, for which he directly modified the <code>Plot</code> class to implement custom functionality.</p>\n<p><strong>Update</strong></p>\n<p>Also added a threading.Event to delay the return of results to lyse if the user requests it.</p>\n<p>This allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar (which could be the result of user interaction with the plot) and then return the results to lyse (for example either on a button click, or after a timeout, or whatever you like!)</p>\n<p>To use, call `lyse.delay_results_return()` at the end of your script.<br />\nResults will then only be returned to lyse (so lyse will be stuck waiting for your analysis script to complete) until `lyse.delay_event.set()` is called (through some event ultimately processed by the Qt event loop).</p>", "type": "rendered"}, "source": {"commit": {"hash": "a33f3d6b6036", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/a33f3d6b6036"}, "html": {"href": "#!/pstarkey/lyse/commits/a33f3d6b6036"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "comment_count": 10, "state": "MERGED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2018-10-26T02:57:37.074779+00:00", "type": "participant", "approved": false, "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}}, {"role": "REVIEWER", "participated_on": "2018-10-25T22:00:11.138244+00:00", "type": "participant", "approved": false, "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}}, {"role": "REVIEWER", "participated_on": "2018-11-01T23:23:09.336454+00:00", "type": "participant", "approved": true, "user": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}}], "reason": "", "updated_on": "2018-11-02T02:59:36.429526+00:00", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "merge_commit": {"hash": "c94b027c6994", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/c94b027c6994.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/c94b027c6994"}}}, "closed_by": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}}