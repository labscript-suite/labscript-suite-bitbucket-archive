{"pagelen": 50, "values": [{"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a33f3d6b6036", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/a33f3d6b6036"}, "html": {"href": "#!/pstarkey/lyse/commits/a33f3d6b6036"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "MERGED", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-11-02T02:59:36.441480+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a33f3d6b6036", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/a33f3d6b6036"}, "html": {"href": "#!/pstarkey/lyse/commits/a33f3d6b6036"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-11-02T02:59:35.703136+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"approval": {"date": "2018-11-01T23:23:09.336454+00:00", "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "user": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80391916.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80391916"}}, "parent": {"id": 80380408, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80380408.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80380408"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "Also, the code for the fix has changed so that the figure is stored only if it was actually produced and exists. This stops crashed code from causing a hidden, empty figure from being created which was then dictating the figure size for future runs of the script \\(unless you closed the plot window explicity\\), which meant that figures sizes in code were not always respected even on the first successful run.\n\nWe need to do something more comprehensive about figure sizes \\(preferably add a button to lock \\(reset on next run\\) figure sizes based no the specifications in the code. This is really easy to do \\(the `self.update_window_size()` method is already there\\), the main sticking point is finding an appropriate icon :stuck_out_tongue: ", "markup": "markdown", "html": "<p>Also, the code for the fix has changed so that the figure is stored only if it was actually produced and exists. This stops crashed code from causing a hidden, empty figure from being created which was then dictating the figure size for future runs of the script (unless you closed the plot window explicity), which meant that figures sizes in code were not always respected even on the first successful run.</p>\n<p>We need to do something more comprehensive about figure sizes (preferably add a button to lock (reset on next run) figure sizes based no the specifications in the code. This is really easy to do (the <code>self.update_window_size()</code> method is already there), the main sticking point is finding an appropriate icon <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f61b.png\" alt=\"\ud83d\ude1b\" title=\":stuck_out_tongue:\" data-emoji-short-name=\":stuck_out_tongue:\" /> </p>", "type": "rendered"}, "created_on": "2018-10-26T02:57:37.064112+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2018-10-26T02:57:37.074779+00:00", "type": "pullrequest_comment", "id": 80391916}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a33f3d6b6036", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/a33f3d6b6036"}, "html": {"href": "#!/pstarkey/lyse/commits/a33f3d6b6036"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-26T02:26:00.496101+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80381946.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80381946"}}, "parent": {"id": 80378485, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80378485.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80378485"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "I\u2019ve fixed the long lines now", "markup": "markdown", "html": "<p>I\u2019ve fixed the long lines now</p>", "type": "rendered"}, "created_on": "2018-10-25T22:53:47.088591+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2018-10-25T22:53:47.097698+00:00", "type": "pullrequest_comment", "id": 80381946}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "63217a23b0ca", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/63217a23b0ca"}, "html": {"href": "#!/pstarkey/lyse/commits/63217a23b0ca"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-25T22:36:53.680862+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80380408.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80380408"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "@cbillington I\u2019ve updated this to include a compatible fix along the lines of pull request #47. It fixes most cases, but there was one case which I couldn\u2019t resolve so I have it printing a warning instead.\n\nThe case I couldn\u2019t fix was when your plotting script switches from:\n\n    figure(\"asd\")\n    plot(x,y)\n    figure(2)\n    plot(y,x)\n\nto\n\n    plot(x,y)\n    figure(1)\n    plot(y,x)\n\nRe-running the script for a second time after the change does resolve it though, which the warning tells you to do \\(or to just always explicitly call figure\\(\\)", "markup": "markdown", "html": "<p>@cbillington I\u2019ve updated this to include a compatible fix along the lines of <a href=\"#!/labscript_suite/lyse/pull-requests/47/bugfix-for-plots-not-showing-without\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #47</a>. It fixes most cases, but there was one case which I couldn\u2019t resolve so I have it printing a warning instead.</p>\n<p>The case I couldn\u2019t fix was when your plotting script switches from:</p>\n<div class=\"codehilite\"><pre><span></span>figure(&quot;asd&quot;)\nplot(x,y)\nfigure(2)\nplot(y,x)\n</pre></div>\n\n\n<p>to</p>\n<div class=\"codehilite\"><pre><span></span>plot(x,y)\nfigure(1)\nplot(y,x)\n</pre></div>\n\n\n<p>Re-running the script for a second time after the change does resolve it though, which the warning tells you to do (or to just always explicitly call figure()</p>", "type": "rendered"}, "created_on": "2018-10-25T22:30:12.918648+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2018-10-25T22:30:12.935009+00:00", "type": "pullrequest_comment", "id": 80380408}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "1f1b021ed40f", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/1f1b021ed40f"}, "html": {"href": "#!/pstarkey/lyse/commits/1f1b021ed40f"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-25T22:26:50.812039+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80378485.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80378485"}}, "parent": {"id": 80247992, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80247992.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80247992"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "There are a couple of long lines still, line 500 and 510 of analysis_subprocess.py.\n\nI'll look over the commit message!", "markup": "markdown", "html": "<p>There are a couple of long lines still, line 500 and 510 of analysis_subprocess.py.</p>\n<p>I'll look over the commit message!</p>", "type": "rendered"}, "created_on": "2018-10-25T22:00:11.127369+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-10-25T22:00:11.138244+00:00", "type": "pullrequest_comment", "id": 80378485}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80249130.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80249130"}}, "parent": {"id": 80248076, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80248076.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80248076"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "Pretty much. You need to make a few minor changes \\(I\u2019ve changed the call signature of `Plot.analysis_complete()` and you should avoid using `clf()`\\). I emailed you about them :slight_smile: but let me know if you find something I\u2019ve missed.", "markup": "markdown", "html": "<p>Pretty much. You need to make a few minor changes (I\u2019ve changed the call signature of <code>Plot.analysis_complete()</code> and you should avoid using <code>clf()</code>). I emailed you about them <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f642.png\" alt=\"\ud83d\ude42\" title=\":slight_smile:\" data-emoji-short-name=\":slight_smile:\" /> but let me know if you find something I\u2019ve missed.</p>", "type": "rendered"}, "created_on": "2018-10-25T05:21:02.850496+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2018-10-25T05:21:02.864665+00:00", "type": "pullrequest_comment", "id": 80249130}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80248076.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80248076"}}, "parent": {"id": 80247992, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80247992.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80247992"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "I assume that you have tested this with essentially the same code that I\u2019m working on at the moment, but I will try to pull the latest versions and do a full test here tomorrow \\(I\u2019ve un-approved for now until I\u2019ve tested!\\)", "markup": "markdown", "html": "<p>I assume that you have tested this with essentially the same code that I\u2019m working on at the moment, but I will try to pull the latest versions and do a full test here tomorrow (I\u2019ve un-approved for now until I\u2019ve tested!)</p>", "type": "rendered"}, "created_on": "2018-10-25T05:00:53.685653+00:00", "user": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}, "updated_on": "2018-10-25T05:00:53.697068+00:00", "type": "pullrequest_comment", "id": 80248076}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80247992.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80247992"}}, "parent": {"id": 80187162, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80187162.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80187162"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "Thanks for the feedback, I\u2019ve fixed the things you\u2019ve raised!\n\nIn further testing I\u2019ve fixed a bunch of other things to do with how we manage figures, in order to bring the behaviour more in line with how you would expect it to behave when used from a terminal. A description of everything I\u2019ve changed in in the last commit message \\(there is also some more in the one before that if you haven\u2019t seen it\u2026can\u2019t remember how much Bitbucket includes in email notifications\\). You might want to look over it to make sure it doesn\u2019t break any of your original intentions.\n\nI\u2019ll be merging Monday or Tuesday I think unless Shaun needs it merged sooner.", "markup": "markdown", "html": "<p>Thanks for the feedback, I\u2019ve fixed the things you\u2019ve raised!</p>\n<p>In further testing I\u2019ve fixed a bunch of other things to do with how we manage figures, in order to bring the behaviour more in line with how you would expect it to behave when used from a terminal. A description of everything I\u2019ve changed in in the last commit message (there is also some more in the one before that if you haven\u2019t seen it\u2026can\u2019t remember how much Bitbucket includes in email notifications). You might want to look over it to make sure it doesn\u2019t break any of your original intentions.</p>\n<p>I\u2019ll be merging Monday or Tuesday I think unless Shaun needs it merged sooner.</p>", "type": "rendered"}, "created_on": "2018-10-25T04:58:48.107328+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2018-10-25T04:58:48.116121+00:00", "type": "pullrequest_comment", "id": 80247992}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "16b11ef93019", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/16b11ef93019"}, "html": {"href": "#!/pstarkey/lyse/commits/16b11ef93019"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-25T04:55:08.053386+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/80187162.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-80187162"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "This is fine, although I'm not familiar with how it's being used I'm happy to take your word for it.\n\nOn matters of style though, I'd rather not merge commented-out code such as `__init__.py`, line 453 onward and `analysis_subprocess.py` line 129.\n\nI'd also rather avoid the long lines. Could you raise the errors by doing something like (example from work-in-progress DAQmx code):\n\n```python\n    msg = \"\"\"Cannot add analog input to device with no parent pseudoclock.\n        Even if there is no buffered output, a pseudoclock is still required\n        to trigger the start of acquisition. Please specify a parent_device\n        and clock_terminal for device %s\"\"\"\n    raise ValueError(dedent(msg) % self.name)\n```\nwhere `dedent()` is `labscript_utils.dedent()` (and thus depend on labscript_utils 2.8.0)?\n\nThis also avoids having the string literal in the exception line itself, which avoids having it print twice when the exception is raised.\n\nI'm limiting lines to 88 characters in all new code I write in accordance with the style automated by [this project, 'black'](https://github.com/ambv/black), which looks like it'll become a sort of standard, so if you're wondering how long is too long, it'd be good to aim for 88 chars (particularly with the strings), though I don't care about 100% compliance (and I don't want to touch existing code for the sake of not making diff noise). Conforming to line length is annoying for strings though, hence why I made the `dedent()` function.", "markup": "markdown", "html": "<p>This is fine, although I'm not familiar with how it's being used I'm happy to take your word for it.</p>\n<p>On matters of style though, I'd rather not merge commented-out code such as <code>__init__.py</code>, line 453 onward and <code>analysis_subprocess.py</code> line 129.</p>\n<p>I'd also rather avoid the long lines. Could you raise the errors by doing something like (example from work-in-progress DAQmx code):</p>\n<div class=\"codehilite language-python\"><pre><span></span>    <span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;&quot;Cannot add analog input to device with no parent pseudoclock.</span>\n<span class=\"s2\">        Even if there is no buffered output, a pseudoclock is still required</span>\n<span class=\"s2\">        to trigger the start of acquisition. Please specify a parent_device</span>\n<span class=\"s2\">        and clock_terminal for device </span><span class=\"si\">%s</span><span class=\"s2\">&quot;&quot;&quot;</span>\n    <span class=\"k\">raise</span> <span class=\"ne\">ValueError</span><span class=\"p\">(</span><span class=\"n\">dedent</span><span class=\"p\">(</span><span class=\"n\">msg</span><span class=\"p\">)</span> <span class=\"o\">%</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>where <code>dedent()</code> is <code>labscript_utils.dedent()</code> (and thus depend on labscript_utils 2.8.0)?</p>\n<p>This also avoids having the string literal in the exception line itself, which avoids having it print twice when the exception is raised.</p>\n<p>I'm limiting lines to 88 characters in all new code I write in accordance with the style automated by <a data-is-external-link=\"true\" href=\"https://github.com/ambv/black\" rel=\"nofollow\">this project, 'black'</a>, which looks like it'll become a sort of standard, so if you're wondering how long is too long, it'd be good to aim for 88 chars (particularly with the strings), though I don't care about 100% compliance (and I don't want to touch existing code for the sake of not making diff noise). Conforming to line length is annoying for strings though, hence why I made the <code>dedent()</code> function.</p>", "type": "rendered"}, "created_on": "2018-10-24T15:33:13.556155+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-10-24T15:33:13.566094+00:00", "type": "pullrequest_comment", "id": 80187162}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "90162fb21a2c", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/90162fb21a2c"}, "html": {"href": "#!/pstarkey/lyse/commits/90162fb21a2c"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-24T07:05:13.663176+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/79940845.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-79940845"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "@cbillington I\u2019ll be merging this in a few days unless you have any objections, and then tagging a new release of lyse so that we can we can reference it in supplementary material for Shaun's vortex paper.\n\nI added an additional bit of code today so that the user code can be notified of when the analysis script has finished running \\(so that it can enable things like buttons that may have been disabled explicitly once the `delay_event` was sent \\(to prevent user interaction with custom behaviour when lyse isn\u2019t still waiting for the results to be returned\\)", "markup": "markdown", "html": "<p>@cbillington I\u2019ll be merging this in a few days unless you have any objections, and then tagging a new release of lyse so that we can we can reference it in supplementary material for Shaun's vortex paper.</p>\n<p>I added an additional bit of code today so that the user code can be notified of when the analysis script has finished running (so that it can enable things like buttons that may have been disabled explicitly once the <code>delay_event</code> was sent (to prevent user interaction with custom behaviour when lyse isn\u2019t still waiting for the results to be returned)</p>", "type": "rendered"}, "created_on": "2018-10-23T06:50:14.880558+00:00", "user": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "updated_on": "2018-10-23T06:50:14.896731+00:00", "type": "pullrequest_comment", "id": 79940845}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"comment": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45/comments/79935981.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45/_/diff#comment-79935981"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}, "content": {"raw": "This has been tested in our lab.", "markup": "markdown", "html": "<p>This has been tested in our lab.</p>", "type": "rendered"}, "created_on": "2018-10-23T06:02:55.944349+00:00", "user": {"display_name": "Shaun Johnstone", "uuid": "{652df738-313d-472c-b7b5-a3f8f98a3322}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D"}, "html": {"href": "https://bitbucket.org/%7B652df738-313d-472c-b7b5-a3f8f98a3322%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/38984f1761fc67ce892911496abee619d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSJ-3.png"}}, "nickname": "shjohnst", "type": "user", "account_id": "557058:1b9a15fb-8e4f-407e-b7b9-567c5e1fa1b4"}, "updated_on": "2018-10-23T06:02:55.950725+00:00", "type": "pullrequest_comment", "id": 79935981}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "279797ac5e68", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/279797ac5e68"}, "html": {"href": "#!/pstarkey/lyse/commits/279797ac5e68"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-23T04:30:41.234066+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.\r\n\r\n**Update**\r\n\r\nAlso added a threading.Event to delay the return of results to lyse if the user requests it.\r\n\r\nThis allows the user to use the Plot subclass to interact with the data, and save additional results to HDF5 file via custom actions on their toolbar \\(which could be the result of user interaction with the plot\\) and then return the results to lyse \\(for example either on a button click, or after a timeout, or whatever you like!\\)\r\n\r\nTo use, call \\`lyse.delay\\_results\\_return\\(\\)\\` at the end of your script.  \r\nResults will then only be returned to lyse \\(so lyse will be stuck waiting for your analysis script to complete\\) until \\`lyse.delay\\_event.set\\(\\)\\` is called \\(through some event ultimately processed by the Qt event loop\\).", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "f1936e3d19be", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/f1936e3d19be"}, "html": {"href": "#!/pstarkey/lyse/commits/f1936e3d19be"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-19T07:05:07.592202+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "f1936e3d19be", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/f1936e3d19be"}, "html": {"href": "#!/pstarkey/lyse/commits/f1936e3d19be"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-19T07:04:24.176854+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "0b3fc87484c0", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/0b3fc87484c0"}, "html": {"href": "#!/pstarkey/lyse/commits/0b3fc87484c0"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-19T06:21:51.494898+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}, {"update": {"description": "This allows you to provide custom behaviour in plot windows \\(such as additional actions\\)\r\n\r\nUse `lyse.register_plot_class(identifier, cls)` to register a class for lyse to use when creating window for `figure(identifier)`, where cls must be a subclass of `lyse.Plot` \\(which is monkey patched in to the lyse module to avoid the double import denier script triggering if you try to import it directly from lyse.analysis\\_subprocess\\)\r\n\r\nCurrently we do not support changing the class from one run of the script to the next, without restarting the worker process \\(as that would require re-instantiating the plot which has a large number of problems\\). Also, in order to avoid the custom subclass being detected as changing from shot to shot, it needs to be imported from a separate module to the analysis script. If an invalid class is specified, then the default `Plot` class is used and message is printed in the lyse terminal.\r\n\r\nI also changed the indexing of the internal storage of plots to use the identifier rather than the fig object. This seems to make much more sense to me, and since we also now expose that dictionary to the analysis script via `lyse.plots`, I figured now would be a good time to change it! I can't see any downside to doing this but please correct me if I'm wrong.\r\n\r\nFinally, this obviously has no effect on lyse scripts run from the terminal, since we don't use our figure manager in such cases. A warning is printed informing the user in such instances \\(if they use `lyse.register_plot_class()`\\)\r\n\r\nThis was motivated by the vortex research Shaun did for his thesis, for which he directly modified the `Plot` class to implement custom functionality.", "title": "Added the ability for analysis scripts to register a custom Plot class", "destination": {"commit": {"hash": "e652c2de1a31", "type": "commit", "links": {"self": {"href": "data/repositories/labscript_suite/lyse/commit/e652c2de1a31.json"}, "html": {"href": "#!/labscript_suite/lyse/commits/e652c2de1a31"}}}, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/lyse.json"}, "html": {"href": "#!/labscript_suite/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{55eebdfe-43d1-4ae8-9049-50c55b295397}ts=249921"}}, "type": "repository", "name": "lyse", "full_name": "labscript_suite/lyse", "uuid": "{55eebdfe-43d1-4ae8-9049-50c55b295397}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "0b3fc87484c0", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse/commit/0b3fc87484c0"}, "html": {"href": "#!/pstarkey/lyse/commits/0b3fc87484c0"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/pstarkey/lyse"}, "html": {"href": "#!/pstarkey/lyse"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e5413385-6166-4d2c-9b39-d34598d7fb72}ts=python"}}, "type": "repository", "name": "lyse", "full_name": "pstarkey/lyse", "uuid": "{e5413385-6166-4d2c-9b39-d34598d7fb72}"}, "branch": {"name": "custom-Plot-classes"}}, "state": "OPEN", "author": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "date": "2018-10-19T06:21:51.434180+00:00"}, "pull_request": {"type": "pullrequest", "id": 45, "links": {"self": {"href": "data/repositories/labscript_suite/lyse/pullrequests/45.json"}, "html": {"href": "#!/labscript_suite/lyse/pull-requests/45"}}, "title": "Added the ability for analysis scripts to register a custom Plot class"}}]}