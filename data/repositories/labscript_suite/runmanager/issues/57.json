{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/runmanager.json"}, "html": {"href": "#!/labscript_suite/runmanager"}, "avatar": {"href": "data/bytebucket.org/ravatar/{9b4f21e6-54b0-41ea-8f01-db1919f2f790}ts=249918"}}, "type": "repository", "name": "runmanager", "full_name": "labscript_suite/runmanager", "uuid": "{9b4f21e6-54b0-41ea-8f01-db1919f2f790}"}, "links": {"attachments": {"href": "data/repositories/labscript_suite/runmanager/issues/57/attachments_page=1.json"}, "self": {"href": "data/repositories/labscript_suite/runmanager/issues/57.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/runmanager/issues/57/watch"}, "comments": {"href": "data/repositories/labscript_suite/runmanager/issues/57/comments_page=1.json"}, "html": {"href": "#!/labscript_suite/runmanager/issues/57/runmanager-under-python-27-cannot-handle"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/runmanager/issues/57/vote"}}, "reporter": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "title": "runmanager under Python 2.7 cannot handle globals that contain unicode characters set under Python 3", "component": null, "votes": 0, "watches": 1, "content": {"raw": "If you set a global (under Python 3) to 'asdf\u0482', then close runmanager, open runmanager under Python 2, load the globals file and then try to open the tab for the globals file, you get the below exception (and runmanager gets stuck in a broken state)\r\n\r\n```\r\n#!python\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\labscript_suite\\labscript_py27\\runmanager\\__main__.py\", line 2177, in on_treeView_groups_leftClicked\r\n    self.open_group(globals_file, group_name)\r\n  File \"C:\\labscript_suite\\labscript_py27\\runmanager\\__main__.py\", line 2780, in open_group\r\n    group_tab = GroupTab(self.ui.tabWidget, globals_file, group_name)\r\n  File \"C:\\labscript_suite\\labscript_py27\\runmanager\\__main__.py\", line 604, in __init__\r\n    self.populate_model()\r\n  File \"C:\\labscript_suite\\labscript_py27\\runmanager\\__main__.py\", line 655, in populate_model\r\n    row = self.make_global_row(name, value, units, expansion)\r\n  File \"C:\\labscript_suite\\labscript_py27\\runmanager\\__main__.py\", line 719, in make_global_row\r\n    value_item.setData(str(value), self.GLOBALS_ROLE_PREVIOUS_TEXT)\r\nUnicodeEncodeError: 'ascii' codec can't encode character u'\\u0482' in position 6: ordinal not in range(128)\r\n\r\n```", "markup": "markdown", "html": "<p>If you set a global (under Python 3) to 'asdf\u0482', then close runmanager, open runmanager under Python 2, load the globals file and then try to open the tab for the globals file, you get the below exception (and runmanager gets stuck in a broken state)</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unmanager\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2177</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">on_treeView_groups_leftClicked</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">open_group</span><span class=\"p\">(</span><span class=\"n\">globals_file</span><span class=\"p\">,</span> <span class=\"n\">group_name</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unmanager\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2780</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">open_group</span>\n    <span class=\"n\">group_tab</span> <span class=\"o\">=</span> <span class=\"n\">GroupTab</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ui</span><span class=\"o\">.</span><span class=\"n\">tabWidget</span><span class=\"p\">,</span> <span class=\"n\">globals_file</span><span class=\"p\">,</span> <span class=\"n\">group_name</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unmanager\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">604</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"fm\">__init__</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">populate_model</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unmanager\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">655</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">populate_model</span>\n    <span class=\"n\">row</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">make_global_row</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">value</span><span class=\"p\">,</span> <span class=\"n\">units</span><span class=\"p\">,</span> <span class=\"n\">expansion</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;C:\\labscript_suite\\labscript_py27</span><span class=\"se\">\\r</span><span class=\"s2\">unmanager\\__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">719</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">make_global_row</span>\n    <span class=\"n\">value_item</span><span class=\"o\">.</span><span class=\"n\">setData</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">value</span><span class=\"p\">),</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">GLOBALS_ROLE_PREVIOUS_TEXT</span><span class=\"p\">)</span>\n<span class=\"ne\">UnicodeEncodeError</span><span class=\"p\">:</span> <span class=\"s1\">&#39;ascii&#39;</span> <span class=\"n\">codec</span> <span class=\"n\">can</span><span class=\"s1\">&#39;t encode character u&#39;</span>\\<span class=\"n\">u0482</span><span class=\"s1\">&#39; in position 6: ordinal not in range(128)</span>\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "invalid", "version": null, "edited_on": null, "created_on": "2018-05-10T06:20:21.425850+00:00", "milestone": null, "updated_on": "2018-05-11T07:02:31.524683+00:00", "type": "issue", "id": 57}