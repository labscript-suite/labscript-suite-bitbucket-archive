{"links": {"self": {"href": "data/repositories/labscript_suite/runmanager/issues/57/comments/45348916.json"}, "html": {"href": "#!/labscript_suite/runmanager/issues/57#comment-45348916"}}, "issue": {"links": {"self": {"href": "data/repositories/labscript_suite/runmanager/issues/57.json"}}, "type": "issue", "id": 57, "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/runmanager.json"}, "html": {"href": "#!/labscript_suite/runmanager"}, "avatar": {"href": "data/bytebucket.org/ravatar/{9b4f21e6-54b0-41ea-8f01-db1919f2f790}ts=249918"}}, "type": "repository", "name": "runmanager", "full_name": "labscript_suite/runmanager", "uuid": "{9b4f21e6-54b0-41ea-8f01-db1919f2f790}"}, "title": "runmanager under Python 2.7 cannot handle globals that contain unicode characters set under Python 3"}, "content": {"raw": "They can definitely handle unicode strings, but we want `.decode('utf8')`, not `unicode()`,  as 'unicode' still assumes ascii codex for converting bytes:\n```python\n>>> unicode('\u00fc'.encode('utf8'))\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 0: ordinal not in range(128)\n```\n\n`if PY2: str=unicode` is a good idea as well though to ensure both Python versions are using the same datatypes when `str()` is called in other contexts", "markup": "markdown", "html": "<p>They can definitely handle unicode strings, but we want <code>.decode('utf8')</code>, not <code>unicode()</code>,  as 'unicode' still assumes ascii codex for converting bytes:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"nb\">unicode</span><span class=\"p\">(</span><span class=\"s1\">&#39;\u00fc&#39;</span><span class=\"o\">.</span><span class=\"n\">encode</span><span class=\"p\">(</span><span class=\"s1\">&#39;utf8&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;&lt;stdin&gt;&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n<span class=\"ne\">UnicodeDecodeError</span><span class=\"p\">:</span> <span class=\"s1\">&#39;ascii&#39;</span> <span class=\"n\">codec</span> <span class=\"n\">can</span><span class=\"s1\">&#39;t decode byte 0xc3 in position 0: ordinal not in range(128)</span>\n</pre></div>\n\n\n<p><code>if PY2: str=unicode</code> is a good idea as well though to ensure both Python versions are using the same datatypes when <code>str()</code> is called in other contexts</p>", "type": "rendered"}, "created_on": "2018-05-10T07:42:33.067424+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-05-10T07:43:25.411753+00:00", "type": "issue_comment", "id": 45348916}