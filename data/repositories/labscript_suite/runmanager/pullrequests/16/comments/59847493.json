{"links": {"self": {"href": "data/repositories/labscript_suite/runmanager/pullrequests/16/comments/59847493.json"}, "html": {"href": "#!/labscript_suite/runmanager/pull-requests/16/_/diff#comment-59847493"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 16, "links": {"self": {"href": "data/repositories/labscript_suite/runmanager/pullrequests/16.json"}, "html": {"href": "#!/labscript_suite/runmanager/pull-requests/16"}}, "title": "Python3"}, "content": {"raw": "I'm pretty happy with this!\n\nSome comments:\n\nIn `get_all_groups()`, `if not isinstance(h5_files, list)` is not a sufficient check since the the h5_files could be a generator or tuple, not just a list. So better to stick with `if not isinstance(h5_files, str) or isinstance(h5_files, bytes)`, with just translation of the string types to the python 3 names for them.\n\nOther than that I am happy!\n\nFeel free to replace all occurances of `value.decode() if isinstance(value, bytes) else str(value)` with a call to a global function if you like:\n\n```python\ndef _ensure_str(s):\n    \"\"\"convert bytestrings and numpy strings to python strings\"\"\"\n    return s.decode() if isinstance(s, bytes) else str(s)\n...\nvalue = _ensure_str(value)\n```\n\nIt's slightly less error prone but I am pretty indifferent.\n", "markup": "markdown", "html": "<p>I'm pretty happy with this!</p>\n<p>Some comments:</p>\n<p>In <code>get_all_groups()</code>, <code>if not isinstance(h5_files, list)</code> is not a sufficient check since the the h5_files could be a generator or tuple, not just a list. So better to stick with <code>if not isinstance(h5_files, str) or isinstance(h5_files, bytes)</code>, with just translation of the string types to the python 3 names for them.</p>\n<p>Other than that I am happy!</p>\n<p>Feel free to replace all occurances of <code>value.decode() if isinstance(value, bytes) else str(value)</code> with a call to a global function if you like:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"k\">def</span> <span class=\"nf\">_ensure_str</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;convert bytestrings and numpy strings to python strings&quot;&quot;&quot;</span>\n    <span class=\"k\">return</span> <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">decode</span><span class=\"p\">()</span> <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">,</span> <span class=\"nb\">bytes</span><span class=\"p\">)</span> <span class=\"k\">else</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span>\n<span class=\"o\">...</span>\n<span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"n\">_ensure_str</span><span class=\"p\">(</span><span class=\"n\">value</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>It's slightly less error prone but I am pretty indifferent.</p>", "type": "rendered"}, "created_on": "2018-03-26T11:30:43.115892+00:00", "user": {"display_name": "Chris Billington", "uuid": "{e363c5a9-5075-4656-afb5-88bd6a6dceeb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D"}, "html": {"href": "https://bitbucket.org/%7Be363c5a9-5075-4656-afb5-88bd6a6dceeb%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/9238baf7300c41c0e7294db922899e6ad=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCB-1.png"}}, "nickname": "cbillington", "type": "user", "account_id": "557058:cbf1bc43-1dc2-477b-9e25-1a8f40fd7ee3"}, "updated_on": "2018-03-26T11:30:43.119247+00:00", "type": "pullrequest_comment", "id": 59847493}