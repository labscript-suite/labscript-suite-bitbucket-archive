{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/labscript_suite/runviewer.json"}, "html": {"href": "#!/labscript_suite/runviewer"}, "avatar": {"href": "data/bytebucket.org/ravatar/{71215673-ad3e-425c-ae04-84cc6c2ca7da}ts=445022"}}, "type": "repository", "name": "runviewer", "full_name": "labscript_suite/runviewer", "uuid": "{71215673-ad3e-425c-ae04-84cc6c2ca7da}"}, "links": {"attachments": {"href": "data/repositories/labscript_suite/runviewer/issues/2/attachments_page=1.json"}, "self": {"href": "data/repositories/labscript_suite/runviewer/issues/2.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/runviewer/issues/2/watch"}, "comments": {"href": "data/repositories/labscript_suite/runviewer/issues/2/comments_page=1.json"}, "html": {"href": "#!/labscript_suite/runviewer/issues/2/pyqtgraph-v0910-is-incompatible-with"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/labscript_suite/runviewer/issues/2/vote"}}, "reporter": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "title": "PyQtGraph v0.9.10 is incompatible with runviewer 2.0.1", "component": null, "votes": 0, "watches": 2, "content": {"raw": "The latest version of PyQtGraph has changed the x,y array dimension requirements when [stepMode=True](http://www.pyqtgraph.org/documentation/graphicsItems/plotdataitem.html?highlight=stepmode#pyqtgraph.PlotDataItem.__init__).\r\n\r\nTraceback raised is:\r\n```\r\n#!python\r\n\r\nTraceback (most recent call last):\r\n  File \"__main__.py\", line 303, in on_shot_selection_changed\r\n    self.update_channels_treeview()\r\n  File \"__main__.py\", line 419, in update_channels_treeview\r\n    self.update_plots()\r\n  File \"__main__.py\", line 478, in update_plots\r\n    self.create_plot(channel, ticked_shots)\r\n  File \"__main__.py\", line 501, in create_plot\r\n    plot_item = self.plot_widgets[channel].plot([],[], pen=pg.mkPen(QColor(colour), width=2), stepMode=True)\r\n  File \"/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotItem/PlotItem.py\", line 630, in plot\r\n    item = PlotDataItem(*args, **kargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotDataItem.py\", line 176, in __init__\r\n    self.setData(*args, **kargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotDataItem.py\", line 460, in setData\r\n    self.updateItems()\r\n  File \"/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotDataItem.py\", line 486, in updateItems\r\n    self.curve.setData(x=x, y=y, **curveArgs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotCurveItem.py\", line 299, in setData\r\n    self.updateData(*args, **kargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotCurveItem.py\", line 342, in updateData\r\n    raise Exception(\"len(X) must be len(Y)+1 since stepMode=True (got %s and %s)\" % (self.xData.shape, self.yData.shape))\r\nException: len(X) must be len(Y)+1 since stepMode=True (got (0,) and (0,))\r\n```\r\n\r\nThe current workaround is to only use pyqtgraph v0.9.8 until we fix the issue", "markup": "markdown", "html": "<p>The latest version of PyQtGraph has changed the x,y array dimension requirements when <a data-is-external-link=\"true\" href=\"http://www.pyqtgraph.org/documentation/graphicsItems/plotdataitem.html?highlight=stepmode#pyqtgraph.PlotDataItem.__init__\" rel=\"nofollow\">stepMode=True</a>.</p>\n<p>Traceback raised is:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">303</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">on_shot_selection_changed</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">update_channels_treeview</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">419</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">update_channels_treeview</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">update_plots</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">478</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">update_plots</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">create_plot</span><span class=\"p\">(</span><span class=\"n\">channel</span><span class=\"p\">,</span> <span class=\"n\">ticked_shots</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;__main__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">501</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">create_plot</span>\n    <span class=\"n\">plot_item</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">plot_widgets</span><span class=\"p\">[</span><span class=\"n\">channel</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([],[],</span> <span class=\"n\">pen</span><span class=\"o\">=</span><span class=\"n\">pg</span><span class=\"o\">.</span><span class=\"n\">mkPen</span><span class=\"p\">(</span><span class=\"n\">QColor</span><span class=\"p\">(</span><span class=\"n\">colour</span><span class=\"p\">),</span> <span class=\"n\">width</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">),</span> <span class=\"n\">stepMode</span><span class=\"o\">=</span><span class=\"bp\">True</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotItem/PlotItem.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">630</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">plot</span>\n    <span class=\"n\">item</span> <span class=\"o\">=</span> <span class=\"n\">PlotDataItem</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotDataItem.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">176</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"fm\">__init__</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">setData</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotDataItem.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">460</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">setData</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">updateItems</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotDataItem.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">486</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">updateItems</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">curve</span><span class=\"o\">.</span><span class=\"n\">setData</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"o\">=</span><span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">curveArgs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotCurveItem.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">299</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">setData</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">updateData</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/local/lib/python2.7/dist-packages/pyqtgraph/graphicsItems/PlotCurveItem.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">342</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">updateData</span>\n    <span class=\"k\">raise</span> <span class=\"ne\">Exception</span><span class=\"p\">(</span><span class=\"s2\">&quot;len(X) must be len(Y)+1 since stepMode=True (got </span><span class=\"si\">%s</span><span class=\"s2\"> and </span><span class=\"si\">%s</span><span class=\"s2\">)&quot;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">xData</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">yData</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">))</span>\n<span class=\"ne\">Exception</span><span class=\"p\">:</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span> <span class=\"n\">must</span> <span class=\"n\">be</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">)</span><span class=\"o\">+</span><span class=\"mi\">1</span> <span class=\"n\">since</span> <span class=\"n\">stepMode</span><span class=\"o\">=</span><span class=\"bp\">True</span> <span class=\"p\">(</span><span class=\"n\">got</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,)</span> <span class=\"ow\">and</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,))</span>\n</pre></div>\n\n\n<p>The current workaround is to only use pyqtgraph v0.9.8 until we fix the issue</p>", "type": "rendered"}, "assignee": {"display_name": "Philip Starkey", "uuid": "{48af65db-e5fc-459c-a7eb-52eb1f9a5690}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D"}, "html": {"href": "https://bitbucket.org/%7B48af65db-e5fc-459c-a7eb-52eb1f9a5690%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/dc318537facc47ebe1ae98a7aabacecfd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsPS-0.png"}}, "nickname": "pstarkey", "type": "user", "account_id": "557058:52a111e4-40da-4441-9143-417f95f2db97"}, "state": "resolved", "version": null, "edited_on": null, "created_on": "2015-03-24T22:45:10.951147+00:00", "milestone": null, "updated_on": "2015-04-02T05:26:15.442606+00:00", "type": "issue", "id": 2}